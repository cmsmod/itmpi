000100 PROCESS ADV,NOAWO,APOST,NODBCS,DU,DYN,NOFSRT,LIB                 00010000
000200 PROCESS MAP,NONUM,NUMPROC(MIG),OUT(SYSOUR),NORENT                00020000
000300 PROCESS NOSEQ,S,SSR,NOTERM,TRUNC(OPT),VBREF,NOWORD,XREF,NOZWB    00030000
000400                                                                  00040000
000500 IDENTIFICATION DIVISION.                                         00050000
000600 PROGRAM-ID.    MQAPHHAB.                                         00060000
000700 AUTHOR.        CWFMQA WCBRACK.                                   00070099
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*REVISIONS:      ****CONSISTENCY EDIT: HHA****                    00100000
001100* REV 00: 01 SEP 97  ORIGINAL PRODUCTION VERSION - VERSION H      00110000
001200* NEW 00: 11 SEP 19 VERIFY MQA COBOL TO CLOUD LANG CONVERT:       00120099
001300*            MOD VK MQAMCER5, HOME HEALTH EDIT MODULE:            00130000
001400*            CALL CHAIN IN PROD:                                  00140099
001500*                 MQAP010D, MQAMCONS, MQAMCER5, AND BACK          00150099
001600******************************************************************00160099
001700* SCOPE:                                                          00170099
001800*    - CLAIM I/O: MQA PROCESS MIRRORS MQR COLLECT LOGIC FOR       00180099
001810*            CWF CLAIM REFORMAT: ALL TEN (MAX) CLAIM RECORDS      00181099
001820*            MUST BE IN WORKING STORAGE TO ALLOW REFORMAT/EDITING 00182099
001900*    - ALSO MQA EDIT COLLECT/MOD/WRITE: TO BUILD RVNU TRLR ARRAY  00190099
002000*            FOR MQA RVNU EDITS; AND PROVES CAN HANDLE CWF CLAIM  00200099
002100*            LOGICAL/PHYSICAL STRUCTURE => TO DATABASES           00210099
002200*            (THESE CLAIMS CAN NOT GO DIRECT TO DB'S, REQUIRE     00220099
002300*            ANOTHER REFORMAT DOWNSTREAM.  THAT REFORMAT IS TOO   00230099
002400*            COMPLEX FOR A DEMO)                                  00240099
002500*    - RETAIN HHAB SPLIT CODE: REQD: CHANGES CLAIM VAL TRAILERS   00250099
002600*            EVEN THOUGH IT IS AN 'EDIT'.                         00260099
002700*    - RETAIN MQA[N]HCPC SUBPROGRAM CALL TO LINKED LIST           00270099
002800*    -       CREATED FROM CWF HCPC FLAT FILE (MQAXHCPC PRODUCT):  00280099
002900*            TESTS ABILITY TO ACCEPT EXTERIOR-BUILT DATA FILES.   00290099
003000*            (OTHERS: 3M DRG OBJECTS FOR INPT EDIT AND MEDPAR;    00300099
003100*                     MH00 IDE FILE; SSA ZIP3 FILE)               00310099
003200*                     PRP QUARTERLY PROVIDER HH & HOSPC EXTRACT)  00320099
003300*    - RETAIN ONLY ESSENTIAL TRAILER EDITING AND ERROR CODES.     00330099
003400*    - RETAIN KEY EDITS TO TEST ERROR LOGIC TRAVERSAL.            00340099
003500*    - REWRITE ERROR RANK AND CLAIM ERROR ARRAY BUILD.            00350099
003600*            (DONE IN PROD BY CALLS TO MQAMQAER).                 00360099
003700*    - SKIP PRINT-FILE REPORT BUILDS: USE DISPLAYS.               00370099
003800*    - SKIP CONTROL FILE INTERACTIONS & UPDATES: ASSUME NEW LANG  00380099
003900*    -       ABILITY TO READ/WRITE 'VSAM' OR INDEXED FILES        00390099
004000*    - EXEC JCL USES PARMS: TEST ABILITY TO ACCEPT RUN CONTROL(S) 00400099
004100****************************************************************  00410099
004200                                                                  00420099
004300 TITLE 'MQAPHHAB: FILE-CONTROL'.                                  00430000
004400 ENVIRONMENT DIVISION.                                            00440000
004500 INPUT-OUTPUT SECTION.                                            00450000
004600 FILE-CONTROL.                                                    00460000
004700     SELECT CLAIMS-INPUT           ASSIGN  MQAICLIN               00470000
004800         ORGANIZATION SEQUENTIAL   FILE STATUS CLIN-STATUS.       00480000
004900* NB: FILE RUN AGAINST PROD PROGRAMS WILL PRODUCE SAME FILE       00490099
005000* NB: AS THIS PROGRAM: BASED ON PRODUCTION SEPT 2019.             00500099
005010* NB: NEW FIELDS ADDED AFTER SEPT 2019 ARE NOT SEEN IN THIS DEMO  00501099
005020*                                                                 00502099
005100                                                                  00510000
005200     SELECT CLAIMS-SEG1            ASSIGN  MQAOCLS1               00520000
005300         ORGANIZATION SEQUENTIAL   FILE STATUS CLS1-STATUS.       00530000
005400                                                                  00540099
005500*                                                                 00550000
005600 TITLE 'MQAPHHAB: DATA DIVISION'.                                 00560000
005700 DATA DIVISION.                                                   00570000
005800 FILE SECTION.                                                    00580000
005900 FD  CLAIMS-INPUT                                                 00590000
006000     BLOCK  CONTAINS  0 RECORDS                                   00600000
006100     RECORDING MODE IS V.                                         00610000
006200**   RECORD CONTAINS 53 TO 32096 CHARACTERS.                      00620000
006300 01  CLIN-RECORD-IN.                                              00630000
006400     03  FILLER         PIC X(49).                                00640000
006500     03  CLIN-CLAIM-IN  PIC X(32047).                             00650000
006600                                                                  00660000
006700                                                                  00670000
006800 FD  CLAIMS-SEG1                                                  00680000
006900     BLOCK  CONTAINS  0 RECORDS                                   00690000
007000     RECORDING MODE IS V.                                         00700000
007100**   RECORD CONTAINS 53 TO 32096 CHARACTERS.                      00710000
007200 01  CLS1-RECORD-OUT.                                             00720000
007300     03  FILLER         PIC X(49).                                00730000
007400     03  CLS1-RECL      PIC S9(5) COMP-3.                         00740000
007500 01  CLS1-RECORD.                                                 00750000
007600     03  CLS1-LEADER    PIC X(49).                                00760000
007700     03  CLS1-DATA-AREA.                                          00770000
007800*        05  CLS1-RECL  PIC S9(5) COMP-3.                         00780000
007900         05  CLS1-CHAR  PIC X(01)                                 00790000
008000             OCCURS 001 TO 32047 DEPENDING ON CLS1-RECL.          00800000
008100                                                                  00810000
008200 WORKING-STORAGE SECTION.                                         00820000
008300 77  RELEASED PIC X(32) VALUE '>> MQAPHHAB 09/11/19 14:00 PM <<'. 00830099
008400                                                                  00840099
008500 01 WS-CURRENT-DATE            PIC X(21).                         00850000
008600 01  TESTING-SW        PIC X(01)    VALUE 'N'.                    00860000
008700     88  TESTING                    VALUE 'Y'.                    00870000
008800 01  FCB-PARAMETER.                                               00880000
008900     05  FCB-PARMLEN          PIC S9(4) COMP VALUE +56.           00890000
009000     05  FCB-DDNAME           PIC X(08) VALUE SPACE.              00900000
009100     05  FCB-DSNAME           PIC X(44) VALUE SPACE.              00910000
009200                                                                  00920000
009300 01  FLAGS-AND-COUNTERS.                                          00930000
009400     03  FIRST-TIME              PIC X(01)    VALUE 'Y'.          00940000
009500     03  FILE-STATUS-CODES.                                       00950000
009600         05  CLIN-STATUS       PIC X(02)   VALUE ZERO.            00960000
009700         05  CLS1-STATUS       PIC X(02)   VALUE ZERO.            00970000
009800     03  RECORD-LENGTH.                                           00980000
009900         05  CLIN-CHARS        PIC 9(12)   VALUE ZERO   COMP.     00990000
010000         05  HOLD-RECL         PIC S9(5)   COMP-3.                01000000
010100         05  RVNU-LEN          PIC S9(5)   COMP-3.                01010000
010200         05  RVNU-BEG          PIC S9(5)   COMP-3.                01020000
010300     03  RUN-DATES.                                               01030000
010400         05  RUN-DATE          PIC 9(08)   VALUE ZERO.            01040000
010500         05  RUN-YMD           PIC 9(08)   VALUE ZERO.            01050000
010600     03  SEG-CNTR              PIC 99      VALUE ZERO.            01060000
010700     03  WS-TRLR-MAX           PIC S9(04)  VALUE +45  COMP.       01070000
010800     03  WS-SEGA-MAX           PIC S9(04)  VALUE +10  COMP.       01080000
010900     03  CLIN-DDNAME           PIC X(8)   VALUE 'MQAICLIN'.       01090000
011000     03  CLIN-COUNT            PIC 9(8)   VALUE ZERO.             01100000
011100     03  CLIN-RVNU-COUNT       PIC 9(8)   VALUE ZERO.             01110000
011200     03  CLIN-TOT-REC          PIC 9(8)   VALUE ZERO.             01120000
011300     03  CLS1-DDNAME           PIC X(8)   VALUE 'MQAOCLS1'.       01130000
011400     03  CLS1-COUNT            PIC 9(8)   VALUE ZERO.             01140000
011500     03  CLS1-RVNU-COUNT       PIC 9(8)   VALUE ZERO.             01150000
011600     03  CLS1-TOT-REC          PIC 9(8)   VALUE ZERO.             01160000
011700     03  CLIN-DSNAME           PIC X(44)  VALUE SPACE.            01170000
011800     03  CLS1-DSNAME           PIC X(44)  VALUE SPACE.            01180000
011900 01  HOLD-WORK-AREA.                                              01190000
012000    05  HOLD-LAST.                                                01200000
012100        07  HOLD-GENER-1     PIC X(01).                           01210000
012200        07  HOLD-GENER-NO    PIC X(04).                           01220000
012300        07  HOLD-VRSN        PIC X(03).                           01230000
012400    05  HOLD-UNSTRING.                                            01240000
012500        07  HOLD-WORD        PIC X(09) OCCURS 9.                  01250000
012600        07  HOLD-DELIM       PIC X(01) OCCURS 9.                  01260000
012700    05  HOLD-INFIL-GDG       PIC X(08).                           01270000
012800    05  HOLD-OUTFIL-GDG      PIC X(08).                           01280000
012900                                                                  01290000
013000 01  WS-CLAIM.                                                    01300000
013100     03 FILLER             PIC X(49).                             01310000
013200     03 CLIN-RECL          PIC S9(5) COMP-3.                      01320000
013300                                                                  01330000
013400**  32047 IS LARGEST CLAIM COBOL CAN WRITE, LARGER THAN ANY       01340000
013500**  VK CLAIM.  IT IS A SHOWSTOPPER MAX.                           01350000
013600                                                                  01360000
013700 01  CLIN-RECORD.                                                 01370000
013800     03  CLIN-LEADER    PIC X(49).                                01380000
013900     03  CLIN-CLAIM.                                              01390000
014000         05  CLIN-CHAR  PIC X(01)                                 01400000
014100             OCCURS 001 TO 32047 DEPENDING ON CLIN-RECL.          01410000
014200                                                                  01420000
014300**   INCLUDES 49 BYTE HEADER!!!!!                                 01430000
014400*VI: TOT-LINE-COUNT @ BYTE 178; RVNU-COUNT @ 561                  01440000
014500*VJ: TOT-LINE-COUNT @ BYTE 178; RVNU-COUNT @ 589                  01450000
014600*VK: PTA TOT RVNU COUNT @ BYTE 178; RVNU-COUNT @ 1298             01460000
014700*                                                                 01470000
014800 01  HOLD-RECORD-AREA.                                            01480000
014900   02  WS-RVNU-RECORD.                                            01490000
015000     03 FILLER          PIC X(49).                                01500000
015100     03 WS-RVNU-CLAIM.                                            01510000
015200        05 WS-RVNU-RECL       PIC S9(5) COMP-3.                   01520000
015300        05 FILLER             PIC X(125).                         01530000
015400        05 WS-RVNU-TOT-COUNT  PIC 9(3).                           01540000
015500        05 WS-RVNU-SEG-COUNT  PIC 9(2).                           01550000
015600*       05 FILLER             PIC X(1117).                        01560000
015700                                                                  01570000
015800*    32047 + 49 = 32096 + 4 FOR RDW = 32100 MQA MAX RECLEN        01580000
015900*    THIS DOES NOT CORRESPOND TO ANY CLAIM LEN: IT IS A           01590000
016000*    SHOW-STOPPING MAX IMPOSED BY QSAM                            01600000
016100                                                                  01610000
016200 01  CLIN-RVNU-RECORD.                                            01620000
016300     03  CLIN-RVNU-LEADER    PIC X(49).                           01630000
016400     03  CLIN-RVNU-CLAIM.                                         01640000
016500         05  CLIN-RVNU-CHAR  PIC X(01)                            01650000
016600             OCCURS 001 TO 32047 DEPENDING ON WS-RVNU-RECL.       01660000
016700                                                                  01670000
016800 TITLE 'MQAPHHAB: HOLD CLAIMS  AREA'.                             01680000
016900******** HOLD RVNU TRLR 'SEG' RECORDS 1 - 10 **************       01690000
017000******** PTB EXPAND: KEEP ALL CLAIMS IN THIS STRUCTURE ****       01700000
017100 01  HOLD-CLAIMS.                                                 01710000
017200   02  HOLD-RVNU-RECORDS.                                         01720000
017300     03  HRVNU-REC OCCURS 10 TIMES.                               01730000
017400         05  HRVNU-LEADER.                                        01740000
017500             07  FILLER            PIC X(13).                     01750000
017600             07  HRVNU-RIC         PIC X.                         01760000
017700             07  FILLER            PIC X(35).                     01770000
017800         05  HRVNU-CLAIM.                                         01780000
017900             07  HRVNU-RECL        PIC S9(5) COMP-3.              01790000
018000             07  FILLER            PIC X(16).                     01800000
018100             07  HRVNU-BIC         PIC X(02).                     01810000
018200             07  FILLER            PIC X(123).                    01820000
018300             07  HRVNU-HA-HB-BIC   PIC X(01).                     01830000
018400             07  FILLER            PIC X(98).                     01840000
018500             07  HRVNU-PRIM-PAY-CD PIC X(01).                     01850000
018600             07  FILLER            PIC X(979).                    01860000
018700             07  HRVNU-ML-IND      PIC X(01).                     01870000
018800             07  FILLER            PIC X(24).                     01880000
018900             07  HRVNU-TRLR-COUNT  PIC 9(02).                     01890000
019000             07  FILLER            PIC X(30797).                  01900000
019100                                                                  01910000
019200 01  INIT-RVNU-RECORD.                                            01920000
019300     03  IRVNU-LEADER          PIC X(49) VALUE LOW-VALUES.        01930000
019400     03  IRVNU-CLAIM.                                             01940000
019500         05  IRVNU-RECL        PIC S9(5) COMP-3 VALUE ZERO.       01950000
019600         05  FILLER            PIC X(1245) VALUE LOW-VALUES.      01960000
019700         05  IRVNU-TRLR-COUNT  PIC 9(02)  VALUE ZERO.             01970000
019800         05  FILLER            PIC X(30797) VALUE LOW-VALUES.     01980000
019900                                                                  01990000
020000 TITLE 'MQAPHHAB RVNU-TRLR ARRAY'.                                02000000
020100 01  RVNU-TRLRS.                                                  02010000
020200  02  TRLR-TBL.                                                   02020000
020300*COPY MQACTRLR REPLACING ==== BY ====.                            02030000
020400******************************************************************02040000
020500*  MQACTRLR COPYLIB  FRAME FOR RVNU TRLR ARRAY PASS TO EDITS      02050000
020600******************************************************************02060000
020700    03 TRL-RVNU-COUNT                      PIC 9(03).             02070070
020800    03 TRL-ERR-COUNT                       PIC 9(03).             02080000
020900    03 TRL-TBL.                                                   02090000
021000       05 TRL-TRLR         OCCURS 10 TIMES.                       02100000
021100          07 TRL-DATA      OCCURS 45 TIMES PIC X(606).            02110000
021200    03 TRL-BLOCK REDEFINES TRL-TBL.                               02120000
021300       05 TRL-RVNU      OCCURS 450 TIMES.                         02130000
021400******************************************************************02140000
021500*  COPY MQACRVNU HERE                                            *02150000
021600******************************************************************02160000
021700*COPY MQACRVNU REPLACING ==:X:== BY ==TRL-==.                     02170000
021800**************************************************************    02180000
021900*   MQACRVNU SOLE RVNU LINE CPYBK  CR11                           02190000
022000* IF MOD, ALSO MOD INIT CODE IN MQAP010D                          02200000
022100**************************************************************    02210000
022200     07 TRL-RVNU-TRAILER-CODE     PIC X(1).                       02220000
022300           88 RNVU-TRAILER                VALUE 'R'.              02230000
022400     07 TRL-RVNU-CENTER.                                          02240000
022500         09 FILLER                PIC X(1).                       02250000
022600         09 TRL-RVNU-CODE         PIC X(3).                       02260000
022700     07 TRL-RVNU-DATE             PIC 9(8).                       02270000
022800     07 TRL-RVNU-ANSI1            PIC X(5).                       02280000
022900     07 TRL-RVNU-ANSI2            PIC X(5).                       02290000
023000     07 TRL-RVNU-ANSI3            PIC X(5).                       02300000
023100     07 TRL-RVNU-ANSI4            PIC X(5).                       02310000
023200     07 TRL-RVNU-HIPPS-CODE       PIC X(5).                       02320000
023300     07 TRL-RVNU-HCPCS            PIC X(5).                       02330000
023400     07 TRL-RVNU-HCPCS-M1         PIC X(2).                       02340000
023500     07 TRL-RVNU-HCPCS-M2         PIC X(2).                       02350000
023600     07 TRL-RVNU-HCPCS-M3         PIC X(2).                       02360000
023700     07 TRL-RVNU-HCPCS-M4         PIC X(2).                       02370000
023800     07 TRL-RVNU-HCPCS-M5         PIC X(2).                       02380000
023900     07 TRL-RVNU-PMT-METHOD-IND   PIC X(2).                       02390000
024000     07 TRL-RVNU-DISCOUNT-FLAG    PIC X(1).                       02400000
024100     07 TRL-RVNU-PACKAGE-FLAG     PIC X(1).                       02410000
024200     07 TRL-RVNU-PRICING-IND      PIC X(2).                       02420000
024300     07 TRL-RVNU-OTAF-IND-CD      PIC X(1).                       02430000
024400**** 07 TRL-RVNU-OTAF-1           PIC X(1).                       02440000
024500**** 07 TRL-RVNU-OTAF-2           PIC X(1).  DELETED              02450000
024600     07 TRL-RVNU-IDE-NDC-UPC-NUM.                                 02460000
024700        09 TRL-RVNU-IDE-NUM          PIC X(07).                   02470000
024800        09 TRL-RVNU-IDE-FILLER-1     PIC X(17).                   02480000
024900     07 TRL-RVNU-NDC-QTY-QLFR-CD     PIC XX.                      02490000
025000     07 TRL-RVNU-NDC-QTY             PIC S9(7)V999 COMP-3.        02500000
025100     07 TRL-RVNU-UNITS            PIC S9(7)    COMP-3.            02510000
025200     07 TRL-RVNU-RATE             PIC S9(9)V99 COMP-3.            02520000
025300     07 TRL-RVNU-BLOOD-DEDUCT     PIC S9(9)V99 COMP-3.            02530000
025400     07 TRL-RVNU-CASH-DEDUCT      PIC S9(9)V99 COMP-3.            02540000
025500     07 TRL-RVNU-WAGE-ADJ-COINS   PIC S9(9)V99 COMP-3.            02550000
025600     07 TRL-RVNU-REDUCE-COINS     PIC S9(9)V99 COMP-3.            02560000
025700     07 TRL-RVNU-MSP1-PAID-AMT    PIC S9(9)V99 COMP-3.            02570000
025800     07 TRL-RVNU-MSP2-PAID-AMT    PIC S9(9)V99 COMP-3.            02580000
025900**** 07 TRL-RVNU-PROFESS-COMP     PIC S9(9)V99 COMP-3.            02590000
026000     07 TRL-RVNU-PROVIDER-PMT     PIC S9(9)V99 COMP-3.            02600000
026100     07 TRL-RVNU-PATIENT-AMT      PIC S9(9)V99 COMP-3.            02610000
026200     07 TRL-RVNU-PATIENT-RESPON   PIC S9(9)V99 COMP-3.            02620000
026300     07 TRL-RVNU-PAYMENT-AMOUNT   PIC S9(9)V99 COMP-3.            02630000
026400     07 TRL-RVNU-TOTAL            PIC S9(9)V99 COMP-3.            02640000
026500     07 TRL-RVNU-NONCOV           PIC S9(9)V99 COMP-3.            02650000
026600**** 07 TRL-RVNU-OVERRIDE         PIC X(01). NAME CHANGE.         02660000
026700****    TRL-RVNU-OVERRIDE = TRL-RVNU-DDCTBL-COINSRNC-CD           02670000
026800     07 TRL-RVNU-DDCTBL-COINSRNC-CD   PIC X(01).                  02680000
026900     07 TRL-RVNU-CB-OV                PIC X(01).                  02690000
027000     07 TRL-RVNU-STATUS-IND           PIC XX.                     02700000
027100     07 TRL-RVNU-SUSP-DUP-REV-IND     PIC X.                      02710000
027200     07 TRL-RVNU-APC-BUFR-CD          PIC XX.                     02720000
027300     07 TRL-RVNU-RNDRNG-PHY-NPI-NUM   PIC X(10).                  02730000
027400     07 TRL-RVNU-RNDRNG-SRNM-NAME     PIC X(6).                   02740000
027500     07 TRL-RVNU-PWK-CD               PIC X(2).                   02750000
027600     07 TRL-RVNU-PHYSN-SPCLTY-CD      PIC X(2).                   02760000
027700     07 TRL-RVNU-THRPY-CAP-IND OCCURS 5 TIMES                     02770000
027800                                      PIC X.                      02780000
027900     07 TRL-RVNU-FPS-MODEL-NUM        PIC X(2).                   02790000
028000     07 TRL-RVNU-FPS-RSN-CD           PIC X(3).                   02800000
028100     07 TRL-RVNU-FPS-RMRK-CD          PIC X(5).                   02810000
028200     07 TRL-RVNU-FPS-MSN-1-CD         PIC X(5).                   02820000
028300     07 TRL-RVNU-FPS-MSN-2-CD         PIC X(5).                   02830000
028400     07 TRL-RVNU-PTNT-ADD-ON-PMT      PIC S9(9)V99 COMP-3.        02840000
028500     07 TRL-RVNU-PRIOR-AUTH-IND       PIC X(4).                   02850000
028600     07 TRL-RVNU-UNIQ-TRKNG-NUM       PIC X(14).                  02860000
028700     07 TRL-RVNU-RP-IND               PIC X.                      02870000
028800     07 TRL-RVNU-TRNSTNL-DRUG-AMT     PIC S9(7)V9(4) COMP-3.      02880000
028900     07 TRL-RVNU-FILLER-2             PIC X(345).                 02890000
029000*    07 TRL-RVNU-FILLER-2             PIC X(351).                 02900000
029100*  FIN-LIM IN OUTPT ONLY                                          02910000
029200     07 TRL-RVNU-FIN-LIM              PIC S9(5)V99 COMP-3.        02920000
029300****                                                              02930000
029400     03  ITEM-CODES.                                              02940000
029500         05  PIC X(34) VALUE '123456789ABCDEFGHIJKLMNOPQRSTUVWXY'.02950000
029600         05  PIC X(24) VALUE 'ZZZZZZZZZZZZZZZZZZZZZZZZ'.          02960000
029700      03 FILLER                REDEFINES ITEM-CODES.              02970000
029800         05  ITEM-CODE           PIC X(01)    OCCURS 58.          02980000
029900     03  ITEM-ID                 PIC X(01)    VALUE SPACE.        02990000
030000     03  FILLER              PIC X(01)    VALUE SPACE.            03000000
030100          88 TOT-EQ-NONCOV-RESET          VALUE ' '.              03010000
030200          88 TOT-EQ-NONCOV                 VALUE 'Y'.             03020000
030300          88 TOT-NEQ-NONCOV                VALUE 'N'.             03030000
030400                                                                  03040000
030500 01  DISPLAY-AREA.                                                03050065
030600     03  DISPLAY-ERROR-CODES   PIC X(220) VALUE SPACES.           03060065
030700                                                                  03070065
030800 01  EDIT-WORK.                                                   03080065
030900     03  EDIT-INDICIES.                                           03090000
031000         05  CATEG               PIC S9(4)    VALUE ZERO COMP.    03100000
031100         05  COND                PIC S9(4)    VALUE ZERO COMP.    03110000
031200         05  DIAG                PIC S9(4)    VALUE ZERO COMP.    03120000
031300         05  DTL                 PIC S9(4)    VALUE ZERO COMP.    03130000
031400         05  HCPC                PIC S9(4)    VALUE ZERO COMP.    03140000
031500         05  X                   PIC S9(4)    VALUE ZERO COMP.    03150000
031600         05  Y                   PIC S9(4)    VALUE ZERO COMP.    03160099
031700         05  RNK                 PIC S9(4)    VALUE ZERO COMP.    03170099
031800         05  RVX                 PIC S9(4)    VALUE ZERO COMP.    03180000
031900         05  RVNU-MAX            PIC S9(4)    VALUE +028 COMP.    03190000
032000         05  ABNX                PIC S9(4)    VALUE ZERO COMP.    03200000
032100         05  ABNY                PIC S9(4)    VALUE ZERO COMP.    03210000
032200         05  TRLR                PIC S9(4)    VALUE ZERO COMP.    03220000
032300         05  VALU                PIC S9(4)    VALUE ZERO COMP.    03230000
032400         05  VALU-MAX            PIC S9(4)    VALUE +009 COMP.    03240000
032500         05  VALXX-NDX           PIC S9(4)    VALUE ZERO COMP.    03250000
032600         05  VALXY-NDX           PIC S9(4)    VALUE ZERO COMP.    03260000
032700         05  VALXZ-NDX           PIC S9(4)    VALUE ZERO COMP.    03270000
032800         05  SUBX                   PIC S9(3)  COMP VALUE +0.     03280000
032900         05  SUBY                   PIC S9(3)  COMP VALUE +0.     03290000
033000         05  SUBZ                   PIC S9(3)  COMP VALUE +0.     03300000
033100         05  DISP-NBRA           PIC  9(3)    VALUE ZERO.         03310087
033200         05  DISP-NBRB           PIC  9(3)    VALUE ZERO.         03320088
033300         05  DISP-NBRC           PIC  9(3)    VALUE ZERO.         03330091
033400         05  R0624-CTR           PIC  99      VALUE ZERO.         03340000
033500         05  DEMO-CTR            PIC  99      VALUE ZERO.         03350000
033600         05  E0420-CTR           PIC 999      VALUE ZERO.         03360000
033700         05  RVNU                PIC 999      VALUE ZERO.         03370000
033800         05  RVNU0023-NDX        PIC 999      VALUE ZERO.         03380000
033900         05  ERR-CTR             PIC  9(3)    VALUE ZERO.         03390099
034000         05  WS-CTR              PIC  9(3)    VALUE ZERO.         03400099
034100         05  ERR-QAR5-CTR        PIC  9(3)    VALUE ZERO.         03410099
034200         05  CALCDAYS            PIC  9(8)    VALUE ZERO.         03420000
034300         05  PREV-ERROR-CODE     PIC  X(4)    VALUE SPACES.       03430099
034400*                                                                 03440099
034500*  NB: ERROR CODES LEFT IN CODE, BUT NOT TRIGGERED BY THE 07/29   03450099
034600*      FILE: LEAVING LOGIC INTACT FROM PROD.                      03460099
034700*      IF NEED TO TRIGGER MORE EDIT ERRORS                        03470099
034800*      CHANGE DATA TO INVOKE, AND ADD TO THE ERROR-RNK TBL.       03480099
034900*      IF THEY DO GET INVOKED SOMEHOW, WILL SHOW AS RANK 999      03490099
035000*      AND 'DISPLAY UNKNOWN ERROR' E.G. NOT IN TABLE.             03500099
035100*                                                                 03510099
035200*      DEMO-TRAILER : 5277 4603 5800                              03520099
035300*      VALU-TRAILER : 0414                                        03530099
035400***OUT MQANDATE CALL: 51XP 51XX 51XY                              03540099
035500*      IN A002 EDIT : 8894                                        03550099
035600*      IN RVNU EDIT : 9901                                        03560099
035700*      PPL DGNS     : 4502 IN CODE THAT TESTS: EVAL X ALSO X      03570099
035800*     PPS-GENL-EDITS: A041 2213 46#U 0415 0418                    03580099
035900                                                                  03590099
036000     03  ERROR-RANKING-AREA.                                      03600099
036100         05  WS-ERROR-RANK-ENTRIES.                               03610099
036200           07 FILLER PIC X(45)                                    03620099
036300            VALUE 'A002 100 CAN, MBI, BENE-ID-TYPE FORMAT ERROR'. 03630099
036400           07 FILLER PIC X(45)                                    03640099
036500            VALUE 'Y001 200 HHAB SPLIT CLAIM'.                    03650099
036600           07 FILLER PIC X(45)                                    03660099
036700            VALUE 'Y0X4 650 HCPC NOT VALID FOR SVC DATE'.         03670099
036800           07 FILLER PIC X(45)                                    03680099
036900            VALUE 'Y0X5 300 BENE AGE >=115'.                      03690099
037000           07 FILLER PIC X(45)                                    03700099
037100            VALUE '0014 400 DEMO NUM INVALID FOR CLAIM'.          03710099
037200           07 FILLER PIC X(45)                                    03720099
037300            VALUE '0419 250 RICV,W;U VAL 62/63;XX-Y-Z MISSING'.   03730099
037400           07 FILLER PIC X(45)                                    03740099
037500            VALUE '46#V 150 TOB 32/33X VC62/63 <> RC42-44+55-57'. 03750099
037600**         07 FILLER PIC X(45)                                    03760099
037700**          VALUE '46X1 450 VALUE AMOUNT INVALID'.                03770099
037800**         07 FILLER PIC X(45)                                    03780099
037900**          VALUE '51XX 500 HCPCS INVALID FOR RC+TOB+SVC DATE'.   03790099
038000**         07 FILLER PIC X(45)                                    03800099
038100**          VALUE '51XY 500 TOB 32/33X + RC 0023 REQ HRG CODE'.   03810099
038200           07 FILLER PIC X(45)                                    03820099
038300            VALUE '51XZ 500 TOB 32/33X INVALID RC CODE 0624'.     03830099
038400           07 FILLER PIC X(45)                                    03840099
038500            VALUE '61XH 600 MEDICARE PAYMENT AMT ERROR'.          03850099
038600           07 FILLER PIC X(45)                                    03860099
038700            VALUE '6101C200 REV COMPUTED CHARGES INCORRECT'.      03870099
038800           07 FILLER PIC X(45)                                    03880099
038900            VALUE '6102C200 REV COMPUTED NON-COVERED/NON-COV'.    03890099
039000           07 FILLER PIC X(45)                                    03900099
039100            VALUE '6106C300 TOB 3X2, RC0023 CHG <> RC0001 CHG'.   03910099
039200           07 FILLER PIC X(45)                                    03920099
039300            VALUE '8904 250 HHA A/B SPLIT BYP'.                   03930099
039400           07 FILLER PIC X(45)                                    03940099
039500            VALUE 'XXXX 999 UNKNOWN ERROR CODE'.                  03950099
039600           07 FILLER PIC X(45)                                    03960099
039700            VALUE 'XXXX 999 UNKNOWN ERROR CODE'.                  03970099
039800           07 FILLER PIC X(45)                                    03980099
039900            VALUE 'XXXX 999 UNKNOWN ERROR CODE'.                  03990099
040000     03  FILLER REDEFINES ERROR-RANKING-AREA.                     04000099
040100        05 ERROR-RNK-TBL    OCCURS 16 TIMES.                      04010099
040200           07 ERR-RNK-CODE        PIC X(4).                       04020099
040300           07 FILLER              PIC X(1).                       04030099
040400           07 ERR-RNK-RANK        PIC X(3).                       04040099
040500           07 FILLER              PIC X(1).                       04050099
040600           07 ERR-RNK-DESC        PIC X(36).                      04060099
040700     03  ERROR-TBL-MAX       PIC 99 VALUE 16.                     04070099
040800                                                                  04080099
040900     03  WS-SORT-ERRORS-AREA VALUE SPACES.                        04090099
041000         05 SORT-ERROR-CODES OCCURS 13 TIMES.                     04100099
041100            07 SORT-ERROR-CODE  PIC X(04).                        04110099
041200            07 SORT-ERROR-RANK  PIC X(3).                         04120099
041300*                                                                 04130099
041400     03  EDIT-SWITCHES.                                           04140000
041500*   2 IS OBSOLETE ACT-CREDIT-CANCEL          VALUE '2' '4' '6'.   04150000
041600         05  ACT-CDE-SW          PIC X(01)    VALUE SPACE.        04160000
041700             88  ACT-CREDIT-CANCEL            VALUE '4' '6'.      04170000
041800             88  ACT-CANCEL-ONLY              VALUE '4'.          04180000
041900             88  ACT-CREDIT-ONLY              VALUE '6'.          04190000
042000             88  ACT-CDE-135                  VALUE '1' '3' '5'.  04200000
042100         05  TEST-TOBXX          PIC X(02) VALUE SPACE.           04210000
042200             88 TOB-11        VALUE '11'.                         04220000
042300             88 TOB-12        VALUE '12'.                         04230000
042400             88 TOB-13        VALUE '13'.                         04240000
042500             88 TOB-14        VALUE '14'.                         04250000
042600             88 TOB-18        VALUE '18'.                         04260000
042700             88 TOB-21        VALUE '21'.                         04270000
042800             88 TOB-22        VALUE '22'.                         04280000
042900             88 TOB-23        VALUE '23'.                         04290000
043000             88 TOB-28        VALUE '28'.                         04300000
043100             88 TOB-32        VALUE '32'.                         04310000
043200             88 TOB-33        VALUE '33'.                         04320000
043300             88 TOB-34        VALUE '34'.                         04330000
043400             88 TOB-HOME-HEALTH VALUE '32' THRU '34'.             04340000
043500             88 TOB-41        VALUE '41'.                         04350000
043600             88 TOB-51        VALUE '51'.                         04360000
043700             88 TOB-71        VALUE '71'.                         04370000
043800             88 TOB-72        VALUE '72'.                         04380000
043900             88 TOB-73        VALUE '73'.                         04390000
044000             88 TOB-74        VALUE '74'.                         04400000
044100             88 TOB-75        VALUE '75'.                         04410000
044200             88 TOB-76        VALUE '76'.                         04420000
044300             88 TOB-77        VALUE '77'.                         04430000
044400             88 TOB-81        VALUE '81'.                         04440000
044500             88 TOB-82        VALUE '82'.                         04450000
044600             88 TOB-83        VALUE '83'.                         04460000
044700             88 TOB-85        VALUE '85'.                         04470000
044800         05  BYPASS-SW           PIC X(01)    VALUE SPACE.        04480000
044900             88  BYPASS-OFF                   VALUE SPACE.        04490000
045000             88  BYPASS                       VALUE 'Y'.          04500000
045100         05  A002-SW             PIC X(01)    VALUE SPACE.        04510077
045200             88  A002-DOIT                    VALUE SPACE.        04520077
045300             88  A002-BYP                     VALUE 'Y'.          04530077
045400         05  FILLER              PIC X(01)    VALUE SPACE.        04540000
045500             88 COND-M2                       VALUE 'Y'.          04550000
045600         05  HHA-DEMO-PROVIDER             PIC X(6).              04560000
045700             88 VALID-HHA-DEMO-PROVIDER    VALUE                  04570000
045800           '057002' '057008' '057018' '057021' '057040' '057129'  04580000
045900           '057132' '057517' '057666' '057678' '107023' '107156'  04590000
046000           '107254' '107281' '147176' '147200' '147280' '147483'  04600000
046100           '147493' '147497' '147503' '227010' '227033' '227052'  04610000
046200           '227065' '227079' '227098' '227127' '457029' '457083'  04620000
046300           '457124' '457126' '457223' '457239' '457248' '457380'  04630000
046400           '457513' '457663' '457758' '557025' '557092' '677032'  04640000
046500           '677118' '677135' '677155' '677412' '677433'.          04650000
046600* IHP R20071HP                                                    04660000
046700*        05  TEST-PROV     PIC X(06) VALUE SPACES.                04670099
046800*            88  INDIAN-HEALTH       VALUE                        04680099
046900*                     '020018' THRU '020021'                      04690099
047000*                     '020026' '020027'                           04700099
047100*                     '030071' THRU '030079'                      04710099
047200*                     '030084'                                    04720099
047300*                     '050643'                                    04730099
047400*                     '240205' THRU '240206'                      04740099
047500*                     '250127'                                    04750099
047600*                     '270074' THRU '270076'                      04760099
047700*                     '271315' '280119'                           04770099
047800*                     '290029'                                    04780099
047900*                     '320056' THRU '320062'                      04790099
048000*                     '320070' '340156'                           04800099
048100*                     '350063' '350064'                           04810099
048200*                     '370170' THRU '370174'                      04820099
048300*                     '370180' '370898'                           04830099
048400*                     '430081' THRU '430086'.                     04840099
048500*            88  GUAM-MEML           VALUE '650001'.              04850099
048600*            88  LBJ-TROPC           VALUE '640001'.              04860099
048700*            88  COMM-HLTH           VALUE '660001'.              04870099
048800*            88  VIRGIN-ISL          VALUE '480001' '480002'.     04880099
048900*        05  TEST-PROV6 REDEFINES TEST-PROV.                      04890099
049000*            07  TEST-PROV1-2    PIC X(02).                       04900099
049100*               88  MD          VALUE '21'.                       04910099
049200*               88  VI          VALUE '48'.                       04920099
049300*               88  AS          VALUE '64'.                       04930099
049400*               88  GU          VALUE '65'.                       04940099
049500*               88  MI          VALUE '66'.                       04950099
049600*            07  TEST-PROV3-6    PIC X(04).                       04960099
049700*               88  CRIT-ACCESS-HOSP VALUE '1300' THRU '1399'     04970099
049800*                                      '9000' THRU '9799'.        04980099
049900                                                                  04990000
050000         05 TEST-HIPPS-CODE.                                      05000000
050100             07 HIPPS-1          PIC X.                           05010000
050200                88 HIPPS-1-OK       VALUE '1' THRU '5'.           05020000
050300             07 HIPPS-2          PIC X.                           05030000
050400                88 HIPPS-2-OK       VALUE 'A' THRU 'C'.           05040000
050500             07 HIPPS-3          PIC X.                           05050000
050600                88 HIPPS-3-OK       VALUE 'F' THRU 'H'.           05060000
050700             07 HIPPS-4          PIC X.                           05070000
050800                88 HIPPS-4-OK       VALUE 'K' THRU 'N', 'P'.      05080000
050900             07 HIPPS-5          PIC X.                           05090000
051000                88 HIPPS-5-OK       VALUE 'S' THRU 'X',           05100000
051100                                          '1' THRU '6'.           05110000
051200                                                                  05120000
051300         05  ERROR-0011          PIC X(01)    VALUE '?'.          05130000
051400         05  ERROR-0401          PIC X(01)    VALUE 'F'.          05140000
051500             88  ERR-0401-FAIL                VALUE 'F'.          05150000
051600             88  ERR-0401-PASS                VALUE 'P'.          05160000
051700         05  FILLER              PIC X(01)    VALUE SPACE.        05170000
051800             88  ERR-0419                     VALUE 'Y'.          05180000
051900         05  ERROR-220X          PIC X(01)    VALUE 'N'.          05190000
052000         05  ERROR-28X1          PIC X(01)    VALUE '?'.          05200000
052100         05  FILLER              PIC X        VALUE SPACE.        05210000
052200             88  VALID-CANCER-DIAG    VALUE 'Y'.                  05220000
052300         05  TST-RVNU-HCPC       PIC X(05)    VALUE  SPACE.       05230000
052400             88 ANTI-CA-DRUG  VALUE 'J8510' 'J8520' 'J8521'       05240000
052500            'J8530' 'J8560' 'J8600' 'J8610' 'J9000' 'J9015'       05250000
052600            'J9020' 'J9031' 'J9040' 'J9045' 'J9050' 'J9060'       05260000
052700            'J9062' 'J9065' 'J9070' 'J9080' 'J9090' THRU 'J9097'  05270000
052800            'J9100' 'J9110' 'J9120' 'J9130' 'J9140' 'J9150'       05280000
052900            'J9165' 'J9170' 'J9181' 'J9182' 'J9185' 'J9190'       05290000
053000            'J9200' 'J9201' 'J9202' 'J9206' 'J9208' 'J9209'       05300000
053100            'J9211' 'J9213'  THRU   'J9218' 'J9230' 'J9245'       05310000
053200            'J9250' 'J9260' 'J9265' 'J9266' 'J9268' 'J9270'       05320000
053300            'J9280' 'J9290' 'J9291' 'J9293' 'J9320' 'J9340'       05330000
053400            'J9350' 'J9360' 'J9370' 'J9375' 'J9380' 'J9390'       05340000
053500            'J9600' 'J9999'.                                      05350000
053600             88 ANTI-BARF-DRUG VALUE   'Q0163' THRU 'Q0181'       05360000
053700            'C9235' 'J0894' 'J2469' 'J8501' 'J8565' 'J9025'       05370000
053800            'J9027' 'J9035' 'J9041' 'J9055' 'J9261' 'J9264'       05380000
053900            'J9305'.                                              05390000
054000             88 OXYGEN-CONTENTS-88 VALUE 'E0425' 'E0430' 'E0435'  05400000
054100                                         'E0440' 'E0580'.         05410000
054200             88 E6914-BYP-HCPC VALUE                              05420000
054300         'K0607' 'E0117' 'E0620' 'A7025' 'E0300' 'A4639'          05430000
054400         'E0762' 'E1700' 'K0730' 'E0740' 'E0764' 'E0656'          05440000
054500         'E0657' 'E0984' 'E2500' 'E2502' 'E2504' 'E2506'          05450000
054600         'E2508' 'E2510' 'E0198' 'E0849' 'E0855' 'E0856'          05460000
054700         'E0144' 'E1161' 'E1232' 'E1233' 'E1234' 'E1235'          05470000
054800         'E1236' 'E1237' 'E1238' 'E0986' 'E1002' 'E1003'          05480000
054900         'E1004' 'E1005' 'E1006' 'E1007' 'E1008' 'E1010'          05490000
055000         'E1014' 'E1029' 'E1030' 'E2227' 'E2310' 'E2311'          05500000
055100         'E2312' 'E2313' 'E2321' 'E2322' 'E2325' 'E2326'          05510000
055200         'E2327' 'E2328' 'E2329' 'E2330' 'E2351' 'E2373'          05520000
055300         'E2374' 'E2376' 'E2377' 'E2378'.                         05530000
055400             88 E6914-BYP-HCPC-R2016300 VALUE                     05540000
055500         'E0197' 'E0140' 'E0149' 'E0985' 'E1020' 'E1028'          05550000
055600         'E2228' 'E2368' 'E2369' 'E2370' 'E2375' 'K0015'          05560000
055700         'K0070' 'E0955'.                                         05570000
055800                                                                  05580000
055900         05  TST-RVNU-CTR        PIC X(04)    VALUE  SPACE.       05590000
056000             88 E51X0-RC1      VALUE '0001' THRU '0999'           05600000
056100                                     '2100' THRU '2109'           05610000
056200                                     '3101' THRU '3105' '3109'.   05620000
056300         05  ERROR-51XF-SW       PIC X(01)    VALUE SPACE.        05630000
056400         05  ERROR-51XX-SW       PIC X(01)    VALUE 'N'.          05640000
056500             88  ERROR-51XX                   VALUE '0' THRU '9'. 05650000
056600         05  FILLER              PIC X(01)    VALUE 'N'.          05660000
056700             88  BYPASS-6109                  VALUE 'Y'.          05670000
056800         05  FILLER              PIC X(01)    VALUE 'N'.          05680000
056900             88  NCD-SVCS-HCPC                VALUE 'Y'.          05690000
057000         05  FILLER              PIC X(01)    VALUE 'N'.          05700000
057100             88  MSP-VALCD                    VALUE 'Y'.          05710000
057200         05  EDIT-8301-SWS                    VALUE 'NNNN'.       05720000
057300           07  FILLER            PIC X(01).                       05730000
057400             88  EDIT-8301-HCPCS              VALUE 'Y'.          05740000
057500           07  FILLER            PIC X(01).                       05750000
057600             88  EDIT-8301-COND1              VALUE 'Y'.          05760000
057700           07  FILLER            PIC X(01).                       05770000
057800             88  EDIT-8301-COND2              VALUE 'Y'.          05780000
057900           07  FILLER            PIC X(01).                       05790000
058000             88  EDIT-8301-COND3              VALUE 'Y'.          05800000
058100         05  ERROR-993X          PIC X(01)    VALUE 'N'.          05810000
058200         05  ERROR-994X          PIC X(01)    VALUE 'N'.          05820000
058300         05  0001-SW             PIC X(01)    VALUE 'N'.          05830000
058400             88 0001-FOUND       VALUE 'Y'.                       05840000
058500             88 0001-NOT-FOUND   VALUE 'N'.                       05850000
058600** MBI VALUES                                                     05860000
058700         05  MBI-POS-2           PIC X(01)    VALUE SPACES.       05870000
058800             88 INVLD-MBI-POS-2  VALUE 'S' 'L' 'O'  'I' 'B' 'Z'.  05880000
058900         05  MBI-POS-5           PIC X(01)    VALUE SPACES.       05890000
059000             88 INVLD-MBI-POS-5  VALUE 'S' 'L' 'O'  'I' 'B' 'Z'.  05900000
059100         05  MBI-POS-8           PIC X(01)    VALUE SPACES.       05910000
059200             88 INVLD-MBI-POS-8  VALUE 'S' 'L' 'O'  'I' 'B' 'Z'.  05920000
059300         05  MBI-POS-9           PIC X(01)    VALUE SPACES.       05930000
059400             88 INVLD-MBI-POS-9  VALUE 'S' 'L' 'O'  'I' 'B' 'Z'.  05940000
059500         05  MBI-POS-3           PIC X(01)    VALUE SPACES.       05950000
059600             88 INVLD-MBI-POS-3  VALUE 'S' 'L' 'O'  'I' 'B' 'Z'.  05960000
059700         05  MBI-POS-6           PIC X(01)    VALUE SPACES.       05970000
059800             88 INVLD-MBI-POS-6  VALUE 'S' 'L' 'O'  'I' 'B' 'Z'.  05980000
059900         05  WS-ALNUM-POS-3      PIC X(01)    VALUE 'N'.          05990000
060000             88 NOTALNUM-POS-3   VALUE 'Y'.                       06000000
060100         05  WS-ALNUM-POS-6      PIC X(01)    VALUE 'N'.          06010000
060200             88 NOTALNUM-POS-6   VALUE 'Y'.                       06020000
060300                                                                  06030000
060400**VI E F G H J K ADDED PER R2000.1;Z ADDED R2000.3                06040000
060500         05  TEST-NOPAY          PIC X(02)    VALUE SPACES.       06050000
060600             88 VALID-NOPAY VALUE 'B ' THRU 'H '                  06060000
060700             'J ' 'K ' 'M ' 'N ' 'P ' 'Q ' 'R ' 'T ' THRU 'Z '    06070000
060800             '00' '12' THRU '19' '21' '22' '25' '26' '41' '43'    06080000
060900             '39' '42'.                                           06090000
061000* R2017300 REQ 30 R2017400                                        06100000
061100             88 VALID-NOPAY-94G1 VALUE 'B ' THRU 'H '             06110000
061200             'J ' 'K ' 'M ' 'N ' 'P ' 'Q ' 'R ' 'T ' THRU 'Z '    06120000
061300             '00' '12' THRU '19' '21' '22' '25' '26' '41' '43'    06130000
061400             '39' '42' '44' '45'.                                 06140000
061500* R2011200   '00' '12' THRU '19' '21' '22' '25' '26'.             06150000
061600* V.I        '!' '@' '#' '$' '*' '(' ')' '+' '=' '<' '>' '%' '&'. 06160000
061700             88 VALID-NOPAY-SPACE VALUE SPACE.                    06170000
061800             88 NOPAY-N           VALUE 'N '.                     06180000
061900             88 NOPAY-B           VALUE 'B '.                     06190000
062000             88 NOPAY-R           VALUE 'R '.                     06200000
062100             88 A041-BYPASS VALUE 'B ' 'E ' THRU 'H ' 'J ' 'K '   06210000
062200                                  'N ' 'Q ' 'T ' THRU 'Y '        06220000
062300*            '00' '12' THRU '19' '21' '22' '25' '26' '41' '43'.   06230000
062400             '00' '12' THRU '19' '21' '22' '25' '26' '41' '42'    06240000
062500             '43'.                                                06250000
062600* R2012100                                                        06260000
062700             88 MSP-COST-AVOID    VALUE 'E ' THRU 'H '            06270000
062800                'J ' 'K ' 'Q ' 'T ' 'U ' 'V ' 'X ' 'Y ' 'Z '      06280000
062900                '00' '12' THRU '19' '21' '22' '25' '26' '41'      06290000
063000                '43' '39' '42'.                                   06300000
063100         05  NO-PAYMENT-BILL-SW  PIC X(01)    VALUE 'N'.          06310000
063200             88  PAYMENT-BILL                 VALUE 'N'.          06320000
063300             88  NO-PAYMENT-BILL              VALUE 'Y'.          06330000
063400         05  NOPAY-ERR-SW        PIC X(01)    VALUE 'N'.          06340000
063500             88  NOPAY-ERR                    VALUE 'Y'.          06350000
063600         05  FILLER              PIC X(01)    VALUE 'N'.          06360000
063700             88  OCCR-36-SEEN                 VALUE 'Y'.          06370000
063800         05  OCCR27SW            PIC X(01)    VALUE 'N'.          06380000
063900         05  OVERRIDE-SW         PIC X(01)    VALUE SPACE.        06390000
064000         05  PP-SW               PIC X(01)    VALUE SPACE.        06400000
064100         05  PSYCH-SW            PIC X(01)    VALUE SPACE.        06410000
064200         05  PROC-PRESENT-SW     PIC X(01)    VALUE 'N'.          06420000
064300             88  PROC-PRESENT                 VALUE 'Y'.          06430000
064400         05  RCC-0636-SW         PIC X(01)    VALUE 'N'.          06440000
064500             88  RCC-0636                     VALUE 'Y'.          06450000
064600         05  RVNU-66-SW          PIC X(01)    VALUE 'N'.          06460000
064700             88  RVNU-66                      VALUE 'Y'.          06470000
064800         05  FILLER              PIC X(01)    VALUE 'N'.          06480000
064900             88  RVNU-6922-A                  VALUE 'Y'.          06490000
065000         05  FILLER              PIC X(01)    VALUE 'N'.          06500000
065100             88  RVNU-6922-B                  VALUE 'Y'.          06510000
065200         05  FILLER              PIC X(01)    VALUE 'N'.          06520000
065300             88  RVNU22-SEEN                VALUE 'Y'.            06530000
065400         05  FILLER              PIC X(01)    VALUE 'N'.          06540000
065500             88  RVNU23-SEEN                VALUE 'Y'.            06550000
065600         05  FILLER              PIC X(01)    VALUE 'N'.          06560000
065700             88  RVNU24-SEEN                VALUE 'Y'.            06570000
065800         05  FILLER              PIC X(01)    VALUE 'N'.          06580000
065900             88  RVNU-380-SEEN                VALUE 'Y'.          06590000
066000         05  FILLER              PIC X(01)    VALUE 'N'.          06600000
066100             88  RVNU-0820-SEEN               VALUE 'Y'.          06610000
066200         05  FILLER              PIC X(01)    VALUE 'N'.          06620000
066300             88  RVNU-CTR-74X-SEEN            VALUE 'Y'.          06630000
066400         05  FILLER              PIC X(01)    VALUE 'N'.          06640000
066500             88  VET-MSP                      VALUE 'Y'.          06650000
066600         05  FILLER              PIC X(01)    VALUE 'N'.          06660000
066700             88  SURG-PRESENT                 VALUE 'Y'.          06670000
066800         05  FILLER              PIC X(01)    VALUE 'N'.          06680000
066900             88  UPIN-PRESENT                 VALUE 'Y'.          06690000
067000         05  V25-DIAG-CODE.                                       06700000
067100              08 V25-DIAG-CHAR   PIC X(01)    OCCURS 7.           06710000
067200         05  FILLER              PIC X(01)    VALUE 'N'.          06720000
067300             88 I-DIAG-SEEN                   VALUE 'Y'.          06730000
067400         05  FILLER              PIC X(01)    VALUE 'N'.          06740000
067500             88 J-DIAG-SEEN                   VALUE 'Y'.          06750000
067600         05  FILLER             PIC X(01)     VALUE 'N'.          06760000
067700             88  COND-C1                      VALUE 'Y'.          06770000
067800         05  FILLER             PIC X(01)     VALUE 'N'.          06780000
067900             88  COND-C3                      VALUE 'Y'.          06790000
068000         05  FILLER             PIC X(01)     VALUE 'N'.          06800000
068100             88  COND-C4                      VALUE 'Y'.          06810000
068200         05  FILLER             PIC X(01)     VALUE 'N'.          06820000
068300             88  COND-C5                      VALUE 'Y'.          06830000
068400         05  FILLER             PIC X(01)     VALUE 'N'.          06840000
068500             88  COND-C6                      VALUE 'Y'.          06850000
068600         05  FILLER             PIC X(01)     VALUE 'N'.          06860000
068700             88  COND-C7                      VALUE 'Y'.          06870000
068800         05  FILLER             PIC X(01)     VALUE 'N'.          06880000
068900             88  COND-26                      VALUE 'Y'.          06890000
069000         05  FILLER             PIC X(01)     VALUE 'N'.          06900000
069100             88  COND-58                      VALUE 'Y'.          06910000
069200         05  FILLER             PIC X(01)     VALUE 'N'.          06920000
069300             88  COND-WO                      VALUE 'Y'.          06930000
069400         05  FILLER              PIC X(01)    VALUE 'N'.          06940000
069500             88  COND-69                      VALUE 'Y'.          06950000
069600         05  FILLER             PIC X(01)     VALUE 'N'.          06960000
069700             88  COND-NULL                    VALUE 'Y'.          06970000
069800         05  COND-69-ITEM-ID     PIC X(01)    VALUE '1'.          06980000
069900         05  FILLER              PIC X(01)    VALUE 'N'.          06990000
070000             88  COND-78                      VALUE 'Y'.          07000000
070100         05  FILLER              PIC X(01)    VALUE 'N'.          07010000
070200             88  RISK-HMO-SVC                 VALUE 'Y'.          07020000
070300     03  HHAB-FIELDS.                                             07030000
070400         05  FILLER              PIC X(01) VALUE SPACE.           07040000
070500             88  E8904-NOT-SEEN  VALUE ' '.                       07050000
070600             88  E8904-SEEN      VALUE 'Y'.                       07060000
070700         05  FILLER              PIC X(01) VALUE SPACE.           07070000
070800             88  HHAB-SPLIT-RVNU-CTR VALUE 'Y'.                   07080000
070900         05  FILLER              PIC X(01)    VALUE SPACES.       07090000
071000             88  SKIP-HHAB-RAP                VALUE 'Y'.          07100000
071100         05  FILLER              PIC X(01)    VALUE SPACES.       07110000
071200             88  VALCD-42-SEEN                VALUE 'Y'.          07120000
071300         05  FILLER              PIC X(01)    VALUE SPACES.       07130000
071400             88  VALCD-62-SEEN                VALUE 'Y'.          07140000
071500         05  FILLER              PIC X(01)    VALUE SPACES.       07150000
071600             88  VALCD-63-SEEN                VALUE 'Y'.          07160000
071700         05  FILLER              PIC X(01)    VALUE SPACES.       07170000
071800             88  VALCD-64-SEEN                VALUE 'Y'.          07180000
071900         05  FILLER              PIC X(01)    VALUE SPACES.       07190000
072000             88  VALCD-65-SEEN                VALUE 'Y'.          07200000
072100         05  FILLER              PIC X(01)    VALUE ' '.          07210000
072200             88  SORT-DONE                    VALUE 'Y'.          07220000
072300             88  SORT-NOT-DONE                VALUE 'N'.          07230000
072400     03  EDIT-VALUES.                                             07240000
072500         05  COIN-AMT1           PIC S9(9)V99 VALUE ZERO COMP-3.  07250000
072600         05  COIN-AMT2           PIC S9(9)V99 VALUE ZERO COMP-3.  07260000
072700         05  COIN-RATE           PIC S9(5)V99 VALUE ZERO COMP-3.  07270000
072800         05  OUTPAT-DED          PIC S9(9)V99 VALUE ZERO COMP-3.  07280000
072900         05  LR-AMT-08           PIC S9(9)V99 VALUE ZERO COMP-3.  07290000
073000         05  LR-AMT-10           PIC S9(9)V99 VALUE ZERO COMP-3.  07300000
073100         05  REV-BLOOD-DEDUCT    PIC S9(9)V99 VALUE ZERO COMP-3.  07310000
073200         05  REV-CASH-DEDUCT     PIC S9(9)V99 VALUE ZERO COMP-3.  07320000
073300         05  REV-PROF-COMP       PIC S9(9)V99 VALUE ZERO COMP-3.  07330000
073400         05  REV-PROV-PMT        PIC S9(9)V99 VALUE ZERO COMP-3.  07340000
073500         05  REV-PATIENT-AMT     PIC S9(9)V99 VALUE ZERO COMP-3.  07350000
073600         05  REV-PATIENT-RESP    PIC S9(9)V99 VALUE ZERO COMP-3.  07360000
073700         05  REV-PAYMENT-AMT     PIC S9(9)V99 VALUE ZERO COMP-3.  07370000
073800         05  CASH-DED-AMOUNT     PIC S9(9)V99 VALUE ZERO COMP-3.  07380000
073900         05  CASH-DED-VALUES     PIC S9(3)    VALUE ZERO COMP-3.  07390000
074000         05  CASH-DED-ITEM       PIC X(01).                       07400000
074100         05  COINS-MAX           PIC S9(9)V99 VALUE ZERO COMP-3.  07410000
074200         05  COINS-OUTP          PIC S9(9)V99 VALUE ZERO COMP-3.  07420000
074300         05  COMP-NCOV           PIC S9(9)V99 VALUE ZERO COMP-3.  07430000
074400         05  COMP-TOTL           PIC S9(9)V99 VALUE ZERO COMP-3.  07440000
074500         05  EDIT-NCOV           PIC S9(9)V99 VALUE ZERO COMP-3.  07450000
074600         05  EDIT-TOTL           PIC S9(9)V99 VALUE ZERO COMP-3.  07460000
074700         05  EDIT-AMOUNT         PIC S9(9)V99 VALUE ZERO COMP-3.  07470000
074800         05  SUM-UNITS           PIC S9(9)    VALUE ZERO COMP-3.  07480000
074900         05  PRIM-AMOUNT         PIC S9(9)V99 VALUE ZERO COMP-3.  07490000
075000         05  PROF-AMOUNT         PIC S9(9)V99 VALUE ZERO COMP-3.  07500000
075100         05  PSYCH-MAX           PIC S9(9)V99 VALUE ZERO COMP-3.  07510000
075200         05  VALCD-62-AMT        PIC S9(9)V99 VALUE ZERO COMP-3.  07520000
075300         05  VALCD-63-AMT        PIC S9(9)V99 VALUE ZERO COMP-3.  07530000
075400         05  VALCD-64-AMT        PIC S9(9)V99 VALUE ZERO COMP-3.  07540000
075500         05  VALCD-65-AMT        PIC S9(9)V99 VALUE ZERO COMP-3.  07550000
075600         05  E46XV-UNITS         PIC S9(9)    VALUE ZERO COMP-3.  07560000
075700         05  RVNU0023-UNITS      PIC S9(9)    VALUE ZERO COMP-3.  07570000
075800         05  RVNU0023-TOTAL      PIC S9(9)V99 VALUE ZERO COMP-3.  07580000
075900         05  RVNUNE23-TOTAL      PIC S9(9)V99 VALUE ZERO COMP-3.  07590000
076000     03  WS-AB-FIELDS.                                            07600000
076100         05  WS-A-VISIT  PIC S9(4)    COMP    VALUE ZERO.         07610000
076200         05  WS-B-VISIT  PIC S9(4)    COMP    VALUE ZERO.         07620000
076300         05  WS-A-AMT    PIC S9(9)V99 COMP-3  VALUE ZERO.         07630000
076400         05  WS-B-AMT    PIC S9(9)V99 COMP-3  VALUE ZERO.         07640000
076500         05  WS-C-AMT    PIC S9(9)V99 COMP-3  VALUE ZERO.         07650000
076600         05  WS-AB-AMT   PIC S9(9)V99 COMP-3  VALUE ZERO.         07660000
076700         05  WS-A-AMTD   PIC -ZZZZZ,ZZZ.99    VALUE ZERO.         07670096
076800         05  WS-B-AMTD   PIC -ZZZZZ,ZZZ.99    VALUE ZERO.         07680096
076900         05  WS-C-AMTD   PIC -ZZZZZ,ZZZ.99    VALUE ZERO.         07690096
077000         05  WS-AB-AMTD  PIC -ZZZZZ,ZZZ.99    VALUE ZERO.         07700096
077100     03  HOLD-BLOOD-EDITS                     VALUE SPACES.       07710000
077200         05  HOLD-CODE           PIC X(02).                       07720000
077300     03  HOLD-BLOOD-EDIT-AMOUNTS.                                 07730000
077400         05  HOLD-AMOUNT           PIC S9(7)V99 VALUE ZERO COMP-3.07740000
077500         05  HOLD-BLD-DEDUCT       PIC S9(7)V99 VALUE ZERO COMP-3.07750000
077600         05  HOLD-RVNU-UNITS       PIC S9(7)V99 VALUE ZERO COMP-3.07760000
077700         05  HOLD-PINTS-FURNISHED  PIC S9(3)    VALUE ZERO COMP-3.07770000
077800         05  HOLD-PINTS-DEDUCTIBLE PIC S9(3)    VALUE ZERO COMP-3.07780000
077900         05  HOLD-PINTS-REPLACED   PIC S9(3)    VALUE ZERO COMP-3.07790000
078000         05  HOLD-PINTS-UNREPLCD   PIC S9(3)    VALUE ZERO COMP-3.07800000
078100     03  TEST-BIC-WORK                        VALUE SPACES.       07810000
078200         05  BIC-CODE-1          PIC X(02).                       07820000
078300         05  BIC-CODE-2          PIC X(02).                       07830000
078400         05  BIC-RETURN          PIC X(01).                       07840000
078500     03  UPIN-WORK                            VALUE SPACES.       07850000
078600         05  UPIN-CODE.                                           07860000
078700             07  UPIN-PREFIX     PIC X(03).                       07870000
078800                 88  UPIN-SPECIAL   VALUE 'INT' 'RES' 'VAD' 'PHS' 07880000
078900                        'BIA' 'NPP' 'OTH' 'SLF' 'RET'.            07890000
079000             07  UPIN-SUFFIX     PIC X(03).                       07900000
079100         05  FILLER              PIC X(10).                       07910000
079200         05  UPIN-NAME-INIT.                                      07920000
079300             07  UPIN-NAME           PIC X(6).                    07930000
079400             07  UPIN-INIT           PIC X(1).                    07940000
079500             07  UPIN-INIT-2         PIC X(1).                    07950000
079600         05  UPIN-ERROR.                                          07960000
079700          06 UPIN-ERROR-CODE     PIC X(04).                       07970000
079800          06 UPIN-ERROR-FLAG     PIC X(04).                       07980000
079900     03  TEST-DATES.                                              07990000
080000         05  STAY-FROM.                                           08000000
080100             07  STAY-FROM-DATE  PIC 9(08)    VALUE ZERO.         08010000
080200         05  FILLER REDEFINES STAY-FROM.                          08020000
080300             07  STAY-FROM-YR    PIC 9(04).                       08030000
080400             07  STAY-FROM-DAYS  PIC 9(04).                       08040000
080500         05  STAY-THRU.                                           08050000
080600             07  STAY-THRU-DATE  PIC 9(08)    VALUE ZERO.         08060000
080700         05  FILLER REDEFINES STAY-THRU.                          08070000
080800             07  STAY-THRU-YR    PIC 9(04).                       08080000
080900             07  STAY-THRU-DAYS  PIC 9(04).                       08090000
081000     03  ICD9-10-TST-DT          PIC 9(8)  VALUE 20151000.        08100000
081100     03  ERROR-FLAG              PIC X(01) VALUE SPACE.           08110000
081200     03  HOSPICE-0657            PIC 9 VALUE ZERO.                08120000
081300     03  HOSPICE-NOT-0657        PIC 9 VALUE ZERO.                08130000
081400     03  SERVICE-DATE-SW.                                         08140000
081500         05  SERVICE-DATE-IND    PIC X VALUE 'N'.                 08150000
081600         05  SERVICE-DATE-NUM    PIC 9 VALUE ZERO.                08160000
081700     03  HMOSUB                  PIC 9(2) VALUE ZERO.             08170000
081800     03  HMO-MAX                 PIC 9(2) VALUE ZERO.             08180000
081900     03  ERR-9960-SW             PIC X VALUE SPACE.               08190000
082000         88 ERR-9960             VALUE 'Y'.                       08200000
082100     03  ERR-3706-SW             PIC X VALUE SPACE.               08210000
082200         88 ERR-3706             VALUE 'Y'.                       08220000
082300     03  ERROR-5277-SW           PIC X VALUE 'N'.                 08230000
082400         88 ERROR-5277           VALUE 'Y'.                       08240000
082500     03  WS-IDE                  PIC X VALUE SPACE.               08250000
082600         88 WS-IDE-PRESENT       VALUE 'Y'.                       08260000
082700     03  FILLER                  PIC X VALUE SPACE.               08270000
082800         88 BPCI-DEMO            VALUE 'Y'.                       08280000
082900     03  FILLER                  PIC X VALUE SPACE.               08290000
083000         88 VTACO-DEMO           VALUE 'Y'.                       08300000
083100*    R2017200 REQ 3                                               08310000
083200*    03  FILLER                  PIC X VALUE SPACE.               08320000
083300*        88 CABG-DEMO            VALUE 'Y'.                       08330000
083400     03  FILLER                  PIC X VALUE SPACE.               08340000
083500         88 HHA-DEMO             VALUE 'Y'.                       08350000
083600*    03  FILLER                  PIC X VALUE SPACE.               08360000
083700*        88 ESRD-DEMO            VALUE 'Y'.                       08370000
083800*    03  FILLER                  PIC X VALUE SPACE.               08380000
083900*        88 PCOE-DEMO            VALUE 'Y'.                       08390000
084000*    03                          PIC X VALUE SPACE.               08400000
084100*        88 MPPP-DEMO            VALUE 'Y'.                       08410000
084200     03  FILLER                  PIC X VALUE SPACE.               08420000
084300         88 INDHLTH-DEMO         VALUE 'Y'.                       08430000
084400     03  FILLER                  PIC X VALUE SPACE.               08440000
084500         88 ADULT-CARE-DEMO      VALUE 'Y'.                       08450000
084600     03  FILLER                  PIC X VALUE SPACE.               08460000
084700         88 FREQ-HEMO-DEMO       VALUE 'Y'.                       08470000
084800*  DEMO 44                                                        08480000
084900     03  FILLER                  PIC X VALUE SPACE.               08490000
085000         88 VA-DEMO              VALUE 'Y'.                       08500000
085100     03  FILLER                  PIC X VALUE SPACE.               08510000
085200         88 HOMEBOUND-DEMO       VALUE 'Y'.                       08520000
085300     03  FILLER                  PIC X(01) VALUE SPACES.          08530000
085400         88 ACE-DEMO             VALUE 'Y'.                       08540000
085500     03  FILLER                  PIC X(01) VALUE SPACES.          08550000
085600         88 BNDL-CARE-DEMO1      VALUE 'Y'.                       08560000
085700     03  FILLER                  PIC X(01) VALUE SPACES.          08570000
085800         88 BNDL-CARE-DEMO2      VALUE 'Y'.                       08580000
085900     03  FILLER                  PIC X(01) VALUE SPACES.          08590000
086000         88 BNDL-CARE-DEMO3      VALUE 'Y'.                       08600000
086100     03  FILLER                  PIC X(01) VALUE SPACES.          08610000
086200         88 BNDL-CARE-DEMO4      VALUE 'Y'.                       08620000
086300     03  FILLER                  PIC X(01) VALUE SPACES.          08630000
086400         88 DEMO-59              VALUE 'Y'.                       08640000
086500         88 ACO-PAY-DEMO         VALUE 'Y'.                       08650000
086600     03  FILLER                  PIC X(01) VALUE SPACES.          08660000
086700         88 NG-ACO-DEMO          VALUE 'Y'.                       08670000
086800         88 DEMO-74              VALUE 'Y'.                       08680000
086900     03  FILLER                  PIC X(01) VALUE SPACE.           08690000
087000         88  DUP-RVNU-ERR  VALUE 'Y'.                             08700000
087100         88  DUP-RVNU-OK   VALUE 'N'.                             08710000
087200     03  HOLD-RVNU-C-I.                                           08720000
087300         05  HOLD-RVNU-ERR-CODE      PIC X(04) VALUE SPACE.       08730000
087400         05  HOLD-RVNU-ITM           PIC X(01) VALUE SPACE.       08740000
087500 01  EDIT-WORK-FORMAT            PIC X(1500).                     08750099
087600*                                                                 08760000
087700 01  RVNU-WORK.                                                   08770000
087800*COPY MQACRVNU REPLACING ==:X:== BY ====.                         08780067
087900**************************************************************    08790067
088000*   MQACRVNU SOLE RVNU LINE CPYBK  CR11                           08800067
088100* IF MOD, ALSO MOD INIT CODE IN MQAP010D                          08810067
088200**************************************************************    08820067
088300     07 RVNU-TRAILER-CODE         PIC X(1).                       08830067
088400           88 RNVU-TRAILER                VALUE 'R'.              08840067
088500     07 RVNU-CENTER.                                              08850067
088600         09 FILLER                PIC X(1).                       08860067
088700         09 RVNU-CODE             PIC X(3).                       08870067
088800     07 RVNU-DATE                 PIC 9(8).                       08880067
088900     07 RVNU-ANSI1                PIC X(5).                       08890067
089000     07 RVNU-ANSI2                PIC X(5).                       08900067
089100     07 RVNU-ANSI3                PIC X(5).                       08910067
089200     07 RVNU-ANSI4                PIC X(5).                       08920067
089300     07 RVNU-HIPPS-CODE           PIC X(5).                       08930067
089400     07 RVNU-HCPCS                PIC X(5).                       08940067
089500     07 RVNU-HCPCS-M1             PIC X(2).                       08950067
089600     07 RVNU-HCPCS-M2             PIC X(2).                       08960067
089700     07 RVNU-HCPCS-M3             PIC X(2).                       08970067
089800     07 RVNU-HCPCS-M4             PIC X(2).                       08980067
089900     07 RVNU-HCPCS-M5             PIC X(2).                       08990067
090000     07 RVNU-PMT-METHOD-IND       PIC X(2).                       09000067
090100     07 RVNU-DISCOUNT-FLAG        PIC X(1).                       09010067
090200     07 RVNU-PACKAGE-FLAG         PIC X(1).                       09020067
090300     07 RVNU-PRICING-IND          PIC X(2).                       09030067
090400     07 RVNU-OTAF-IND-CD          PIC X(1).                       09040067
090500**** 07 RVNU-OTAF-1               PIC X(1).                       09050067
090600**** 07 RVNU-OTAF-2               PIC X(1).  DELETED              09060067
090700     07 RVNU-IDE-NDC-UPC-NUM.                                     09070067
090800        09 RVNU-IDE-NUM              PIC X(07).                   09080067
090900        09 RVNU-IDE-FILLER-1         PIC X(17).                   09090067
091000     07 RVNU-NDC-QTY-QLFR-CD         PIC XX.                      09100067
091100     07 RVNU-NDC-QTY                 PIC S9(7)V999 COMP-3.        09110067
091200     07 RVNU-UNITS                PIC S9(7)    COMP-3.            09120067
091300     07 RVNU-RATE                 PIC S9(9)V99 COMP-3.            09130067
091400     07 RVNU-BLOOD-DEDUCT         PIC S9(9)V99 COMP-3.            09140067
091500     07 RVNU-CASH-DEDUCT          PIC S9(9)V99 COMP-3.            09150067
091600     07 RVNU-WAGE-ADJ-COINS       PIC S9(9)V99 COMP-3.            09160067
091700     07 RVNU-REDUCE-COINS         PIC S9(9)V99 COMP-3.            09170067
091800     07 RVNU-MSP1-PAID-AMT        PIC S9(9)V99 COMP-3.            09180067
091900     07 RVNU-MSP2-PAID-AMT        PIC S9(9)V99 COMP-3.            09190067
092000**** 07 RVNU-PROFESS-COMP         PIC S9(9)V99 COMP-3.            09200067
092100     07 RVNU-PROVIDER-PMT         PIC S9(9)V99 COMP-3.            09210067
092200     07 RVNU-PATIENT-AMT          PIC S9(9)V99 COMP-3.            09220067
092300     07 RVNU-PATIENT-RESPON       PIC S9(9)V99 COMP-3.            09230067
092400     07 RVNU-PAYMENT-AMOUNT       PIC S9(9)V99 COMP-3.            09240067
092500     07 RVNU-TOTAL                PIC S9(9)V99 COMP-3.            09250067
092600     07 RVNU-NONCOV               PIC S9(9)V99 COMP-3.            09260067
092700**** 07 RVNU-OVERRIDE             PIC X(01). NAME CHANGE.         09270067
092800****    RVNU-OVERRIDE = RVNU-DDCTBL-COINSRNC-CD                   09280067
092900     07 RVNU-DDCTBL-COINSRNC-CD       PIC X(01).                  09290067
093000     07 RVNU-CB-OV                    PIC X(01).                  09300067
093100     07 RVNU-STATUS-IND               PIC XX.                     09310067
093200     07 RVNU-SUSP-DUP-REV-IND         PIC X.                      09320067
093300     07 RVNU-APC-BUFR-CD              PIC XX.                     09330067
093400     07 RVNU-RNDRNG-PHY-NPI-NUM       PIC X(10).                  09340067
093500     07 RVNU-RNDRNG-SRNM-NAME         PIC X(6).                   09350067
093600     07 RVNU-PWK-CD                   PIC X(2).                   09360067
093700     07 RVNU-PHYSN-SPCLTY-CD          PIC X(2).                   09370067
093800     07 RVNU-THRPY-CAP-IND OCCURS 5 TIMES                         09380067
093900                                      PIC X.                      09390067
094000     07 RVNU-FPS-MODEL-NUM            PIC X(2).                   09400067
094100     07 RVNU-FPS-RSN-CD               PIC X(3).                   09410067
094200     07 RVNU-FPS-RMRK-CD              PIC X(5).                   09420067
094300     07 RVNU-FPS-MSN-1-CD             PIC X(5).                   09430067
094400     07 RVNU-FPS-MSN-2-CD             PIC X(5).                   09440067
094500     07 RVNU-PTNT-ADD-ON-PMT          PIC S9(9)V99 COMP-3.        09450067
094600     07 RVNU-PRIOR-AUTH-IND           PIC X(4).                   09460067
094700     07 RVNU-UNIQ-TRKNG-NUM           PIC X(14).                  09470067
094800     07 RVNU-RP-IND                   PIC X.                      09480067
094900     07 RVNU-TRNSTNL-DRUG-AMT         PIC S9(7)V9(4) COMP-3.      09490067
095000     07 RVNU-FILLER-2                 PIC X(345).                 09500067
095100*    07 RVNU-FILLER-2                 PIC X(351).                 09510067
095200*  FIN-LIM IN OUTPT ONLY                                          09520067
095300     07 RVNU-FIN-LIM                  PIC S9(5)V99 COMP-3.        09530067
095400*                                                                 09540000
095500**  RVNU 606 X 45 = 27270                                         09550000
095600 01 INIT-TRL-TRLR      PIC X(27270).                              09560000
095700*                                                                 09570000
095800 01  WS-SRT-TRL-WORK.                                             09580000
095900     05 WS-SRT-TRL    OCCURS 450 TIMES.                           09590000
096000        07 WS-SRT-TRL-DATE        PIC 9(8) VALUE ZERO.            09600000
096100        07 WS-SRT-TRL-TOTAL       PIC S9(9)V99 COMP-3 VALUE ZERO. 09610000
096200 01  EDIT-SRT-FORMAT       PIC X(6300).                           09620000
096300                                                                  09630000
096400 01  QA0L-LEADER.                                                 09640000
096500*COPY MQARVI0L.                                                   09650000
096600     03  QA0L-RECORD-IDEN.                                        09660000
096700         05  QA0L-HOST-CODE    PIC X(01).                         09670000
096800         05  QA0L-BATCH-NO     PIC X(04).                         09680000
096900         05  QA0L-CONT-CODE    PIC X(08).                         09690000
097000         05  QA0L-CLAIM-RIC    PIC X(01).                         09700000
097100         05  QA0L-RECORD-STAMP.                                   09710000
097200             07  QA0L-CWFMQA-DATE        PIC 9(08).               09720000
097300             07  QA0L-SEQUENCE-NUMBER    PIC S9(9) COMP-3.        09730000
097400             07  QA0L-TOT-SEG-COUNT      PIC 99.                  09740000
097500             07  QA0L-SEG-NUMBER         PIC 99.                  09750000
097600         05  QA0L-DATE-RCVD    PIC 9(8).                          09760000
097700     03  QA0L-RECODE-IDEN.                                        09770000
097800         05  QA0L-DISP-CODE    PIC X(02).                         09780000
097900         05  QA0L-TRAN-ID      PIC X(04).                         09790000
098000         05  FILLER            PIC X(01).                         09800000
098100     03  QA0L-INDICATORS.                                         09810000
098200         05  QA0L-SAMPLE       PIC X(01).                         09820000
098300         05  QA0L-SEGMENT      PIC X(01).                         09830000
098400         05  QA0L-FORMAT       PIC X(01).                         09840000
098500***************************************************************** 09850000
098600*  MQARQA0L R03: CWF CONVERSION                        04/02/93 * 09860000
098700*  TIER I BATCH IDENTIFICATION                         27 BYTES * 09870000
098800*  VERSIONH H                                 32 BYTES 05/27/98   09880000
098900***************************************************************** 09890000
099000                                                                  09900000
099100 01  QA1L-LEADER.                                                 09910000
099200*COPY MQARVI1L.                                                   09920000
099300*  03  OSDM-LEADER.                                               09930000
099400   03  QA1L-OSDM-LEADER.                                          09940000
099500       05  QA1L-HOST-CODE              PIC X(01).                 09950000
099600       05  QA1L-BATCH-NO               PIC X(04).                 09960000
099700       05  QA1L-CONT-CODE              PIC X(08).                 09970000
099800       05  QA1L-CLAIM-RIC              PIC 9(01).                 09980000
099900       05  QA1L-RECORD-STAMP.                                     09990000
100000           07  QA1L-CWFMQA-DATE        PIC 9(08).                 10000000
100100           07  QA1L-SEQUENCE-NUMBER    PIC S9(9) COMP-3.          10010000
100200           07  QA1L-TOT-SEG-COUNT      PIC 99.                    10020000
100300           07  QA1L-SEG-NUMBER         PIC 99.                    10030000
100400       05  QA1L-DATE-RCVD              PIC 9(08).                 10040000
100500       05  QA1L-ERROR.                                            10050000
100600           07  QA1L-DISP-CODE          PIC X(02).                 10060000
100700           07  QA1L-ERROR-CODE         PIC X(04).                 10070000
100800           07  QA1L-ERROR-ADDL         PIC X(01).                 10080000
100900       05  QA1L-SAMPLE-FLAG            PIC X(01).                 10090000
101000       05  QA1L-CONTROL-CODE           PIC X(01).                 10100000
101100       05  QA1L-ERROR-FLAG             PIC X(01).                 10110000
101200***************************************************************** 10120000
101300*  MQARQA1L R03: UB92 CONVERSION                       09/21/92 * 10130000
101400*  TIER-2 (MQA)  BATCH IDENTIFICATION                  24 BYTES * 10140000
101500*  MQARVH1L      VERSION H DATE CONVERSION    TEST     04/03/97 * 10150000
101600*  TIER-2 (MQA)  BATCH IDENTIFICATION VERSION-H        32 BYTES * 10160000
101700*  MQARVI1L      VERSION I DATE CONVERSION    TEST     04/03/97 * 10170000
101800*  TIER-2 (MQA)  BATCH IDENTIFICATION VERSION-I        49 BYTES * 10180000
101900***************************************************************** 10190000
102000*                                                                 10200000
102100 01  MQARERRM-COPYBOOK.                                           10210000
102200     05  ERRM-ERROR-IDEN                 VALUE SPACES.            10220000
102300         10  ERRM-JOBNAME      PIC X(07).                         10230000
102400         10  FILLER            PIC X(01).                         10240000
102500         10  ERRM-PROCNAME     PIC X(08).                         10250000
102600         10  FILLER            PIC X(01).                         10260000
102700         10  ERRM-PROCSTEP     PIC X(05).                         10270000
102800         10  FILLER            PIC X(01).                         10280000
102900         10  ERRM-SEGMENT      PIC X(02).                         10290000
103000     05  ERRM-PROGRAM          PIC X(08) VALUE 'PROGNAME'.        10300000
103100     05  ERRM-FILLER1 REDEFINES ERRM-PROGRAM.                     10310000
103200         10  ERRM-FILLER       PIC X(07).                         10320000
103300         10  ERRM-PASS-TYPE    PIC X.                             10330000
103400     05  ERRM-FILE-DATE        PIC 9(08) VALUE ZEROES.            10340000
103500     05  ERRM-ERROR-DESC                 VALUE SPACES.            10350000
103600         10  ERRM-ERROR        PIC X(02).                         10360000
103700         10  ERRM-DDNAME       PIC X(08).                         10370000
103800         10  ERRM-STATUS       PIC X(02).                         10380000
103900         10  ERRM-COMMENT      PIC X(60).                         10390000
104000         10  ERRM-VSAM         PIC X(06).                         10400000
104100******************************************************************10410000
104200*  MQARERRM R03: COBOL3 CONVERSION                      07/01/98 *10420000
104300*  ERRM ERROR IDENTIFIERS                               99 BYTES *10430000
104400******************************************************************10440000
104500 01 WS-HLD-WORK.                                                  10450000
104600    05 WS-HLD-RVNU.                                               10460000
104700       07 WS-HLD-RVNU-DATE          PIC 9(8).                     10470000
104800       07 WS-HLD-RVNU-TOTAL         PIC S9(9)V99 COMP-3.          10480000
104900 01 DAY-AREA.                                                     10490000
105000         05  Y0X5-AGE            PIC 9(8)     VALUE ZERO.         10500000
105100         05  SYSTEM-DAY          PIC X(08)    VALUE ZERO.         10510000
105200         05  CURRENT-DAY         PIC 9(08)    VALUE ZERO.         10520000
105300                                                                  10530000
105400                                                                  10540000
105500 TITLE 'MQAPHHAB: HCPC-WORK'.                                     10550000
105600 01  HCPC-PASS-REQUEST.                                           10560000
105700*COPY MQARHCPC.                                                   10570000
105800     03  HCPC-PASS-CODE    PIC X(05)  VALUE SPACES.               10580000
105900     03  HCPC-PASS-DATE    PIC 9(8)   VALUE ZERO.                 10590000
106000     03  HCPC-PASS-RETURN  PIC X(01)  VALUE SPACE.                10600000
106100         88  HCPC-ACTIVE              VALUE 'A'.                  10610000
106200         88  HCPC-INACTIVE            VALUE 'I'.                  10620000
106300         88  HCPC-INVALID             VALUE 'X'.                  10630000
106400 01  HCPC-RECORD.                                                 10640000
106500     03  HCPC-KEY                             PIC X(05).          10650000
106600*******  DATES OF PIC 9(08) ARE CCYYMMDD.                         10660000
106700     03  HCPC-LAST-MAINT-DT                   PIC 9(08).          10670000
106800     03  HCPC-LAST-MAINT-ID                   PIC X(08).          10680000
106900*******  HCPC-TAPE-MAINT-DT IS CCYYMM.                            10690000
107000     03  HCPC-TAPE-MAINT-DT                   PIC 9(06).          10700000
107100     03  HCPC-TAPE-MAINT-CD                   PIC X(01).          10710000
107200     03  HCPC-XREF.                                               10720000
107300         05  HCPC-NEW-HCPC-CD                 PIC X(05).          10730000
107400         05  HCPC-NEW-HCPC-EFF-DT             PIC 9(08).          10740000
107500     03  HCPC-PROCEDURE-DESC                  PIC X(80).          10750000
107600     03  HCPC-GROUP.                                              10760000
107700         05  HCPC-MNEMONIC                    PIC X(05).          10770000
107800         05  HCPC-INDV-REVIEW-IND             PIC X(01).          10780000
107900             88  MEDICAID-SUSPEND                 VALUE 'R' 'U'.  10790000
108000             88  MEDICARE-SUSPEND                 VALUE 'S' 'U'.  10800000
108100     03  HCPC-TRLR-COUNT                      PIC S9(4) COMP.     10810000
108200     03  HCPC-LAST-MAINT-CR                   PIC S9(5) COMP-3.   10820000
108300     03  HCPC-BETOS                           PIC X(03).          10830000
108400     03  HCPC-TRAILER OCCURS 0 TO 4 DEPENDING ON HCPC-TRLR-COUNT. 10840000
108500      04 HCPC-DATE-RANGE.                                         10850000
108600         05  HCPC-EFFECTIVE                   PIC 9(08).          10860000
108700         05  HCPC-TERMINATE                   PIC 9(08).          10870000
108800      04 HCPC-INFO-PARAM.                                         10880000
108900         05  HCPC-COVERAGE                    PIC X(01).          10890000
109000         05  HCPC-LAB-CLASSES.                                    10900000
109100             07  HCPC-LAB-CLASS   OCCURS 8 PIC 9(03)    COMP-3.   10910000
109200         05  HCPC-RELATIVE-VALUE              PIC 9(05)    COMP-3.10920000
109300         05  HCPC-SURG-ASSISTANT              PIC X(01).          10930000
109400         05  HCPC-FOLLOWUP                    PIC 9(03).          10940000
109500         05  HCPC-MODIFIER-EDIT               PIC X(01).          10950000
109600         05  HCPC-MODIFIER-CODES.                                 10960000
109700             07  HCPC-MODIFIER-CODE OCCURS 6 PIC X(02).           10970000
109800         05  HCPC-SERVICE-PLACE-EDIT          PIC X(01).          10980000
109900         05  HCPC-SERVICE-PLACE-CODES.                            10990000
110000             07  HCPC-SERVICE-PLACE-CODE                          11000000
110100                                      OCCURS 6 PIC X(02).         11010000
110200         05  HCPC-SERVICE-TYPE-EDIT           PIC X(01).          11020000
110300         05  HCPC-SERVICE-TYPE-CODES.                             11030000
110400             07  HCPC-SERVICE-TYPE-CODE OCCURS 6 PIC X(01).       11040000
110500         05  HCPC-SPECIALTY-EDIT              PIC X(01).          11050000
110600         05  HCPC-SPECIALTY-CODES.                                11060000
110700             07  HCPC-SPECIALTY-CODE     OCCURS 6 PIC X(02).      11070000
110800         05  HCPC-CATEGORY-CODES.                                 11080000
110900             07  HCPC-CATEGORY-CODE OCCURS 7 PIC 9(03) COMP-3.    11090000
111000         05  HCPC-FILLER-2                    PIC X(05).          11100000
111100         05  HCPC-UPIN-REQD-DME               PIC X(01).          11110000
111200***************************************************************** 11120000
111300*  MQARHCPC  R03: HCPC-LAB-CLASS 8 OCCUR 134-549       04/02/99 * 11130000
111400*  MQARHCPC  R02: HCPC-LAB-CLASS 8 OCCUR 123-507       12/29/94 * 11140000
111500*  HCPCS          NEW COPY BOOK                        08/04/92 * 11150000
111600*  HCPCS          HOST HCPCS MSTR REC    123-475       12/29/94 * 11160000
111700*  VERSION H CHANGES                                   07/22/97 * 11170000
111800***************************************************************** 11180000
111900 01  HCPC-CATEGORY.                                               11190000
112000*COPY MQARCTGY.                                                   11200000
112100     03  CTGY1   PIC X.  88 HCPCS-CAPPED             VALUE 'Y'.   11210000
112200     03  CTGY2   PIC X.  88 HCPCS-FREQ-MAINT         VALUE 'Y'.   11220000
112300     03  CTGY3   PIC X.  88 HCPCS-PROST-ORTH         VALUE 'Y'.   11230000
112400     03  CTGY4   PIC X.  88 HCPCS-INEXP-ROUTINE      VALUE 'Y'.   11240000
112500     03  CTGY5   PIC X.  88 HCPCS-ELEC-WHEELCHAIR    VALUE 'Y'.   11250000
112600     03  CTGY6   PIC X.  88 HCPCS-OXYGEN             VALUE 'Y'.   11260000
112700     03  CTGY7   PIC X.  88 HCPCS-OXYGEN-SUPPLIES    VALUE 'Y'.   11270000
112800     03  CTGY8   PIC X.  88 HCPCS-ESRD-SUPPLIES      VALUE 'Y'.   11280000
112900     03  CTGY9   PIC X.  88 HCPCS-PEN-NUTRIENTS      VALUE 'Y'.   11290000
113000     03  CTGY10  PIC X.  88 HCPCS-PEN-PUMPS          VALUE 'Y'.   11300000
113100     03  CTGY11  PIC X.  88 HCPCS-IMMUNO-DRUGS       VALUE 'Y'.   11310000
113200     03  CTGY12  PIC X.  88 HCPCS-CLINICAL-LAB       VALUE 'Y'.   11320000
113300     03  CTGY13  PIC X.  88 HCPCS-GLOBAL-SURGERY     VALUE 'Y'.   11330000
113400     03  CTGY14  PIC X.  88 HCPCS-EPO                VALUE 'Y'.   11340000
113500     03  CTGY15  PIC X.  88 HCPCS-PEN-SUPPLIES       VALUE 'Y'.   11350000
113600     03  CTGY16  PIC X.  88 HCPCS-MISC-DMEPOS        VALUE 'Y'.   11360000
113700     03  CTGY17  PIC X.  88 HCPCS-CUSTOM-DMEPOS      VALUE 'Y'.   11370000
113800     03  CTGY18  PIC X.  88 HCPCS-REPAIR-DMEPOS      VALUE 'Y'.   11380000
113900     03  CTGY19  PIC X.  88 HCPCS-GLBL-SURGY-NS90    VALUE 'Y'.   11390000
114000     03  CTGY20  PIC X.  88 HCPCS-PAR-NUTRIENTS      VALUE 'Y'.   11400000
114100     03  CTGY21  PIC X.  88 HCPCS-SURG-DRESS-PRIM    VALUE 'Y'.   11410000
114200     03  FILLER  PIC X(29).                                       11420000
114300     03  CTGY51  PIC X.  88 HCPCS-MALE-ONLY          VALUE 'Y'.   11430000
114400     03  CTGY52  PIC X.  88 HCPCS-FEMALE-ONLY        VALUE 'Y'.   11440000
114500     03  CTGY53  PIC X.  88 HCPCS-ONCE-IN-A-LIFE     VALUE 'Y'.   11450000
114600     03  CTGY54  PIC X.  88 HCPCS-RX-REQUIRED        VALUE 'Y'.   11460000
114700     03  CTGY55  PIC X.  88 HCPCS-UNITS-REQUIRED     VALUE 'Y'.   11470000
114800     03  CTGY56  PIC X.  88 HCPCS-NOT-CLASSIFIED     VALUE 'Y'.   11480000
114900     03  CTGY57  PIC X.  88 HCPCS-LAB-OWNERSHIP      VALUE 'Y'.   11490000
115000     03  CTGY58  PIC X.  88 HCPCS-CLIA-WAIVER        VALUE 'Y'.   11500000
115100     03  CTGY59  PIC X.  88 HCPCS-CMN-REQUIRED       VALUE 'Y'.   11510000
115200     03  CTGY60  PIC X.  88 HCPCS-DMEPOS-DMERC-SUB   VALUE 'Y'.   11520000
115300     03  CTGY61  PIC X.  88 HCPCS-ESRD-WO-PAYLIM-ED  VALUE 'Y'.   11530000
115400     03  CTGY62  PIC X.  88 HCPCS-ORD-PHYS-UPIN-RQD  VALUE 'Y'.   11540000
115500     03  CTGY63  PIC X.  88 HCPCS-CLIA-WAIVED-MICR   VALUE 'Y'.   11550000
115600     03  CTGY64  PIC X.  88 HCPCS-CLIA-TC-MOD-BYP    VALUE 'Y'.   11560000
115700     03  CTGY65  PIC X.  88 HCPCS-CLIA-PC-MOD-BYP    VALUE 'Y'.   11570000
115800     03  CTGY66  PIC X.  88 HCPCS-CMN-NOT-ACCPTD     VALUE 'Y'.   11580000
115900     03  CTGY67  PIC X.  88 HCPCS-PTB-COV-LOC-CARR   VALUE 'Y'.   11590000
116000     03  CTGY68  PIC X.  88 HCPCS-SURG-DRESSING      VALUE 'Y'.   11600000
116100     03  CTGY69  PIC X.  88 HCPCS-CLIA-MOD-QW        VALUE 'Y'.   11610000
116200     03  CTGY70  PIC X.  88 HCPCS-A-B-CROSSOVER      VALUE 'Y'.   11620000
116300     03  CTGY71  PIC X.  88 HCPCS-REAS-CHG-TABLE     VALUE 'Y'.   11630000
116400     03  CTGY72  PIC X.  88 HCPCS-CLIN-LAB-PROC-CDS  VALUE 'Y'.   11640000
116500     03  CTGY73  PIC X.  88 HCPCS-NON-ROUTINE-SUPPL  VALUE 'Y'.   11650000
116600     03  CTGY74  PIC X.  88 HCPCS-COORD-CARE         VALUE 'Y'.   11660000
116700     03  CTGY75  PIC X.  88 HCPCS-SNF-CONS-BILL      VALUE 'Y'.   11670000
116800     03  CTGY76  PIC X.  88 HCPCS-NURS-FACIL-RES     VALUE 'Y'.   11680000
116900*    03  FILLER  PIC X(22).                                       11690000
117000     03  FILLER  PIC X(21).                                       11700000
117100     03  CTGY98  PIC X.  88 HCPCS-UPIN-REQD-DME      VALUE 'Y'.   11710000
117200***************************************************************** 11720000
117300*  MQARCTGY CATEGORY NUMBER EDIT SWITCH ARRAY          04/01/00 * 11730000
117400*     UPDATE WHEN MQAXHCPC CAT-DESCRIPTIONS CHANGES    04/01/00 * 11740000
117500*  MQARCTGY R00: VERSION I                             04/01/00 * 11750000
117600*  MQARCTGY    : R2016400 CTGY 76 NURS-FACIL-RES       10/03/16 * 11760000
117700***************************************************************** 11770000
117800                                                                  11780000
117900 TITLE 'MQAPHHAB: RANK-CONTROL'.                                  11790000
118000 01  RANK-CONTROL.                                                11800000
118100*COPY MQARRANK.  TRUNCATE FOR DEMO: NO MQAMERRM SUBPROG CALLS     11810099
118200     05  ERROR-INDICIES.                                          11820000
118300         07  ERR              PIC S9(4)      VALUE ZERO  COMP.    11830000
118400         07  ERR-LINES        PIC S9(4)      VALUE ZERO  COMP.    11840000
118500         07  ERR-MAX          PIC S9(4)      VALUE +299  COMP.    11850000
118600     05  ERROR-CODES                         VALUE SPACES.        11860000
118700         07  ERROR-IDEN                      OCCURS 299.          11870000
118800           08  ERROR-C-I.                                         11880000
118900             09  ERROR-CODE   PIC X(04).                          11890000
119000             09  ERROR-ITEM   PIC X(01).                          11900000
119100           08  ERROR-R-A.                                         11910000
119200             09  ERROR-RANK   PIC X(03).                          11920000
119300             09  ERROR-ADDR   PIC X(03).                          11930000
119400             09  ERROR-ADDRN REDEFINES ERROR-ADDR PIC 9(03).      11940000
119500**I   RANK, ADDR FOR RVNU TRLR REPORT; BLD LINES IN CONS          11950000
119600**    DEMO: DISPLAY ERROR, RANK, ADDR (RVNU LINE #) BEFORE AND    11960099
119700**         AFTER SORT (BY SEVERITY), THEN LOAD CLAIM ERROR-ARRAY  11970099
119800*    05  ERROR-ERRM           PIC X(38)      VALUE SPACES.        11980084
119900*    05  ERROR-STATUS         PIC X(01)      VALUE SPACE.         11990084
120000*        88  ERROR-FOUND                     VALUE 'Y'.           12000084
120100*        88  ERROR-NEW                       VALUE 'N'.           12010084
120200*        88  ERROR-BYPASS                    VALUE 'B'.           12020084
120300*NOTE:   THE FOLLOWING DATA IS USED BY MODULE 'MQAMRANK'.         12030000
120400*    05  ERRCO-CONTROL.                                           12040084
120500*        07  ERRCO            PIC S9(4)      VALUE ZERO  COMP.    12050084
120600*        07  ERRCO-INDICIES                  OCCURS  99.          12060084
120700*            09  ERRCO-INDEX  PIC S9(4)      VALUE ZERO  COMP.    12070084
120800*        07  ERRCO-FUNCTION   PIC X(01)      VALUE 'P'.           12080084
120900*            88  ERRCO-FIND                  VALUE 'F'.           12090084
121000*            88  ERRCO-PROD                  VALUE 'P'.           12100084
121100*            88  ERRCO-TEST                  VALUE 'T'.           12110084
121200*        07  ERRCO-NEW        PIC S9(4)      VALUE ZERO  COMP.    12120084
121300*        07  ERRCO-MAX        PIC S9(4)      VALUE +800  COMP.    12130084
121400*    05  ERRCO-ENTRY                         OCCURS 800.          12140084
121500*        07  ERRCO-TEXT.                                          12150084
121600*            09  ERRCO-CODE   PIC X(04)      VALUE SPACES.        12160084
121700*            09  ERRCO-TYPE   PIC X(01)      VALUE SPACES.        12170084
121800*            09  ERRCO-RANK   PIC X(03)      VALUE ZEROES.        12180084
121900*                88  ERRCO-IGNORE            VALUE '999'.         12190084
122000*            09  FILLER       PIC X(01)      VALUE SPACES.        12200084
122100*            09  ERRCO-DESC   PIC X(36)      VALUE SPACES.        12210084
122200*            09  ERRCO-SUBR   PIC X(04)      VALUE SPACES.        12220084
122300*        07  ERRCO-NEXT       PIC S9(4)      VALUE ZERO  COMP.    12230084
122400*        07  ERRCO-COUNTS                    OCCURS 2.            12240084
122500*         08 ERRCO-COUNT-RIC                 OCCURS 7.            12250084
122600*            09  ERRCO-COUNT  PIC S9(8)      VALUE ZERO  COMP-3.  12260084
122700*            09  ERRCO-TOTAL  PIC S9(8)      VALUE ZERO  COMP-3.  12270084
122800******************************************************************12280000
122900 01  EDIT-RANK-CONTROL-FORMAT           PIC X(3295).              12290085
123000******************************************************************12300000
123100 01  SWAP-CONTROL.                                                12310099
123200     03  SWAP-INDICIES.                                           12320099
123300         05  SW1             PIC S9(4)   VALUE ZERO  COMP.        12330099
123400         05  SW2             PIC S9(4)   VALUE ZERO  COMP.        12340099
123500         05  SWLN            PIC S9(4)   VALUE ZERO  COMP.        12350099
123600     03  SWAP-CODES                     VALUE SPACES.             12360099
123700         05  SWAP-CODE       PIC X(11).                           12370099
123800         05  FILLER          PIC X(3289).                         12380099
123900******************************************************************12390099
124000 TITLE 'MQAPHHAB: QAR5-HOME-HEALTH'.                              12400000
124100*                                                                 12410000
124200*  NB: MQR & MQA INTERNAL-FORMAT CLAIMS CARRY 49-BYTE LEADER;     12420000
124300*     13-ELEMENT ERROR ARRAY; AND ONLN- BEFORE/AFTER MBD          12430000
124400*     TRAILERS FOR MQA UTIL EDITS.  ON REFORMAT FOR NCH, IDR,     12440000
124500*     CCW, ET AL THESE ARE REMOVED.                               12450000
124600*     IF ERRORS WERE SEEN, 13 HIGHEST RANKED WERE CAPTURED        12460000
124700*     AND MOVED TO NCH-ERROR-TRAILER QAR5-NCH-EDIT-GRP.           12470000
124800*     THEN THE RECORD LENGTH IS RECALCULATED AND THE CLAIM        12480000
124900*     REBUILT USING BLOCK MOVES.                                  12490000
125000************************************************************      12500000
125100 01  HOME-HEALTH-RECORD.                                          12510000
125200*COPY MQAHRIC5. THIS IS A QA1L HEADER + MQACRIC5 COPYBOOK         12520094
125300* AS OF SEPT 2019                                                 12530099
125310*                                                                 12531099
125400*  03  OSDM-LEADER.                                               12540000
125500   03  QA5L-OSDM-LEADER.                                          12550000
125600       05  QA5L-HOST-CODE              PIC X(01).                 12560000
125700       05  QA5L-BATCH-NO               PIC X(04).                 12570000
125800       05  QA5L-CONT-CODE              PIC X(08).                 12580000
125900       05  QA5L-CLAIM-RIC              PIC 9(01).                 12590000
126000       05  QA5L-RECORD-STAMP.                                     12600000
126100           07  QA5L-CWFMQA-DATE        PIC 9(08).                 12610000
126200           07  QA5L-SEQUENCE-NUMBER    PIC S9(9) COMP-3.          12620000
126300           07  QA5L-TOT-SEG-COUNT      PIC 99.                    12630000
126400           07  QA5L-SEG-NUMBER         PIC 99.                    12640000
126500       05  QA5L-DATE-RCVD              PIC 9(08).                 12650000
126600       05  QA5L-ERROR.                                            12660000
126700           07  QA5L-DISP-CODE          PIC X(02).                 12670000
126800           07  QA5L-ERROR-CODE         PIC X(04).                 12680000
126900           07  QA5L-ERROR-ADDL         PIC X(01).                 12690000
127000       05  QA5L-SAMPLE-FLAG            PIC X(01).                 12700000
127100       05  QA5L-CONTROL-CODE           PIC X(01).                 12710000
127200       05  QA5L-ERROR-FLAG             PIC X(01).                 12720000
127300****************************************************************  12730000
127400*****       HOME HEALTH   CR14                 *****************  12740000
127500*****       LRECL = 31,463  FOR  MQR AND MQA   *****************  12750000
127600*****       BASE CLAIM            =   1,254    *****************  12760000
127700*****       ERROR CODE AREA       =      52    *****************  12770000
127800*****       INPAT/SNF SPECIFIC    =     568    *****************  12780000
127900*****       ONLINE TRAILER AREA   =     820    *****************  12790000
128000*****   CLAIM FIXED         TOT   =   2,694    *****************  12800000
128100*****   NCH-PTCH TRLR OUT                      *****************  12810000
128200*****       ALL OTHER TRAILERS    =  28,769    *****************  12820000
128300*****      (RVNU TRLR + 380 FILL  =     606)   *****************  12830000
128400****************************************************************  12840000
128500   03 QAR5-COMMON.                                                12850000
128600     05 QAR5-RECL                 PIC S9(5)    COMP-3.            12860000
128700     05 QAR5-NCH-NEAR-REC-VRSN-CD PIC X.                          12870000
128800     05 QAR5-NCH-NEAR-LINE-RIC-CD PIC X.                          12880000
128900     05 QAR5-CLAIM-RIC            PIC X(01).                      12890000
129000         88 QAR5-INPATIENT-88         VALUE '1'.                  12900000
129100         88 QAR5-SKILLED-NURSING-88   VALUE '2'.                  12910000
129200         88 QAR5-HOSPICE-88           VALUE '3'.                  12920000
129300         88 QAR5-OUTPATIENT-88        VALUE '4'.                  12930000
129400         88 QAR5-HOME-HEALTH-88       VALUE '5'.                  12940000
129500         88 QAR5-PHY-SUPPLIER-88      VALUE '6'.                  12950000
129600         88 QAR5-DURABLE-EQUIP-88     VALUE '7'.                  12960000
129700     05 QAR5-CLM-TYPE-CD          PIC X(02).                      12970000
129800     05 QAR5-CLAIM-LINK-GROUP.                                    12980000
129900         10 QAR5-CLAIM.                                           12990000
130000             15 QAR5-CAN              PIC X(9).                   13000000
130100             15 QAR5-CAN-NCH-EQUATEABLE PIC X(2).                 13010000
130200             15 QAR5-BIC              PIC X(2).                   13020000
130300         10 QAR5-NCH-STATE-SEGMENT    PIC X(01).                  13030000
130400         10 QAR5-STATE-CODE           PIC X(02).                  13040000
130500         10 QAR5-STAY-FROM            PIC 9(8).                   13050000
130600         10 QAR5-STAY-THRU            PIC 9(8).                   13060000
130700         10 QAR5-NCH-WEEKLY-PROC-DT   PIC 9(8).                   13070000
130800         10 QAR5-ACCRETE-DATE         PIC 9(8).                   13080000
130900         10 QAR5-ACCRETE-CTR          PIC S9(3) COMP-3.           13090000
131000         10 QAR5-ICN                  PIC X(23).                  13100000
131100         10 QAR5-ICN-ORIG             PIC X(23).                  13110000
131200         10 QAR5-QUERY-CODE           PIC X.                      13120000
131300         10 QAR5-PROVIDER             PIC X(06).                  13130000
131400         10 QAR5-MQA-DATE             PIC 9(8).                   13140000
131500         10 QAR5-SEQUENCE-NUMBER      PIC S9(9)     COMP-3.       13150000
131600         10 QAR5-TOT-SEG-COUNT        PIC 99.                     13160000
131700         10 QAR5-SEG-NUMBER           PIC 99.                     13170000
131800         10 QAR5-TOT-LINE-COUNT       PIC 999.                    13180000
131900         10 QAR5-SEG-LINE-COUNT       PIC 99.                     13190000
132000     05 QAR5-PANDE-RIC            PIC X(01).                      13200000
132100     05 QAR5-TRANS-CODE           PIC X(01).                      13210000
132200     05 QAR5-BILL-TYPE            PIC X(03).                      13220000
132300     05 FILLER-1                  PIC X(01).                      13230000
132400     05 QAR5-QUERY-IND            PIC X(01).                      13240000
132500     05 QAR5-DISP-CODE            PIC X(02).                      13250000
132600     05 QAR5-ERROR-DISP           PIC X(02).                      13260000
132700     05 QAR5-HA-HB-BIC-CODE       PIC X(01).                      13270000
132800     05 QAR5-COUNTY-CODE          PIC X(03).                      13280000
132900     05 QAR5-INTER-RECEIVED       PIC 9(8).                       13290000
133000     05 QAR5-DATE-FORWARDED       PIC 9(8).                       13300000
133100     05 QAR5-HCFA-RECEIVED        PIC 9(8).                       13310000
133200     05 QAR5-INTER-NO             PIC X(05).                      13320000
133300**** 05 QAR5-ONLINE-BATCH         PIC S9(15) COMP-3.              13330000
133400     05 QAR5-ONLN-BATCH-SEQ       PIC X(04).                      13340000
133500     05 QAR5-ONLN-BATCH-DATE      PIC S9(7) COMP-3.               13350000
133600     05 QAR5-BATCH-NO             PIC X(04).                      13360000
133700     05 QAR5-HIMA-ZIP             PIC X(09).                      13370000
133800     05 QAR5-HIMA-SEX             PIC X(01).                      13380000
133900     05 QAR5-HIMA-RACE            PIC X(01).                      13390000
134000     05 QAR5-HIMA-DOB             PIC 9(8).                       13400000
134100     05 QAR5-MEDICARE-STATUS      PIC X(02).                      13410000
134200     05 QAR5-PAT-NAME.                                            13420000
134300         07 QAR5-PAT-SURNAME      PIC X(06).                      13430000
134400         07 QAR5-PAT-FIRST        PIC X(01).                      13440000
134500         07 QAR5-PAT-MIDDLE       PIC X(01).                      13450000
134600     05 QAR5-HOST-SITE            PIC X(01).                      13460000
134700**** 05 QAR5-PRINCIPAL-DIAGNOSIS PIC X(05).                       13470000
134800     05 QAR5-PRNCPAL-DGNS-GRP.                                    13480000
134900         10  QAR5-PRNCPAL-DGNS-VRSN-CD       PIC X.               13490000
135000         10  QAR5-PRNCPAL-DGNS-CD            PIC X(7).            13500000
135100     05 FILLER-A1                 PIC X.                          13510000
135200***  05 QAR5-ALIEN-OVERRIDE       PIC X(01).                      13520000
135300     05 QAR5-NOPAY-CODE           PIC XX.                         13530000
135400***  05 QAR5-NOPAY-CODE           PIC X(01).                      13540000
135500     05 QAR5-RELIG-NONMED-CODE    PIC X(01).                      13550000
135600     05 QAR5-REIMB-AMT            PIC S9(9)V99 COMP-3.            13560000
135700     05 QAR5-PRIMARY-PAY-AMT      PIC S9(9)V99 COMP-3.            13570000
135800     05 QAR5-PRIMARY-PAY-CODE     PIC X(01).                      13580000
135900     05 QAR5-CO-CODE              PIC X(01).                      13590000
136000     05 QAR5-ACTION-CODE          PIC X(01).                      13600000
136100     05 QAR5-INTER-APPROVED       PIC 9(8).                       13610000
136200     05 QAR5-PROVIDER-STATE-CODE PIC X(02).                       13620000
136300     05 QAR5-NPI-TOTAL           PIC X(10).                       13630000
136400     05 QAR5-PHYSICIANS.                                          13640000
136500      06 QAR5-PHYSICIAN   OCCURS 03.                              13650000
136600         07 QAR5-PHY-UPIN         PIC X(06).                      13660000
136700         07 QAR5-PHY-NPI-TOTAL    PIC X(10).                      13670000
136800         07 QAR5-PHY-NAME.                                        13680000
136900             09 QAR5-PHY-SURNAME PIC X(06).                       13690000
137000             09 QAR5-PHY-FIRST    PIC X(01).                      13700000
137100             09 QAR5-PHY-MIDDLE   PIC X(01).                      13710000
137200     05 QAR5-MEDICAID-PROVIDER    PIC X(13).                      13720000
137300     05 QAR5-MEDICAID-INFORMATION PIC X(04).                      13730000
137400     05 QAR5-HMO-PAID-IND         PIC X(01).                      13740000
137500     05 QAR5-TREATMENT-AUTH       PIC X(18).                      13750000
137600     05 QAR5-PATIENT-CONTROL      PIC X(20).                      13760000
137700     05 QAR5-MEDICAL-RECORD       PIC X(17).                      13770000
137800     05 QAR5-PRO-CONTROL-NUMBER   PIC X(12).                      13780000
137900     05 QAR5-PRO-PROCESS-DATE     PIC 9(8).                       13790000
138000     05 QAR5-DISCH-DEST           PIC X(02).                      13800000
138100     05 QAR5-1ST-DGNS-E-CD-GRP.                                   13810000
138200         10  QAR5-1ST-DGNS-E-VRSN-CD         PIC X.               13820000
138300         10  QAR5-1ST-DGNS-E-CD              PIC X(7).            13830000
138400**** 05 QAR5-EXTERNAL-CAUSE       PIC X(05).                      13840000
138500**** 05 FILLER-1                  PIC X(01).                      13850000
138600     05 QAR5-PPS-IND              PIC X(01).                      13860000
138700     05 QAR5-TOTAL-CHARGES        PIC S9(9)V99  COMP-3.           13870000
138800     05 QAR5-PRICER-RET-CODE      PIC XX.                         13880000
138900     05 QAR5-BSI                  PIC X(4).                       13890000
139000     05 QAR5-RAC-ADJ-IND          PIC X.                          13900000
139100        88   QAR5-RAC-ADJ-IND-PRESENT  VALUE 'R'.                 13910000
139200        88   QAR5-RAC-ADJ-IND-VALID    VALUE 'R' SPACE.           13920000
139300     05 QAR5-CLM-WC-IND-CD        PIC X.                          13930000
139400        88   QAR5-CLM-WC-IND-CD-PRESENT  VALUE 'Y'.               13940000
139500        88   QAR5-CLM-WC-IND-CD-VALID    VALUE 'Y' SPACE.         13950000
139600     05 QAR5-SRVC-FAC-ZIP-CD      PIC X(9).                       13960000
139700     05 QAR5-CLM-PWK-CD           PIC X(2).                       13970000
139800*****05 FILLER-2                  PIC X(47).                      13980000
139900     05 QAR5-CARE-IMPRVMT-M1      PIC X(2).                       13990000
140000     05 QAR5-CARE-IMPRVMT-M2      PIC X(2).                       14000000
140100     05 QAR5-CARE-IMPRVMT-M3      PIC X(2).                       14010000
140200     05 QAR5-CARE-IMPRVMT-M4      PIC X(2).                       14020000
140300     05 QAR5-RNDRNG-ID-GRP.                                       14030000
140400      10 QAR5-RNDRNG-UPIN         PIC X(6).                       14040000
140500      10 QAR5-RNDRNG-NPI          PIC X(10).                      14050000
140600      10 QAR5-RNDRNG-SRNM         PIC X(6).                       14060000
140700      10 QAR5-RNDRNG-GVN-NAME     PIC X.                          14070000
140800      10 QAR5-RNDRNG-MDL-NAME     PIC X.                          14080000
140900      10 QAR5-RNDRNG-SPCLTY-CD    PIC X(2).                       14090000
141000     05 QAR5-PTNT-RLTNSHP         PIC X(2).                       14100000
141100     05 QAR5-FPS-MODEL-NUM        PIC X(2).                       14110000
141200     05 QAR5-FPS-RSN-CD           PIC X(3).                       14120000
141300     05 QAR5-FPS-RMRK-CD          PIC X(5).                       14130000
141400     05 QAR5-FPS-MSN-1-CD         PIC X(5).                       14140000
141500     05 QAR5-FPS-MSN-2-CD         PIC X(5).                       14150000
141600     05 QAR5-MASS-ADJSTMT-IND-CD  PIC X.                          14160000
141700     05 QAR5-NG-ACO-IND-1         PIC X.                          14170000
141800     05 QAR5-NG-ACO-IND-2         PIC X.                          14180000
141900     05 QAR5-NG-ACO-IND-3         PIC X.                          14190000
142000     05 QAR5-NG-ACO-IND-4         PIC X.                          14200000
142100     05 QAR5-NG-ACO-IND-5         PIC X.                          14210000
142200     05 QAR5-RSDL-PMT-IND         PIC X.                          14220000
142300     05 QAR5-ACO-ID-NUM           PIC X(10).                      14230000
142400     05 QAR5-MBI-ID               PIC X(11).                      14240000
142500     05 QAR5-BENE-ID-TYPE-CD      PIC X.                          14250000
142600     05 QAR5-PRVDR-VLDTN-CD       PIC X(2).                       14260000
142700     05 QAR5-RRB-EXCLSN-IND-SW    PIC X.                          14270000
142800     05 FILLER-2                  PIC X(668).                     14280000
142900***  05 FILLER-2                  PIC X(671).                     14290000
143000***  05 FILLER-2                  PIC X(693).                     14300000
143100***  05 FILLER-2                  PIC X(699).                     14310000
143200*****    ML-IND  SET IN MQA0001 - VALUE 'M'. *****************    14320000
143300*****       FOR WRITEOFF TO WEEKLY UH1044 ESRD FILE. *********    14330000
143400     05 QAR5-ML-IND                 PIC X.                        14340000
143500** END OF MQR, NCH COMMON FILLER                                  14350000
143600     05 QAR5-HCFA-EDIT-CD-CNT     PIC 9(02).                      14360000
143700     05 QAR5-HCFA-PATCH-CD-CNT    PIC 9(02).                      14370000
143800     05 QAR5-MCO-PRD-TRLR-CNT     PIC 9(01).                      14380000
143900     05 QAR5-CLM-DEMO-ID-TRLR-CNT PIC 9(01).                      14390000
144000     05 QAR5-POA-FILLER1          PIC 99.                         14400000
144100     05 QAR5-POA-FILLER2          PIC 99.                         14410000
144200     05 QAR5-CLM-DGNS-CD-J-CNT    PIC 99.                         14420000
144300     05 QAR5-CLM-DGNS-E-CD-CNT    PIC 99.                         14430000
144400     05 QAR5-PRCDR-FILLER         PIC 99.                         14440000
144500     05 QAR5-COND-COUNT           PIC 9(02).                      14450000
144600     05 QAR5-OCCR-COUNT           PIC 9(02).                      14460000
144700     05 QAR5-SPAN-COUNT           PIC 9(02).                      14470000
144800     05 QAR5-VALU-COUNT           PIC 9(02).                      14480000
144900     05 QAR5-RVNU-COUNT           PIC 9(02).                      14490000
145000     05 FILLER-4                  PIC 9(02).                      14500000
145100     05 FILLER-5                  PIC 9(02).                      14510000
145200                                                                  14520000
145300   03 QAR5-ERROR-CODES.                                           14530000
145400       05 QAR5-ERROR-CODE         PIC X(04)                       14540000
145500                         OCCURS 13 TIMES.                         14550000
145600                                                                  14560000
145700   03  QAR5-SPECIFIC.                                             14570000
145800********************* NEW ********************************        14580000
145900       05  QAR5-LUPA-IND             PIC X.                       14590000
146000       05  QAR5-HHA-REFERRAL-CODE    PIC X.                       14600000
146100********************* NEW ********************************        14610000
146200       05  QAR5-TOTAL-VISITS         PIC S999  COMP-3.            14620000
146300       05  QAR5-QUALIFIED-DATES.                                  14630000
146400           07 QAR5-STAY-FROM-Q      PIC 9(8).                     14640000
146500           07 QAR5-STAY-THRU-Q      PIC 9(8).                     14650000
146600       05  QAR5-DISCH-DATE           PIC 9(8).                    14660000
146700       05  QAR5-START-OF-CARE        PIC 9(8).                    14670000
146800       05  QAR5-ATNDG-PHYSN-SPCLTY-CD PIC X(2).                   14680000
146900       05  QAR5-OPRTG-PHYSN-SPCLTY-CD PIC X(2).                   14690000
147000       05  QAR5-OTHR-PHYSN-SPCLTY-CD  PIC X(2).                   14700000
147100***    05 FILLER                     PIC X(44).                   14710000
147200       05 QAR5-RFRG-ID-GRP.                                       14720000
147300         10 QAR5-RFRG-UPIN           PIC X(6).                    14730000
147400         10 QAR5-RFRG-NPI            PIC X(10).                   14740000
147500         10 QAR5-RFRG-SRNM           PIC X(6).                    14750000
147600         10 QAR5-RFRG-GVN-NAME       PIC X.                       14760000
147700         10 QAR5-RFRG-MDL-NAME       PIC X.                       14770000
147800         10 QAR5-RFRG-SPCLTY-CD      PIC X(2).                    14780000
147900       05 QAR5-SRVC-LOC-NPI-NUM      PIC X(10).                   14790000
148000       05 QAR5-PPS-STD-VAL-PMT       PIC S9(9)V99 COMP-3.         14800000
148100       05 FILLER-5                   PIC X(484).                  14810000
148200**     05 FILLER-5                   PIC X(490).                  14820000
148300**  05 FILLER-5                   PIC X(500).                     14830000
148400                                                                  14840000
148500   03  QAR5-ONLINE.                                               14850000
148600       05  QAR5-ONLINE-MISC.                                      14860000
148700           07  QAR5-CANCEL-ALERT-IND          PIC X(01).          14870000
148800           07  QAR5-72-AUTO-NOTICE-IND        PIC X(01).          14880000
148900           07  QAR5-CHARGES-SUB-DEDUCT        PIC S9(7)V99 COMP-3.14890000
149000           07  QAR5-ONLINE-PROC-SITE          PIC X(01).          14900000
149100           07  QAR5-PSYC-PRIME-IND            PIC X(01).          14910000
149200           07  QAR5-ONLINE-ORIG-SITE          PIC X(01).          14920000
149300           07  QAR5-CAB-DISP-CODE             PIC X(02).          14930000
149400       05  QAR5-ONLN-TRAILER         OCCURS 2.                    14940000
149500           07  QAR5-ONLN-YEAR                 PIC X(04).          14950000
149600           07  QAR5-ONLN-VISITS               PIC S9(3)    COMP-3.14960000
149700           07  QAR5-ONLN-PINTS                PIC S9(2)V9  COMP-3.14970000
149800           07  QAR5-ONLN-MEDICAL-EXP          PIC S9(5)V99 COMP-3.14980000
149900           07  QAR5-ONLN-PSYCHOL-EXP          PIC S9(5)V99 COMP-3.14990000
150000           07  QAR5-ONLN-PSYCHOL-PAY          PIC S9(5)V99 COMP-3.15000000
150100           07  QAR5-ONLN-PHYTHER-EXP          PIC S9(5)V99 COMP-3.15010000
150200           07  QAR5-ONLN-PHYTHER-PAY          PIC S9(5)V99 COMP-3.15020000
150300           07  QAR5-ONLN-OCCTHER-EXP          PIC S9(5)V99 COMP-3.15030000
150400           07  QAR5-ONLN-OCCTHER-PAY          PIC S9(5)V99 COMP-3.15040000
150500           07  QAR5-ONLN-HHBP-MSTR   OCCURS 2 TIMES.              15050000
150600               09  QAR5-ONLN-HHBP-TRLR-CD        PIC XX.          15060000
150700               09  QAR5-ONLN-HHBP-QUALFY-IND     PIC X.           15070000
150800               09  QAR5-ONLN-HHBP-PARTA-REMAIN   PIC S999.        15080000
150900               09  QAR5-ONLN-HHBP-EARLY-BILL-DT  PIC 9(8).        15090000
151000               09  QAR5-ONLN-HHBP-LATEST-BILL-DT PIC 9(8).        15100000
151100               09  QAR5-ONLN-HHBP-PARTB-APPLIED  PIC S9(4).       15110000
151200           07  QAR5-ONLN-HHEH-MSTR   OCCURS 2 TIMES.              15120000
151300               09  QAR5-ONLN-HHEH-START-DATE     PIC 9(8).        15130000
151400               09  QAR5-ONLN-HHEH-END-DATE       PIC 9(8).        15140000
151500               09  QAR5-ONLN-HHEH-CONT-NUM       PIC X(5).        15150000
151600               09  QAR5-ONLN-HHEH-PROV-NUM       PIC X(6).        15160000
151700               09  QAR5-ONLN-HHEH-FILLER-1       PIC X(7).        15170000
151800               09  QAR5-ONLN-HHEH-NPI-FILLER     PIC X(10).       15180000
151900               09  QAR5-ONLN-HHEH-CODES OCCURS 6 TIMES.           15190000
152000                   11  QAR5-ONLN-HHEH-HRG-CODE   PIC X(5).        15200000
152100                   11  QAR5-ONLN-HHEH-HRG-DATE   PIC 9(8).        15210000
152200               09  QAR5-ONLN-HHEH-DOEBA          PIC 9(8).        15220000
152300               09  QAR5-ONLN-HHEH-DOLBA          PIC 9(8).        15230000
152400               09  QAR5-ONLN-HHEH-PRIN-DIAG-IND  PIC X(1).        15240000
152500               09  QAR5-ONLN-HHEH-PRIN-DIAG      PIC X(7).        15250000
152600               09  QAR5-ONLN-HHEH-2ND-DIAG-IND   PIC X(1).        15260000
152700               09  QAR5-ONLN-HHEH-SECOND-DIAG    PIC X(7).        15270000
152800               09  QAR5-ONLN-HHEH-LUPA-IND       PIC X.           15280000
152900               09  QAR5-ONLN-HHEH-PAT-STAT       PIC XX.          15290000
153000               09  QAR5-ONLN-HHEH-CANCEL-IND     PIC X.           15300000
153100                                                                  15310000
153200*****************************************************             15320000
153300***   FOLLOWING ARE FIXED LENGTH TRAILERS OCCURRING *****         15330000
153400***                 A VARIABLE NUMBER OF TIMES. *********         15340000
153500*****************************************************             15350000
153600                                                                  15360000
153700   03 QAR5-NCH-EDIT-GRP OCCURS 0 TO 13                            15370000
153800              DEPENDING ON QAR5-HCFA-EDIT-CD-CNT.                 15380000
153900     05 QAR5-NCH-EDIT-TRLR-CD PIC X.                              15390000
154000           88 EDIT-TRAILER              VALUE 'E'.                15400000
154100     05 QAR5-NCH-EDIT-CD      PIC X(4).                           15410000
154200                                                                  15420000
154300*  03 QAR5-NCH-PATCH-GRP OCCURS 0 TO 30                           15430000
154400*             DEPENDING ON QAR5-HCFA-PATCH-CD-CNT.                15440000
154500*    05 QAR5-NCH-PATCH-TRLR-CD PIC X.                             15450000
154600*      88 PATCH-TRAILER              VALUE 'P'.                   15460000
154700*    05 QAR5-NCH-PATCH-CD      PIC X(2).                          15470000
154800*    05 QAR5-NCH-PATCH-DATE-APPLIED PIC 9(8).                     15480000
154900                                                                  15490000
155000   03 QAR5-MCO-PRD-TRLR-GRP OCCURS 0 TO 2                         15500000
155100         DEPENDING ON QAR5-MCO-PRD-TRLR-CNT.                      15510000
155200     05 QAR5-MCO-TRLR-CD      PIC X.                              15520000
155300       88 MCO-TRAILER                    VALUE 'M'.               15530000
155400     05 QAR5-MCO-CONTRACT-NUM PIC X(05).                          15540000
155500     05 QAR5-MCO-OPTN-CODE    PIC X.                              15550000
155600     05 QAR5-MCO-EFFECT-DATE PIC 9(8).                            15560000
155700     05 QAR5-MCO-TERM-DATE    PIC 9(8).                           15570000
155800     05 QAR5-MCO-PAYERID-NUM PIC X(14).                           15580000
155900                                                                  15590000
156000***03 QAR5-CLM-PAYERID-TRLR-GRP OCCURS 0 TO 3                     15600000
156100***           DEPENDING ON QAR5-CLM-PAYERID-TRLR-CNT.             15610000
156200***  05 QAR5-PAYERID-TRLR-CD PIC X.                               15620000
156300***        88 PAYERID-TRAILER            VALUE 'I'.               15630000
156400***  05 QAR5-PAYERID-CD       PIC X.                              15640000
156500***  05 QAR5-PAYERID-NUM      PIC X(14).                          15650000
156600                                                                  15660000
156700   03 QAR5-DEMO-ID-TRLR-GRP OCCURS 0 TO 5                         15670000
156800                   DEPENDING ON QAR5-CLM-DEMO-ID-TRLR-CNT.        15680000
156900     05 QAR5-DEMO-ID-TRLR-CD PIC X(01).                           15690000
157000           88 DEMO-TRAILER                VALUE 'D'.              15700000
157100     05 QAR5-DEMO-ID-NUM      PIC X(02).                          15710000
157200     05 QAR5-DEMO-INFO-TXT.                                       15720000
157300        10 QAR5-DEMO-INFO-TXT-1-7    PIC X(7).                    15730000
157400        10 QAR5-DEMO-INFO-TXT-8-12   PIC X(5).                    15740000
157500        10 QAR5-DEMO-INFO-TXT-13-15  PIC X(3).                    15750000
157600                                                                  15760000
157700***03 QAR5-DGNS-TRAILER OCCURS 0 TO 10                            15770000
157800***              DEPENDING ON QAR5-DIAG-CODE-COUNT.               15780000
157900***  05 QAR5-DGNS-TRLR-CD     PIC X(01).                          15790000
158000***    88 DIAG-TRAILER                    VALUE 'Y'.              15800000
158100***  05 QAR5-DGNS-CD.                                             15810000
158200***     07 QAR5-DGNS-CD-5     PIC X(05).                          15820000
158300***     07 FILLER             PIC X(01).                          15830000
158400                                                                  15840000
158500   03 QAR5-DGNS-GRP       OCCURS 0 TO 25                          15850000
158600                 DEPENDING ON QAR5-CLM-DGNS-CD-J-CNT.             15860000
158700     05 QAR5-DGNS-TRLR-IND-CD          PIC X.                     15870000
158800       88 DGNS-TRLR-IND-CD                   VALUE 'Y'.           15880000
158900     05 QAR5-DGNS-VRSN-CD              PIC X.                     15890000
159000     05 QAR5-DGNS-CD                   PIC X(7).                  15900000
159100                                                                  15910000
159200   03 QAR5-DGNS-E-GRP       OCCURS 0 TO 12                        15920000
159300                 DEPENDING ON QAR5-CLM-DGNS-E-CD-CNT.             15930000
159400     05 QAR5-DGNS-E-TRLR-IND-CD          PIC X.                   15940000
159500       88 DGNS-E-TRLR-IND-CD                   VALUE 'W'.         15950000
159600     05 QAR5-DGNS-E-VRSN-CD              PIC X.                   15960000
159700     05 QAR5-DGNS-E-CD                   PIC X(7).                15970000
159800                                                                  15980000
159900   03 QAR5-COND-TRAILER OCCURS 0 TO 30                            15990000
160000                     DEPENDING ON QAR5-COND-COUNT.                16000000
160100     05 QAR5-COND-TRLR-CD     PIC X(01).                          16010000
160200           88 COND-TRAILER                VALUE 'C'.              16020000
160300     05 QAR5-RLT-COND-CD      PIC X(02).                          16030000
160400                                                                  16040000
160500   03 QAR5-OCCUR-TRAILER OCCURS 0 TO 30                           16050000
160600                     DEPENDING ON QAR5-OCCR-COUNT.                16060000
160700     05 QAR5-OCCUR-TRLR-CD    PIC X(01).                          16070000
160800           88 OCCUR-TRAILER               VALUE 'O'.              16080000
160900     05 QAR5-RLT-OCRNC-CD     PIC X(02).                          16090000
161000     05 QAR5-RLT-OCRNC-DT     PIC 9(8).                           16100000
161100                                                                  16110000
161200   03 QAR5-SPAN-TRAILER OCCURS 0 TO 10                            16120000
161300                     DEPENDING ON QAR5-SPAN-COUNT.                16130000
161400     05 QAR5-SPAN-TRLR-CD     PIC X(01).                          16140000
161500           88 SPAN-TRAILER                VALUE 'S'.              16150000
161600     05 QAR5-OCRNC-SPAN-CD    PIC X(02).                          16160000
161700     05 QAR5-OCRNC-SPAN-FROM-DT PIC 9(8).                         16170000
161800     05 QAR5-OCRNC-SPAN-THRU-DT PIC 9(8).                         16180000
161900                                                                  16190000
162000   03 QAR5-VAL-TRAILER OCCURS 0 TO 36                             16200000
162100                     DEPENDING ON QAR5-VALU-COUNT.                16210000
162200     05 QAR5-VAL-TRLR-CD      PIC X(01).                          16220000
162300           88 VAL-TRAILER                 VALUE 'V'.              16230000
162400     05 QAR5-CLM-VAL-CD       PIC X(02).                          16240000
162500     05 QAR5-CLM-VAL-AMT      PIC S9(9)V99 COMP-3.                16250000
162600                                                                  16260000
162700   03 QAR5-RVNU-TRAILER      OCCURS 00 TO 45                      16270000
162800         DEPENDING ON QAR5-RVNU-COUNT.                            16280000
162900     05 QAR5-RVNU-TRAILER-CODE    PIC X(1).                       16290000
163000           88 RNVU-TRAILER                VALUE 'R'.              16300000
163100     05 QAR5-RVNU-CENTER.                                         16310000
163200         07 FILLER                PIC X(1).                       16320000
163300         07 QAR5-RVNU-CODE        PIC X(3).                       16330000
163400     05 QAR5-RVNU-DATE            PIC 9(8).                       16340000
163500     05 QAR5-RVNU-ANSI1           PIC X(5).                       16350000
163600     05 QAR5-RVNU-ANSI2           PIC X(5).                       16360000
163700     05 QAR5-RVNU-ANSI3           PIC X(5).                       16370000
163800     05 QAR5-RVNU-ANSI4           PIC X(5).                       16380000
163900     05 QAR5-RVNU-HIPPS-CODE      PIC X(5).                       16390000
164000     05 QAR5-RVNU-HCPCS           PIC X(5).                       16400000
164100     05 QAR5-RVNU-HCPCS-M1        PIC X(2).                       16410000
164200     05 QAR5-RVNU-HCPCS-M2        PIC X(2).                       16420000
164300     05 QAR5-RVNU-HCPCS-M3        PIC X(2).                       16430000
164400     05 QAR5-RVNU-HCPCS-M4        PIC X(2).                       16440000
164500     05 QAR5-RVNU-HCPCS-M5        PIC X(2).                       16450000
164600     05 QAR5-RVNU-PMT-METHOD-IND  PIC X(2).                       16460000
164700     05 QAR5-RVNU-DISCOUNT-FLAG   PIC X(1).                       16470000
164800     05 QAR5-RVNU-PACKAGE-FLAG    PIC X(1).                       16480000
164900     05 QAR5-RVNU-PRICING-IND     PIC X(2).                       16490000
165000     05 QAR5-RVNU-OTAF-IND-CD     PIC X(1).                       16500000
165100***  05 QAR5-RVNU-OTAF-1          PIC X(1).                       16510000
165200***  05 QAR5-RVNU-OTAF-2          PIC X(1).                       16520000
165300     05 QAR5-RVNU-IDE-NDC-UPC-NUM.                                16530000
165400        10 QAR5-RVNU-IDE-NUM         PIC X(07).                   16540000
165500        10 QAR5-RVNU-FILLER-1        PIC X(17).                   16550000
165600     05 QAR5-RVNU-NDC-QTY-QLFR-CD    PIC XX.                      16560000
165700     05 QAR5-RVNU-NDC-QTY            PIC S9(7)V999 COMP-3.        16570000
165800     05 QAR5-RVNU-UNITS           PIC S9(7)    COMP-3.            16580000
165900     05 QAR5-RVNU-RATE            PIC S9(9)V99 COMP-3.            16590000
166000     05 QAR5-RVNU-BLOOD-DEDUCT    PIC S9(9)V99 COMP-3.            16600000
166100     05 QAR5-RVNU-CASH-DEDUCT     PIC S9(9)V99 COMP-3.            16610000
166200     05 QAR5-RVNU-WAGE-ADJ-COINS  PIC S9(9)V99 COMP-3.            16620000
166300     05 QAR5-RVNU-REDUCE-COINS    PIC S9(9)V99 COMP-3.            16630000
166400     05 QAR5-RVNU-MSP1-PAID-AMT   PIC S9(9)V99 COMP-3.            16640000
166500     05 QAR5-RVNU-MSP2-PAID-AMT   PIC S9(9)V99 COMP-3.            16650000
166600**** 05 QAR5-RVNU-PROFESS-COMP    PIC S9(9)V99 COMP-3.            16660000
166700     05 QAR5-RVNU-PROVIDER-PMT    PIC S9(9)V99 COMP-3.            16670000
166800     05 QAR5-RVNU-PATIENT-AMT     PIC S9(9)V99 COMP-3.            16680000
166900     05 QAR5-RVNU-PATIENT-RESPON  PIC S9(9)V99 COMP-3.            16690000
167000     05 QAR5-RVNU-PAYMENT-AMOUNT  PIC S9(9)V99 COMP-3.            16700000
167100     05 QAR5-RVNU-TOTAL           PIC S9(9)V99 COMP-3.            16710000
167200     05 QAR5-RVNU-NONCOV          PIC S9(9)V99 COMP-3.            16720000
167300**** 05 QAR5-RVNU-OVERRIDE        PIC X(01). NAME CHANGE.         16730000
167400****         RVNU-OVERRIDE = RVNU-DDCTBL-COINSRNC-CD.             16740000
167500     05 QAR5-RVNU-DDCTBL-COINSRNC-CD   PIC X(01).                 16750000
167600     05 QAR5-RVNU-CB-OV               PIC X(01).                  16760000
167700     05 QAR5-RVNU-STATUS-IND          PIC XX.                     16770000
167800     05 QAR5-RVNU-SUSP-DUP-REV-IND    PIC X(01).                  16780000
167900     05 QAR5-RVNU-APC-BUFR-CD         PIC XX.                     16790000
168000     05 QAR5-RVNU-RNDRNG-PHYSN-NPI-NUM       PIC X(10).           16800000
168100     05 QAR5-RVNU-RNDRNG-SRNM-NAME           PIC X(6).            16810000
168200     05 QAR5-RVNU-PWK-CD              PIC X(2).                   16820000
168300     05 QAR5-RVNU-PHYSN-SPCLTY-CD     PIC X(2).                   16830000
168400     05 QAR5-RVNU-THRPY-CAP-IND OCCURS 5 TIMES                    16840000
168500                                      PIC X.                      16850000
168600     05 QAR5-RVNU-FPS-MODEL-NUM       PIC X(2).                   16860000
168700     05 QAR5-RVNU-FPS-RSN-CD          PIC X(3).                   16870000
168800     05 QAR5-RVNU-FPS-RMRK-CD         PIC X(5).                   16880000
168900     05 QAR5-RVNU-FPS-MSN-1-CD        PIC X(5).                   16890000
169000     05 QAR5-RVNU-FPS-MSN-2-CD        PIC X(5).                   16900000
169100     05 QAR5-RVNU-PTNT-ADD-ON-PMT     PIC S9(9)V99 COMP-3.        16910000
169200     05 QAR5-RVNU-PRIOR-AUTH-IND      PIC X(4).                   16920000
169300     05 QAR5-RVNU-UNIQ-TRKNG-NUM      PIC X(14).                  16930000
169400     05 QAR5-RVNU-RP-IND              PIC X.                      16940000
169500     05 QAR5-RVNU-TRNSTNL-DRUG-AMT    PIC S9(7)V9(4) COMP-3.      16950000
169600     05 QAR5-RVNU-FILLER-2            PIC X(349).                 16960000
169700***  05 QAR5-RVNU-FILLER-2            PIC X(355).                 16970000
169800***  05 QAR5-RVNU-FILLER-2            PIC X(356).                 16980000
169900***  05 QAR5-RVNU-FILLER-2            PIC X(380).                 16990000
170000                                                                  17000000
170100   03 QAR5-RECORD-END               PIC X(03).                    17010000
170200*          88 END-OF-RECORD             VALUE 'EOR'.              17020000
170300*          88 END-OF-CLAIM              VALUE 'EOC'.              17030000
170400*                                                                 17040000
170500 01  HEADING-1.                                                   17050000
170600     03  H1-DESC   PIC X(18)  VALUE 'PROGRAM: MQAPHHAB'.          17060000
170700     03  FILLER    PIC X(4)   VALUE  SPACES.                      17070000
170800     03  H1-TITLE  PIC X(48)  VALUE 'MQA QUALITY ASSURANCE'.      17080000
170900     03  H1-DATE   PIC X(10)  VALUE 'MM/DD/CCYY'.                 17090000
171000 01  HEADING-2.                                                   17100000
171100     03  FILLER    PIC X(08)  VALUE 'INPUT : '.                   17110000
171200     03  H2-INFILE PIC X(44)  VALUE SPACES.                       17120000
171300     03  FILLER    PIC X(28)  VALUE SPACES.                       17130000
171400 01  HEADING-3.                                                   17140000
171500     03  FILLER    PIC X(08)  VALUE 'OUTPUT: '.                   17150000
171600     03  H3-OUTFILE PIC X(44)  VALUE SPACES.                      17160000
171700     03  FILLER    PIC X(28)  VALUE SPACES.                       17170000
171800*                                                                 17180000
171900 LINKAGE SECTION.                                                 17190000
172000 01  INPUT-PARAMETER.                                             17200000
172100     03  FILLER            PIC S9(4)     COMP.                    17210000
172200     03  INPUT-IDEN        PIC X(25).                             17220000
172300     03  FILLER            PIC X(01).                             17230000
172400     03  INPUT-CAL-FROM    PIC 9(08).                             17240000
172500     03  FILLER            PIC X(01).                             17250000
172600     03  INPUT-CAL-THRU    PIC 9(08).                             17260000
172700 TITLE 'MQAPHHAB: PROCEDURE DIVISION'.                            17270000
172800 PROCEDURE DIVISION USING INPUT-PARAMETER.                        17280000
172900*PROCEDURE DIVISION USING QAER-RECORD, RANK-CONTROL, TRLR-TBL,    17290000
173000*    HOME-HEALTH-RECORD.                                          17300000
173100     OPEN INPUT CLAIMS-INPUT                                      17310000
173200         OUTPUT CLAIMS-SEG1.                                      17320000
173300*                                                                 17330000
173400     IF FIRST-TIME = 'Y'                                          17340000
173500        PERFORM INITIALIZE-PROGRAM                                17350000
173600        MOVE 'N' TO FIRST-TIME                                    17360000
173700     END-IF.                                                      17370000
173800                                                                  17380000
173900     PERFORM UNTIL CLIN-STATUS(1:1) NOT = ZERO                    17390000
174000        READ CLAIMS-INPUT                                         17400000
174100        IF  (CLIN-STATUS(1:1) NOT = ZERO)                         17410000
174200        AND (CLIN-STATUS NOT = '10')                              17420000
174300           DISPLAY 'CLAIMS-INPUT STATUS = ' CLIN-STATUS           17430000
174400           DISPLAY ' NE 00 OR 10: JOB ABORT'                      17440000
174500           MOVE 16 TO RETURN-CODE                                 17450000
174600           STOP RUN                                               17460000
174700        END-IF                                                    17470000
174800        EVALUATE TRUE                                             17480000
174900            WHEN CLIN-STATUS(1:1) NOT = ZERO                      17490000
175000                 CONTINUE                                         17500000
175100            WHEN OTHER                                            17510000
175200                 ADD 001 TO CLIN-COUNT                            17520000
175300                 MOVE CLIN-RECORD-IN TO WS-CLAIM                  17530000
175400                 MOVE WS-CLAIM TO HOME-HEALTH-RECORD              17540075
175500                 MOVE CLIN-RECORD-IN TO CLIN-RECORD               17550000
175600                                        HOME-HEALTH-RECORD        17560075
175700                 PERFORM PROCESS-CLIN-RECORD                      17570000
175800                    THRU PROCESS-CLIN-RECORD-EXIT                 17580000
175900        END-EVALUATE                                              17590000
176000     END-PERFORM.                                                 17600000
176100                                                                  17610000
176200     CLOSE CLAIMS-INPUT,                                          17620000
176300           CLAIMS-SEG1.                                           17630000
176400                                                                  17640000
176500     PERFORM DISPLAY-FINAL-COUNTS.                                17650000
176600     STOP RUN.                                                    17660000
176700                                                                  17670000
176800 TITLE 'MQAPHHAB: PROCESS-CLIN-RECORD'.                           17680000
176900 PROCESS-CLIN-RECORD.                                             17690000
177000     MOVE CLIN-LEADER  TO QA0L-LEADER, QA1L-LEADER.               17700000
177100     MOVE RUN-DATE     TO QA1L-DATE-RCVD.                         17710000
177200     MOVE SPACES       TO QA1L-ERROR.                             17720000
177300     MOVE ZEROES       TO QA1L-CONTROL-CODE.                      17730000
177400     MOVE QA5L-CLAIM-RIC TO QA1L-CLAIM-RIC.                       17740099
177500                                                                  17750000
177600     IF TESTING                                                   17760000
177700        DISPLAY 'CLIN-LEADER: ' CLIN-LEADER                       17770000
177800     END-IF.                                                      17780000
177900                                                                  17790000
178000** VRSN I PART A 450 RVNU TRLRS 10 SEGS 4/2000                    17800000
178100** PTBX DME/PTB   50 LI   TRLRS  4 SEGS 7/2018                    17810000
178200                                                                  17820000
178300     IF QA1L-CLAIM-RIC < 6                                        17830000
178400        PERFORM ADDL-RVNU-CHK                                     17840000
178500           THRU ADDL-RVNU-CHK-EXIT                                17850000
178600     END-IF.                                                      17860000
178700                                                                  17870000
178800*  MUST EDIT EVEN DENIED CLAIMS, TO POPULATE A/B SPLIT TRLRS      17880000
178900                                                                  17890000
179000     IF   (QAR5-STAY-FROM NUMERIC)                                17900073
179100     AND  (QAR5-STAY-FROM > 19900000)                             17910073
179200          PERFORM EDIT-QAR5-COMMON                                17920000
179300**        PERFORM EDIT-QAR5-HOME-HEALTH                           17930099
179400**           THRU EDIT-QAR5-HOME-HEALTH-EXIT                      17940099
179500     END-IF.                                                      17950000
179600                                                                  17960000
179700     IF ERR NOT > ZERO                                            17970000
179800*         MQAMCER5 WOULD GOBACK TO MQAMCONS                       17980000
179900        CONTINUE                                                  17990000
180000     ELSE                                                         18000000
180100        MOVE ERR TO ERR-CTR                                       18010000
180200        PERFORM RANK-DEMO-ERRORS                                  18020000
180300     END-IF.                                                      18030000
180400                                                                  18040000
180500     PERFORM WRITE-CLAIMS-OUTPUT.                                 18050000
180600*                                                                 18060000
180700 PROCESS-CLIN-RECORD-EXIT.                                        18070000
180800     EXIT.                                                        18080000
180900                                                                  18090000
181000 RANK-DEMO-ERRORS.                                                18100000
181100     IF TESTING DISPLAY 'RANK'                                    18110065
181200        MOVE ERROR-CODES(1:220) TO DISPLAY-ERROR-CODES            18120080
181300        DISPLAY 'ERR : ' ERR-CTR                                  18130064
181400        DISPLAY 'ERROR-CODES 1-20: '                              18140064
181500        DISPLAY DISPLAY-ERROR-CODES                               18150081
181600     END-IF.                                                      18160064
181700                                                                  18170099
181800**I SORT IN RANK ASC; 000 IS HIGHEST RANK, 999 LOWEST             18180000
181900***  PERFORM CALL-MQAMRANK                                        18190099
182000**I  RANK 999 = 'IGNORE', RETURNS BLANK QAER-ERROR: CLEAR DISP    18200000
182100                                                                  18210000
182200**   IF QAER-ERROR-CODE = SPACES                                  18220099
182300**   DEMO: ADAPT ERROR CAPTURE: DO NOT CALL MQAMRANK W MQARQAER   18230099
182400                                                                  18240099
182500     MOVE SPACES TO QA5L-ERROR.                                   18250099
182600                                                                  18260099
182700**********************************************************        18270099
182800*  IN PROD, QAER UPD WOULD DRIVE MQAMCONS REPORT BUILD            18280099
182900*  WITH ERROR-CODE, DISP CODE, ERROR-ADDL, CONTROL-CODE           18290099
183000*    IF ERROR-CODES(1:220) = SPACES                               18300099
183100*       CONTINUE                                                  18310099
183200*    ELSE                                                         18320099
183300*       MOVE '30'   TO QAER-DISP-CODE                             18330099
183400*    END-IF.                                                      18340099
183500                                                                  18350000
183600     MOVE ZERO TO RNK.                                            18360099
183700     PERFORM VARYING X FROM 1 BY 1                                18370099
183800              UNTIL X > ERR                                       18380099
183900        IF ERROR-CODE(X) > SPACES                                 18390099
184000           ADD +1 TO RNK                                          18400099
184100           PERFORM VARYING Y FROM 1 BY 1                          18410099
184200                    UNTIL (Y > ERROR-TBL-MAX)                     18420099
184300              IF (ERROR-CODE(X) = ERR-RNK-CODE(Y))                18430099
184400                  MOVE ERR-RNK-RANK(Y)  TO ERROR-RANK(X)          18440099
184500              ELSE                                                18450099
184600                 IF (ERR-RNK-CODE(RNK) = 'XXXX')                  18460099
184700                    MOVE '999' TO ERROR-RANK(X)                   18470099
184800                    DISPLAY 'ERROR NOT FOUND: ' ERROR-CODE(X)     18480099
184900                 END-IF                                           18490099
185000              END-IF                                              18500099
185100           END-PERFORM                                            18510099
185200        END-IF                                                    18520099
185300     END-PERFORM.                                                 18530099
185400     IF TESTING                                                   18540099
185500        MOVE ERROR-CODES(1:220) TO DISPLAY-ERROR-CODES            18550099
185600        DISPLAY 'ERRORS W RANK: ' DISPLAY-ERROR-CODES             18560099
185700     END-IF.                                                      18570099
185800                                                                  18580000
185900* DEMO: SORT ERR BY RANK                                          18590099
186000*SHUFFLE-RANKED-ERRS. FROM MQAMRANK CALL                          18600099
186100*  ERROR AT INDEX 'ERR' HAS LOWER (MORE SEVERE) RANK THAN PREVIOUS18610099
186200*   ONE(S).  FIND WHERE BELONGS IN ARRAY, MOVE IN WITH BLOCK MOVES18620099
186300* NOTE: SW - 6 IS ((SW - 11) + 5) TO POINT AT RANK.               18630099
186400                                                                  18640099
186500     MOVE +1 TO SW1, MOVE +12 TO SW2.                             18650099
186600     PERFORM UNTIL ERROR-CODES (SW2:5) = SPACES                   18660099
186700         IF ERROR-CODES (SW2 + 5:3) < ERROR-CODES (SW1 + 5:3)     18670099
186800              MOVE ERROR-CODES (SW2:11) TO SWAP-CODE              18680099
186900              PERFORM UNTIL SW1 = +01                             18690099
187000                   OR ERROR-CODES (SW1 - 6:3) < SWAP-CODE (6:3)   18700099
187100                   OR ERROR-CODES (SW1 - 6:3) = SWAP-CODE (6:3)   18710099
187200                  ADD -11 TO SW1                                  18720099
187300                  END-PERFORM                                     18730099
187400              SUBTRACT SW1 FROM SW2 GIVING SWLN                   18740099
187500              MOVE ERROR-CODES (SW1:SWLN) TO SWAP-CODES (12:SWLN) 18750099
187600              ADD  +011 TO SWLN                                   18760099
187700              MOVE SWAP-CODES  (1:SWLN)  TO ERROR-CODES (SW1:SWLN)18770099
187800              MOVE SW2 TO SW1, ADD +11 TO SW2                     18780099
187900         ELSE ADD +11  TO SW1, SW2                                18790099
188000              END-IF                                              18800099
188100         END-PERFORM.                                             18810099
188200**I BUT CAPTURE EVEN 'IGNORE' ERRS.                               18820000
188300                                                                  18830000
188400     IF ERR-CTR = 1                                               18840000
188500         MOVE ERROR-CODE (1) TO QAR5-ERROR-CODE (1)               18850000
188600     ELSE                                                         18860000
188700        PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL                  18870000
188800                       (WS-CTR > ERR-CTR) OR                      18880099
188900                       (WS-CTR > 10)                              18890099
189000          IF ERROR-CODE(WS-CTR) = PREV-ERROR-CODE                 18900099
189100** ELIMINATE DUPLICATE BASE CLAIM ERRORS: 0014                    18910099
189200**           DUPLICATE RVNU LINE ERRORS ARE SKIPPED IN ADD-RVN-ERR18920099
189300             CONTINUE                                             18930099
189400          ELSE                                                    18940099
189500             ADD 1 TO ERR-QAR5-CTR                                18950099
189600             MOVE ERROR-CODE(WS-CTR)                              18960099
189700               TO QAR5-ERROR-CODE(ERR-QAR5-CTR)                   18970099
189800          END-IF                                                  18980099
189900          MOVE ERROR-CODE(WS-CTR) TO PREV-ERROR-CODE              18990099
190000        END-PERFORM                                               19000000
190100     END-IF.                                                      19010000
190200     IF TESTING                                                   19020099
190300        MOVE ERROR-CODES(1:220) TO DISPLAY-ERROR-CODES            19030099
190400        DISPLAY 'ERRORS RANKED: ' DISPLAY-ERROR-CODES             19040099
190500        DISPLAY 'QAR5-ERRORS  : ' QAR5-ERROR-CODES                19050099
190600     END-IF.                                                      19060099
190700                                                                  19070000
190800 TITLE 'MQAPHHAB: ADDL-RVNU-CHK'                                  19080000
190900 ADDL-RVNU-CHK.                                                   19090000
191000     IF TESTING                                                   19100070
191100        DISPLAY 'ADDL-RVNU-CHK BEG' QAR5-CAN                      19110071
191200     END-IF.                                                      19120070
191300*  INIT TRL-RVNU; MOVE IN RVNU TRLRS FM RECORD                    19130000
191400     MOVE ZEROES       TO TRL-RVNU-COUNT                          19140067
191500                          TRL-ERR-COUNT                           19150067
191600                                                                  19160000
191700     PERFORM VARYING SEG-CNTR FROM 1 BY 1                         19170000
191800             UNTIL   SEG-CNTR GREATER  WS-SEGA-MAX                19180000
191900        MOVE INIT-RVNU-RECORD  TO HRVNU-REC (SEG-CNTR)            19190000
192000        MOVE INIT-TRL-TRLR     TO TRL-TRLR(SEG-CNTR)              19200067
192100     END-PERFORM                                                  19210000
192200                                                                  19220000
192300     PERFORM ADDL-TRLRS                                           19230000
192400        THRU ADDL-TRLRS-EXIT                                      19240000
192500        VARYING SEG-CNTR FROM 1 BY 1                              19250000
192600        UNTIL SEG-CNTR   GREATER QA5L-TOT-SEG-COUNT               19260099
192700        OR    CLIN-STATUS (1:1) NOT EQUAL ZERO.                   19270000
192800                                                                  19280000
192900     IF TESTING                                                   19290071
193000        DISPLAY 'ADDL-RVNU-CHK END'                               19300071
193100     END-IF.                                                      19310071
193200 ADDL-RVNU-CHK-EXIT.                                              19320000
193300     EXIT.                                                        19330000
193400                                                                  19340000
193500 ADDL-TRLRS.                                                      19350000
193600     IF SEG-CNTR = 1                                              19360000
193700        MOVE CLIN-RECORD    TO WS-RVNU-RECORD                     19370000
193800        MOVE CLIN-RECORD    TO CLIN-RVNU-RECORD                   19380000
193900        MOVE WS-RVNU-TOT-COUNT TO TRL-RVNU-COUNT                  19390067
194000     ELSE                                                         19400000
194100        READ CLAIMS-INPUT                                         19410000
194200        IF CLIN-STATUS(1:1) NOT = ZERO                            19420000
194300           GO TO ADDL-TRLRS-EXIT                                  19430000
194400        END-IF                                                    19440000
194500        ADD +1              TO CLIN-RVNU-COUNT                    19450000
194600        MOVE CLIN-RECORD-IN TO WS-RVNU-RECORD                     19460000
194700        MOVE CLIN-RECORD-IN TO CLIN-RVNU-RECORD                   19470000
194800     END-IF                                                       19480000
194900                                                                  19490000
195000     MOVE CLIN-RVNU-RECORD TO HRVNU-REC (SEG-CNTR)                19500000
195100                                                                  19510000
195200*  NOTE!! WORKS ONLY IF RVNU TRLRS ARE AT END OF RECORDS          19520000
195300     COMPUTE RVNU-LEN = 606 * HRVNU-TRLR-COUNT (SEG-CNTR)         19530000
195400     COMPUTE RVNU-BEG =                                           19540000
195500                     HRVNU-RECL (SEG-CNTR) - (RVNU-LEN + 3) + 1   19550000
195600     MOVE HRVNU-CLAIM (SEG-CNTR) (RVNU-BEG:RVNU-LEN)              19560000
195700       TO TRL-TRLR (SEG-CNTR).                                    19570067
195800 ADDL-TRLRS-EXIT.                                                 19580000
195900     EXIT.                                                        19590000
196000                                                                  19600000
196100 TITLE 'MQAPHHAB: EDIT-QAR5-COMMON'.                              19610000
196200 EDIT-QAR5-COMMON.                                                19620000
196300     IF TESTING                                                   19630068
196400        DISPLAY 'EDIT-QAR5-COMMON ' QAR5-CAN                      19640068
196500        DISPLAY 'QAR5-NRLINE-RIC  ' QAR5-NCH-NEAR-LINE-RIC-CD     19650082
196600     END-IF                                                       19660068
196700                                                                  19670068
196800     MOVE EDIT-WORK-FORMAT TO EDIT-WORK.                          19680000
196900     MOVE EDIT-SRT-FORMAT TO WS-SRT-TRL-WORK.                     19690000
197000     MOVE EDIT-RANK-CONTROL-FORMAT TO RANK-CONTROL.               19700085
197100     INITIALIZE SWAP-CONTROL.                                     19710099
197200     MOVE ZEROES TO TRL-ERR-COUNT.                                19720000
197300     MOVE QAR5-ACTION-CODE TO ACT-CDE-SW.                         19730000
197400     MOVE QAR5-NOPAY-CODE TO TEST-NOPAY.                          19740000
197500*    MOVE QAR5-PROVIDER   TO TEST-PROV.                           19750099
197600     MOVE QAR5-BILL-TYPE  TO TEST-TOBXX.                          19760000
197700*                                                                 19770000
197800* Y0X5  AGE => 115                                                19780000
197900     MOVE FUNCTION CURRENT-DATE(1:8) TO SYSTEM-DAY.               19790000
198000     MOVE SYSTEM-DAY TO CURRENT-DAY.                              19800000
198100*  CCYYMMDD - CCYYMMDD                                            19810000
198200     IF QAR5-HIMA-DOB > ZERO                                      19820000
198300        COMPUTE Y0X5-AGE = CURRENT-DAY - QAR5-HIMA-DOB            19830000
198400      IF Y0X5-AGE >= 01150000                                     19840000
198500         ADD  +01  TO ERR                                         19850000
198600         MOVE 'Y0X5' TO ERROR-CODE (ERR)                          19860000
198700         MOVE  'X'   TO ERROR-ITEM (ERR)                          19870099
198800      END-IF.                                                     19880000
198900                                                                  19890000
199000*                                                                 19900000
199100*                                                                 19910000
199200     IF NOT ACT-CANCEL-ONLY                                       19920000
199300        IF QAR5-PRNCPAL-DGNS-CD > SPACES                          19930000
199400           EVALUATE QAR5-PRNCPAL-DGNS-VRSN-CD ALSO QAR5-STAY-THRU 19940000
199500              WHEN '9' ALSO 19900101 THRU ICD9-10-TST-DT          19950000
199600              WHEN '0' ALSO ICD9-10-TST-DT THRU 29991231          19960000
199700                 CONTINUE                                         19970000
199800              WHEN OTHER                                          19980000
199900                 ADD  +01    TO ERR                               19990000
200000                 MOVE '4502' TO ERROR-CODE (ERR)                  20000000
200100           END-EVALUATE                                           20010000
200200        END-IF                                                    20020000
200300*  CONTINUING                                                     20030000
200400        IF QAR5-1ST-DGNS-E-CD   > SPACES                          20040000
200500           EVALUATE QAR5-1ST-DGNS-E-VRSN-CD ALSO QAR5-STAY-THRU   20050000
200600              WHEN '9' ALSO 19900101 THRU ICD9-10-TST-DT          20060000
200700              WHEN '0' ALSO ICD9-10-TST-DT THRU 29991231          20070000
200800                 CONTINUE                                         20080000
200900              WHEN OTHER                                          20090000
201000                 ADD  +01    TO ERR                               20100000
201100                 MOVE '4502' TO ERROR-CODE (ERR)                  20110000
201200           END-EVALUATE                                           20120000
201300        END-IF                                                    20130000
201400     END-IF.                                                      20140000
201500*                                                                 20150000
201600                                                                  20160000
201700*  NOTE:                                                          20170000
201800*  VERSION H RECORDS HAVE THE EQUATABLE BIC FIRST THEN THE        20180000
201900*  ACTUAL CLAIM BIC                                               20190000
202000                                                                  20200000
202100     IF (QAR5-CLAIM (1:1) = '{'   OR                              20210000
202200        QAR5-CLAIM (1:1) IS ALPHABETIC) AND                       20220000
202300        QAR5-CLAIM (2:8) IS NUMERIC     AND                       20230000
202400        QAR5-BIC         IS NUMERIC                               20240000
202500        CONTINUE                                                  20250000
202600     ELSE                                                         20260000
202700        IF QAR5-CLAIM (1:9) NOT NUMERIC  OR                       20270000
202800           QAR5-CLAIM (1:3) < '000'      OR                       20280000
202900           QAR5-CLAIM (4:2) = '00'       OR                       20290000
203000           QAR5-CLAIM (6:4) = '0000'                              20300000
203100           ADD  +1     TO ERR                                     20310000
203200           MOVE 'A002' TO ERROR-CODE (ERR)                        20320000
203300           SET A002-BYP  TO TRUE                                  20330077
203400        ELSE                                                      20340000
203500           MOVE QAR5-BIC TO BIC-CODE-1                            20350000
203600           EVALUATE BIC-CODE-1                                    20360000
203700              WHEN 'HA'                                           20370000
203800                 MOVE 'A ' TO BIC-CODE-1                          20380000
203900                 MOVE 'H'  TO QAR5-HA-HB-BIC-CODE                 20390000
204000                 ADD  +01  TO ERR                                 20400000
204100                 MOVE '8894' TO ERROR-CODE (ERR)                  20410000
204200              WHEN 'HB'                                           20420000
204300                 MOVE 'B ' TO BIC-CODE-1                          20430000
204400                 MOVE 'H'  TO QAR5-HA-HB-BIC-CODE                 20440000
204500                 ADD  +01  TO ERR                                 20450000
204600                 MOVE '8894' TO ERROR-CODE (ERR)                  20460000
204700              WHEN 'HC'                                           20470000
204800                 MOVE 'C ' TO BIC-CODE-1                          20480000
204900                 MOVE 'H'  TO QAR5-HA-HB-BIC-CODE                 20490000
205000                 ADD  +01  TO ERR                                 20500000
205100                 MOVE '8894' TO ERROR-CODE (ERR)                  20510000
205200           END-EVALUATE                                           20520000
205300        END-IF                                                    20530000
205400     END-IF.                                                      20540000
205500                                                                  20550000
205600     MOVE QAR5-MBI-ID  (2:1)   TO MBI-POS-2                       20560000
205700     MOVE QAR5-MBI-ID  (5:1)   TO MBI-POS-5                       20570000
205800     MOVE QAR5-MBI-ID  (8:1)   TO MBI-POS-8                       20580000
205900     MOVE QAR5-MBI-ID  (9:1)   TO MBI-POS-9                       20590000
206000     MOVE QAR5-MBI-ID  (3:1)   TO MBI-POS-3                       20600000
206100     MOVE QAR5-MBI-ID  (6:1)   TO MBI-POS-6.                      20610000
206200     IF MBI-POS-3 IS NUMERIC                                      20620000
206300        CONTINUE                                                  20630000
206400     ELSE                                                         20640000
206500        IF MBI-POS-3 IS ALPHABETIC                                20650000
206600           CONTINUE                                               20660000
206700        ELSE                                                      20670000
206800          MOVE 'Y' TO WS-ALNUM-POS-3                              20680000
206900        END-IF                                                    20690000
207000     END-IF.                                                      20700000
207100     IF MBI-POS-6 IS NUMERIC                                      20710000
207200        CONTINUE                                                  20720000
207300     ELSE                                                         20730000
207400        IF MBI-POS-6 IS ALPHABETIC                                20740000
207500           CONTINUE                                               20750000
207600        ELSE                                                      20760000
207700          MOVE 'Y' TO WS-ALNUM-POS-6                              20770000
207800        END-IF                                                    20780000
207900     END-IF.                                                      20790000
208000                                                                  20800000
208100     IF (QAR5-STAY-FROM < '20180501')                             20810000
208200     OR A002-BYP                                                  20820077
208300        CONTINUE                                                  20830000
208400     ELSE                                                         20840000
208500**       EDIT MBI                                                 20850079
208600**       QAR5-STAY-FROM > '20180430'                              20860079
208700        IF ( (QAR5-STAY-FROM < '20181001') AND                    20870000
208800             (QAR5-BENE-ID-TYPE-CD = 'M' OR 'H' OR ' ') )         20880000
208900        OR                                                        20890000
209000           ( (QAR5-STAY-FROM > '20180930') AND                    20900000
209100             (QAR5-BENE-ID-TYPE-CD = 'M' OR 'H') )                20910000
209200           CONTINUE                                               20920000
209300        ELSE                                                      20930000
209400           ADD  +1     TO ERR                                     20940000
209500           MOVE 'A002' TO ERROR-CODE (ERR)                        20950000
209600           SET A002-BYP TO TRUE                                   20960077
209700        END-IF                                                    20970000
209800                                                                  20980000
209900        IF A002-DOIT                                              20990079
210000        AND (QAR5-MBI-ID  NOT = SPACES)                           21000079
210100           IF (QAR5-MBI-ID (1:1) < 1) OR                          21010079
210200              (QAR5-MBI-ID (1:1) NOT NUMERIC)  OR                 21020079
210300              INVLD-MBI-POS-2 OR                                  21030000
210400              (QAR5-MBI-ID  (2:1)  NOT ALPHABETIC)   OR           21040079
210500              INVLD-MBI-POS-5 OR                                  21050000
210600              (QAR5-MBI-ID  (5:1)  NOT ALPHABETIC)   OR           21060079
210700              INVLD-MBI-POS-8 OR                                  21070000
210800              (QAR5-MBI-ID  (8:1)  NOT ALPHABETIC)   OR           21080079
210900              INVLD-MBI-POS-9 OR                                  21090000
211000              (QAR5-MBI-ID  (9:1)  NOT ALPHABETIC)   OR           21100079
211100              (QAR5-MBI-ID  (4:1)  NOT NUMERIC)  OR               21110079
211200              (QAR5-MBI-ID  (7:1)  NOT NUMERIC)  OR               21120079
211300              (QAR5-MBI-ID  (10:1) NOT NUMERIC)  OR               21130079
211400              (QAR5-MBI-ID  (11:1) NOT NUMERIC)  OR               21140079
211500              INVLD-MBI-POS-3 OR                                  21150000
211600              NOTALNUM-POS-3  OR                                  21160000
211700              INVLD-MBI-POS-6 OR                                  21170000
211800              NOTALNUM-POS-6                                      21180000
211900              ADD  +1     TO ERR                                  21190000
212000              MOVE 'A002' TO ERROR-CODE (ERR)                     21200000
212100              SET A002-BYP TO TRUE                                21210077
212200           END-IF                                                 21220000
212300        END-IF                                                    21230000
212400     END-IF.                                                      21240000
212500                                                                  21250000
212600*                                                                 21260000
212700*  NB  NO SURG TRLRS RIC5                                         21270000
212800*                                                                 21280000
212900     IF QAR5-CLM-DEMO-ID-TRLR-CNT > 0                             21290000
213000        MOVE 'N' TO ERROR-5277-SW                                 21300000
213100        PERFORM EDIT-DEMO-TRLR THRU EDIT-DEMO-TRLR-EXIT           21310000
213200* R2012100 EDIT FOR 5277                                          21320000
213300        IF ERROR-5277                                             21330000
213400          IF (NOPAY-B OR NOPAY-N OR MSP-COST-AVOID OR             21340000
213500             ACT-CANCEL-ONLY OR                                   21350000
213600             TRL-RVNU-TOTAL(QAR5-RVNU-COUNT) =                    21360000
213700             TRL-RVNU-NONCOV(QAR5-RVNU-COUNT))                    21370000
213800            CONTINUE                                              21380000
213900          ELSE                                                    21390000
214000            ADD +1 TO ERR                                         21400000
214100            MOVE '5277' TO ERROR-CODE(ERR).                       21410000
214200                                                                  21420000
214300                                                                  21430000
214400     IF QAR5-COND-COUNT > ZERO                                    21440000
214500       PERFORM VARYING COND FROM 1 BY 1                           21450000
214600         UNTIL COND > QAR5-COND-COUNT                             21460000
214700         MOVE ITEM-CODE(COND) TO ITEM-ID                          21470000
214800         EVALUATE QAR5-RLT-COND-CD (COND)                         21480000
214900           WHEN 'M2'                                              21490000
215000                SET COND-M2 TO TRUE                               21500000
215100           WHEN 'C1'                                              21510000
215200                SET COND-C1 TO TRUE                               21520000
215300           WHEN 'C3'                                              21530000
215400                SET COND-C3 TO TRUE                               21540000
215500           WHEN 'C4'                                              21550000
215600                SET COND-C4 TO TRUE                               21560000
215700           WHEN 'C5'                                              21570000
215800                SET COND-C5 TO TRUE                               21580000
215900           WHEN 'C6'                                              21590000
216000                SET COND-C6 TO TRUE                               21600000
216100           WHEN 'C7'                                              21610000
216200                SET COND-C7 TO TRUE                               21620000
216300           WHEN '26'                                              21630000
216400                SET COND-26 TO TRUE                               21640000
216500           WHEN 'WO'                                              21650000
216600                SET COND-WO      TO TRUE                          21660000
216700           WHEN '58'                                              21670000
216800                SET COND-58      TO TRUE                          21680000
216900           WHEN  '69'                                             21690000
217000             IF QAR5-TRANS-CODE     NOT = '4'                     21700000
217100                SET  COND-69 TO TRUE                              21710000
217200                MOVE ITEM-ID TO COND-69-ITEM-ID                   21720000
217300             END-IF                                               21730000
217400           WHEN  '78'                                             21740000
217500             IF QAR5-TRANS-CODE     NOT = '4'                     21750000
217600                 SET  COND-78 TO TRUE                             21760000
217700             END-IF                                               21770000
217800         END-EVALUATE                                             21780000
217900       END-PERFORM                                                21790000
218000     ELSE                                                         21800000
218100        SET COND-NULL TO TRUE                                     21810000
218200     END-IF.                                                      21820000
218300                                                                  21830000
218400                                                                  21840000
218500                                                                  21850000
218600     SET 0001-NOT-FOUND TO TRUE.                                  21860000
218700                                                                  21870000
218800     MOVE ' ' TO WS-IDE ERR-3706-SW.                              21880000
218900                                                                  21890000
219000     IF NO-PAYMENT-BILL                                           21900000
219100        CONTINUE                                                  21910000
219200     ELSE                                                         21920000
219300     IF TESTING                                                   21930068
219400        DISPLAY 'TRL-RVNU-COUNT ' TRL-RVNU-COUNT                  21940068
219500     END-IF                                                       21950068
219600     IF  TRL-RVNU-COUNT      IS POSITIVE                          21960000
219700        AND TRL-RVNU-CENTER (1) IS NUMERIC                        21970000
219800        AND TRL-RVNU-CENTER (1) > '0000'                          21980000
219900        PERFORM EDIT-QAR5-REVENUES                                21990000
220000     ELSE                                                         22000000
220100     IF VALID-NOPAY                                               22010000
220200        CONTINUE                                                  22020000
220300     ELSE                                                         22030000
220400        ADD  +0001   TO ERR                                       22040000
220500        MOVE '9901'  TO ERROR-CODE (ERR).                         22050000
220600                                                                  22060000
220700                                                                  22070000
220800     IF  QAR5-VALU-COUNT > 0                                      22080000
220900         PERFORM EDIT-VALU-TRLR THRU EDIT-VALU-TRLR-EXIT.         22090000
221000                                                                  22100000
221100*    EDIT PPS                                                     22110000
221200     PERFORM PPS-GENL-EDITS.                                      22120000
221300                                                                  22130000
221400 PPS-GENL-EDITS.                                                  22140000
221500*  MSP-VALCD 12-16,41-43,47 NOT SPLITTING AMT IN VAL TRLRS 62-65  22150000
221600     IF  (TOB-32 OR TOB-33)                                       22160000
221700     AND (QAR5-BILL-TYPE(3:1) NOT = '2')                          22170000
221800     AND (QAR5-STAY-FROM > 20001000)                              22180000
221900        IF A041-BYPASS                                            22190000
222000        OR ACT-CREDIT-CANCEL                                      22200000
222100           CONTINUE                                               22210000
222200        ELSE                                                      22220000
222300           IF  (VALCD-62-SEEN OR VALCD-63-SEEN)                   22230000
222400           AND ((VALCD-62-AMT + VALCD-63-AMT) > +4)               22240000
222500           AND (QAR5-LUPA-IND = 'L')                              22250000
222600              ADD  +01        TO ERR                              22260000
222700              MOVE 'A041'     TO ERROR-CODE (ERR)                 22270000
222800           END-IF                                                 22280000
222900        END-IF                                                    22290000
223000        COMPUTE CALCDAYS =                                        22300000
223100            ( FUNCTION INTEGER-OF-DATE(QAR5-STAY-THRU) -          22310000
223200              FUNCTION INTEGER-OF-DATE(QAR5-STAY-FROM) )          22320000
223300        END-COMPUTE                                               22330000
223400        IF CALCDAYS > 60                                          22340000
223500           ADD  +01        TO ERR                                 22350000
223600           MOVE '2213'     TO ERROR-CODE (ERR)                    22360000
223700        END-IF                                                    22370000
223800        IF A041-BYPASS                                            22380000
223900        OR ACT-CREDIT-CANCEL                                      22390000
224000          CONTINUE                                                22400000
224100        ELSE                                                      22410000
224200         EVALUATE QAR5-NCH-NEAR-LINE-RIC-CD                       22420000
224300           WHEN 'V'                                               22430000
224400           WHEN 'W'                                               22440000
224500             IF (VALCD-62-SEEN AND VALCD-64-SEEN)                 22450000
224600             OR (VALCD-63-SEEN AND VALCD-65-SEEN)                 22460000
224700             OR MSP-VALCD                                         22470000
224800                CONTINUE                                          22480000
224900             ELSE                                                 22490000
225000                ADD  +01        TO ERR                            22500000
225100                MOVE '46#U'     TO ERROR-CODE (ERR)               22510000
225200             END-IF                                               22520000
225300             IF ( (QAR5-BILL-TYPE(1:1) = '3') AND                 22530000
225400                  (QAR5-BILL-TYPE(3:1) = '2') )                   22540000
225500             OR ( (E46XV-UNITS NOT = ZERO) AND                    22550000
225600                  (E46XV-UNITS =                                  22560000
225700                         VALCD-62-AMT + VALCD-63-AMT) )           22570000
225800             OR (NOPAY-R AND                                      22580000
225900                (ZERO = VALCD-62-AMT AND VALCD-63-AMT AND         22590000
226000                        VALCD-64-AMT AND VALCD-65-AMT))           22600000
226100                CONTINUE                                          22610000
226200             ELSE                                                 22620000
226300                ADD  +01        TO ERR                            22630000
226400                MOVE '46#V'     TO ERROR-CODE (ERR)               22640000
226500             END-IF                                               22650000
226600          WHEN 'U'                                                22660000
226700             IF (VALCD-62-SEEN AND VALCD-64-SEEN)                 22670000
226800             OR (VALCD-63-SEEN AND VALCD-65-SEEN)                 22680000
226900             OR MSP-VALCD                                         22690000
227000             OR NOPAY-R                                           22700000
227100                CONTINUE                                          22710000
227200             ELSE                                                 22720000
227300                ADD  +01        TO ERR                            22730000
227400                MOVE '46#U'     TO ERROR-CODE (ERR)               22740000
227500             END-IF                                               22750000
227600             IF ( (QAR5-BILL-TYPE(1:1) = '3') AND                 22760000
227700                  (QAR5-BILL-TYPE(3:1) = '2') )                   22770000
227800             OR ( (E46XV-UNITS NOT = ZERO) AND                    22780000
227900                  (E46XV-UNITS =                                  22790000
228000                         VALCD-62-AMT + VALCD-63-AMT) )           22800000
228100             OR (NOPAY-R AND                                      22810000
228200                (ZERO = VALCD-62-AMT AND VALCD-63-AMT AND         22820000
228300                        VALCD-64-AMT AND VALCD-65-AMT))           22830000
228400                CONTINUE                                          22840000
228500             ELSE                                                 22850000
228600                ADD  +01        TO ERR                            22860000
228700                MOVE '46#V'     TO ERROR-CODE (ERR)               22870000
228800             END-IF                                               22880000
228900        END-EVALUATE                                              22890000
229000     END-IF.                                                      22900000
229100                                                                  22910000
229200     IF  (QAR5-BILL-TYPE = '322' OR '332')                        22920000
229300     AND (QAR5-NCH-NEAR-LINE-RIC-CD = 'V' OR 'W')                 22930000
229400     AND (QAR5-STAY-FROM > 20001000)                              22940000
229500        SET SKIP-HHAB-RAP TO TRUE                                 22950000
229600     ELSE                                                         22960000
229700     IF ( TOB-32 AND                                              22970000
229800          (QAR5-STAY-FROM > 20131000)  AND                        22980000
229900          (QAR5-NCH-NEAR-LINE-RIC-CD NOT = 'U' AND 'W' AND 'V') ) 22990000
230000     OR ( (QAR5-STAY-FROM > 20001000 AND < 20131000)  AND         23000000
230100          (TOB-32 AND                                             23010000
230200           (QAR5-NCH-NEAR-LINE-RIC-CD NOT = 'U' AND 'W')) OR      23020000
230300          (TOB-33  AND                                            23030000
230400           (QAR5-NCH-NEAR-LINE-RIC-CD NOT = 'U' AND 'V')) )       23040000
230500        ADD  +01        TO ERR                                    23050000
230600        MOVE '0415'     TO ERROR-CODE (ERR).                      23060000
230700                                                                  23070000
230800     IF ( (QAR5-BILL-TYPE(1:1) = '3') AND                         23080000
230900          (QAR5-BILL-TYPE(3:1) = '5') )                           23090000
231000       IF (QAR5-STAY-FROM > 20001000)                             23100000
231100       OR (QAR5-STAY-THRU > 20001000)                             23110000
231200        ADD  +01        TO ERR                                    23120000
231300        MOVE '0418'     TO ERROR-CODE (ERR).                      23130000
231400                                                                  23140000
231500*    IF  (NOT ACT-CREDIT-CANCEL) ALLOW 8/27/01, FOR RON PRIHODA   23150000
231600*    04/24/02 NOPAY N,B,Q,T-Y DO NOT HAVE THE TRAILERS!!!         23160000
231700                                                                  23170000
231800     IF A041-BYPASS                                               23180000
231900*    OR NOPAY-R  PRP NEEDS SPLIT DONE OR MISSING VAL TRLR FLAGGED 23190000
232000     OR (QAR5-STAY-FROM < 20001000)                               23200000
232100     OR (QAR5-BILL-TYPE = '322' OR '332')                         23210000
232200         IF TESTING                                               23220087
232300            DISPLAY 'HHAB-SPLIT-CHGS BYP'                         23230087
232400            DISPLAY 'TOB :' QAR5-BILL-TYPE                        23240087
232500         END-IF                                                   23250087
232600*       CONTINUE                                                  23260083
232700     ELSE                                                         23270000
232800* R2013400  SPECS ARE ALREADY IN FORCE BELOW                      23280099
232900        EVALUATE QAR5-NCH-NEAR-LINE-RIC-CD                        23290000
233000           WHEN 'U'                                               23300000
233100              IF VALCD-62-SEEN AND VALCD-63-SEEN                  23310000
233200                 PERFORM HHAB-SPLIT-CHGS                          23320000
233300                 IF TESTING                                       23330096
233400                    MOVE WS-A-AMT    TO WS-A-AMTD                 23340096
233500                    MOVE WS-B-AMT    TO WS-B-AMTD                 23350097
233600                    MOVE WS-C-AMT    TO WS-C-AMTD                 23360097
233700                    MOVE WS-AB-AMT   TO WS-AB-AMTD                23370097
233800                                                                  23380096
233900                    DISPLAY 'VALXX AMT: ' WS-A-AMTD               23390096
234000                    DISPLAY 'VALXY AMT: ' WS-B-AMTD               23400096
234100                    DISPLAY 'VALXZ AMT: ' WS-C-AMTD               23410096
234200                    DISPLAY 'A + B AMT: ' WS-AB-AMTD              23420096
234300                 END-IF                                           23430096
234400              ELSE                                                23440000
234500                 SET ERR-0419 TO TRUE                             23450000
234600              END-IF                                              23460000
234700           WHEN 'V'                                               23470000
234800              IF SKIP-HHAB-RAP                                    23480000
234900                 CONTINUE                                         23490000
235000              ELSE                                                23500000
235100              IF VALCD-62-SEEN                                    23510000
235200                 IF VALCD-63-SEEN                                 23520000
235300                    SET ERR-0419 TO TRUE                          23530000
235400                 END-IF                                           23540000
235500              ELSE                                                23550000
235600                 SET ERR-0419 TO TRUE                             23560000
235700              END-IF                                              23570000
235800              END-IF                                              23580000
235900           WHEN 'W'                                               23590000
236000              IF SKIP-HHAB-RAP                                    23600000
236100                 CONTINUE                                         23610000
236200              ELSE                                                23620000
236300              IF VALCD-63-SEEN                                    23630000
236400                 IF VALCD-62-SEEN                                 23640000
236500                    SET ERR-0419 TO TRUE                          23650000
236600                 END-IF                                           23660000
236700              ELSE                                                23670000
236800                 SET ERR-0419 TO TRUE                             23680000
236900              END-IF                                              23690000
237000              END-IF                                              23700000
237100        END-EVALUATE                                              23710000
237200*    BUT DO NOT POST THE ERROR FOR CRED/CANC 10/01/01             23720000
237300        IF  ACT-CREDIT-CANCEL                                     23730000
237400          CONTINUE                                                23740000
237500        ELSE                                                      23750000
237600        IF ERR-0419                                               23760000
237700           ADD  +01        TO ERR                                 23770000
237800           MOVE '0419'     TO ERROR-CODE (ERR)                    23780000
237900        END-IF.                                                   23790000
238000                                                                  23800000
238100 HHAB-SPLIT-CHGS.                                                 23810000
238200     IF TESTING                                                   23820083
238300        DISPLAY 'HHAB-SPLIT-CHGS'                                 23830083
238400     END-IF                                                       23840083
238500     ADD  +01        TO ERR.                                      23850000
238600     MOVE 'Y001'     TO ERROR-CODE (ERR).                         23860000
238700                                                                  23870099
238800*  SORT AB VISIT-ONLY ARRAY BY DATE                               23880000
238900     MOVE VALCD-62-AMT TO WS-A-VISIT.                             23890000
239000     MOVE VALCD-63-AMT TO WS-B-VISIT.                             23900000
239100                                                                  23910000
239200     IF TESTING                                                   23920087
239300        MOVE WS-A-VISIT TO DISP-NBRA                              23930087
239400        MOVE WS-B-VISIT TO DISP-NBRB                              23940087
239500        DISPLAY 'A-VISIT:' DISP-NBRA                              23950087
239600                '  B-VISIT:' DISP-NBRB                            23960087
239700        MOVE ABNX       TO DISP-NBRA                              23970089
239800        DISPLAY 'ABNX: ' DISP-NBRA                                23980090
239900        MOVE VALXX-NDX  TO DISP-NBRA                              23990091
240000        MOVE VALXY-NDX  TO DISP-NBRB                              24000091
240100        MOVE VALXZ-NDX  TO DISP-NBRC                              24010091
240200        DISPLAY 'VALXX: ' DISP-NBRA '   VALXY: ' DISP-NBRB        24020092
240300             '   VALXZ: ' DISP-NBRC                               24030092
240400     END-IF                                                       24040087
240500     IF ABNX > +1                                                 24050000
240600        PERFORM SORT-AB-VISITS                                    24060000
240700          UNTIL SORT-DONE.                                        24070000
240800                                                                  24080000
240900*    PERFORM VARYING ABNY FROM 1 BY 1                             24090000
241000*      UNTIL ABNY > ABNX                                          24100000
241100*    DISPLAY 'SRT-DT:' WS-SRT-TRL-DATE(ABNY)                      24110000
241200*    '   SRT-AMT:' WS-SRT-TRL-TOTAL(ABNY)                         24120000
241300*    END-PERFORM.                                                 24130000
241400                                                                  24140000
241500     PERFORM VARYING ABNY FROM 1 BY 1                             24150000
241600       UNTIL ABNY > WS-A-VISIT                                    24160000
241700         ADD WS-SRT-TRL-TOTAL(ABNY) TO WS-A-AMT                   24170000
241800     END-PERFORM.                                                 24180000
241900                                                                  24190000
242000     COMPUTE WS-B-AMT = WS-AB-AMT - WS-A-AMT                      24200000
242100                                                                  24210000
242200     IF VALXX-NDX > ZERO                                          24220000
242300        IF WS-A-AMT NOT EQUAL ZERO                                24230000
242400           MOVE WS-A-AMT    TO QAR5-CLM-VAL-AMT(VALXX-NDX)        24240000
242500        END-IF                                                    24250000
242600     ELSE                                                         24260000
242700        ADD  +01        TO ERR                                    24270000
242800        MOVE '0419'     TO ERROR-CODE (ERR).                      24280000
242900     IF VALXY-NDX > ZERO                                          24290000
243000        IF WS-B-AMT NOT EQUAL ZERO                                24300000
243100           MOVE WS-B-AMT    TO QAR5-CLM-VAL-AMT(VALXY-NDX)        24310000
243200        END-IF                                                    24320000
243300     ELSE                                                         24330000
243400        ADD  +01        TO ERR                                    24340000
243500        MOVE '0419'     TO ERROR-CODE (ERR).                      24350000
243600                                                                  24360000
243700     IF VALXZ-NDX > ZERO                                          24370000
243800        IF TRL-RVNU-TOTAL(TRL-RVNU-COUNT) NOT = ZERO              24380000
243900           COMPUTE WS-C-AMT =                                     24390000
244000           TRL-RVNU-TOTAL(TRL-RVNU-COUNT) - WS-AB-AMT             24400000
244100           MOVE WS-C-AMT TO  QAR5-CLM-VAL-AMT(VALXZ-NDX)          24410000
244200        END-IF                                                    24420000
244300     ELSE                                                         24430000
244400        ADD  +01        TO ERR                                    24440000
244500        MOVE '0419'     TO ERROR-CODE (ERR).                      24450000
244600                                                                  24460000
244700 SORT-AB-VISITS.                                                  24470000
244800     SET SORT-DONE TO TRUE.                                       24480000
244900     PERFORM SORT-VISITS                                          24490000
245000       VARYING ABNY FROM 1 BY 1                                   24500000
245100       UNTIL   ABNY > (ABNX - +1).                                24510000
245200                                                                  24520000
245300 SORT-VISITS.                                                     24530000
245400     IF WS-SRT-TRL-DATE(ABNY) > WS-SRT-TRL-DATE(ABNY + 1)         24540000
245500        MOVE WS-SRT-TRL(ABNY + 1) TO WS-HLD-RVNU                  24550000
245600        MOVE WS-SRT-TRL(ABNY)     TO WS-SRT-TRL(ABNY + 1)         24560000
245700        MOVE WS-HLD-RVNU          TO WS-SRT-TRL(ABNY)             24570000
245800        SET SORT-NOT-DONE TO TRUE.                                24580000
245900                                                                  24590000
246000                                                                  24600000
246100 EDIT-DEMO-TRLR.                                                  24610000
246200     MOVE 'N' TO ERR-9960-SW.                                     24620000
246300*    MOVE SPACES TO WS-ESRD-PLAN WS-MEDICARE-CHOICE.              24630099
246400     PERFORM VARYING DEMO-CTR FROM 1 BY 1                         24640000
246500              UNTIL DEMO-CTR > QAR5-CLM-DEMO-ID-TRLR-CNT          24650000
246600       EVALUATE QAR5-DEMO-ID-NUM (DEMO-CTR)                       24660000
246700         WHEN '02'                                                24670000
246800           IF QAR5-HOME-HEALTH-88                                 24680099
246900             SET HHA-DEMO TO TRUE                                 24690000
247000             MOVE QAR5-PROVIDER TO HHA-DEMO-PROVIDER              24700000
247100           END-IF                                                 24710000
247200         WHEN '03'                                                24720000
247300           ADD +1 TO ERR                                          24730000
247400           MOVE '4603' TO ERROR-CODE(ERR)                         24740000
247500         WHEN '31'                                                24750000
247600           SET VA-DEMO TO TRUE                                    24760000
247700           IF (STAY-FROM > 20040100) AND                          24770000
247800              (QAR5-ACTION-CODE = '3') AND                        24780000
247900              (QAR5-ICN-ORIG = SPACES OR LOW-VALUES)              24790000
248000               ADD +1 TO ERR                                      24800000
248100               MOVE '5800' TO ERROR-CODE(ERR)                     24810000
248200           END-IF                                                 24820000
248300         WHEN '40'                                                24830000
248400           SET INDHLTH-DEMO TO TRUE                               24840000
248500         WHEN '54'                                                24850000
248600           SET ACE-DEMO       TO TRUE                             24860000
248700* EDIT FOR SECTION 3113 LAB DEMO R2012100 ERROR CODE 14           24870000
248800* AND FLAG THOSE WHERE STAY FROM OR STAY THRU IS NOT VALID        24880000
248900* FOR DEMO                                                        24890000
249000         WHEN '56'                                                24900000
249100           IF QAR5-STAY-FROM >= 20120101 AND                      24910000
249200                             <= 20131231 AND                      24920000
249300              QAR5-STAY-THRU >= 20120101 AND                      24930000
249400                             <= 20131231                          24940000
249500            CONTINUE                                              24950000
249600           ELSE                                                   24960000
249700            ADD +1 TO ERR                                         24970000
249800            MOVE '0014' TO ERROR-CODE(ERR)                        24980000
249900            IF QAR5-STAY-FROM > 20131231 OR                       24990000
250000               QAR5-STAY-THRU > 20131231                          25000000
250100                MOVE 'Y' TO ERROR-5277-SW                         25010000
250200            END-IF                                                25020000
250300           END-IF                                                 25030000
250400         WHEN '59'                                                25040000
250500           SET ACO-PAY-DEMO   TO TRUE                             25050000
250600         WHEN '61'                                                25060000
250700            SET BNDL-CARE-DEMO1 TO TRUE                           25070000
250800         WHEN '62'                                                25080000
250900            SET BNDL-CARE-DEMO2 TO TRUE                           25090000
251000         WHEN '63'                                                25100000
251100            SET BNDL-CARE-DEMO3 TO TRUE                           25110000
251200         WHEN '64'                                                25120000
251300            SET BNDL-CARE-DEMO4 TO TRUE                           25130000
251400         WHEN '74'                                                25140000
251500            SET NG-ACO-DEMO     TO TRUE                           25150000
251600*** R2018404   DEMO CDOE 86 IS VALID                              25160000
251700         WHEN '86'                                                25170000
251800            IF QAR5-STAY-FROM > 20181000                          25180000
251900               SET BPCI-DEMO  TO TRUE                             25190000
252000            ELSE                                                  25200000
252100               ADD +1 TO ERR                                      25210000
252200               MOVE '0014' TO ERROR-CODE(ERR)                     25220000
252300            END-IF                                                25230000
252400*** R2019100   DEMO CODE 89 VT ACO                                25240000
252500         WHEN '89'                                                25250000
252600            IF QAR5-STAY-FROM > 20190100                          25260000
252700               SET VTACO-DEMO  TO TRUE                            25270000
252800            ELSE                                                  25280000
252900               ADD +1 TO ERR                                      25290000
253000               MOVE '0014' TO ERROR-CODE(ERR)                     25300000
253100            END-IF                                                25310000
253200         WHEN OTHER                                               25320000
253300           ADD +1 TO ERR                                          25330000
253400           MOVE '0014' TO ERROR-CODE(ERR)                         25340000
253500       END-EVALUATE                                               25350000
253600     END-PERFORM.                                                 25360000
253700 EDIT-DEMO-TRLR-EXIT.                                             25370000
253800     EXIT.                                                        25380000
253900                                                                  25390000
254000 EDIT-QAR5-REVENUES.                                              25400000
254100     MOVE 0 TO HOSPICE-0657.                                      25410000
254200     MOVE 0 TO HOSPICE-NOT-0657.                                  25420000
254300     MOVE 0 TO R0624-CTR.                                         25430000
254400     PERFORM EDIT-QAR5-REVENUE                                    25440000
254500        THRU EDIT-QAR5-REVENUE-EXIT                               25450000
254600         VARYING RVNU FROM 1 BY 1                                 25460000
254700           UNTIL RVNU > TRL-RVNU-COUNT.                           25470000
254800                                                                  25480000
254900                                                                  25490000
255000* PPS NOTE: RIC 5 HAS TOT VISITS FIELD                            25500000
255100*           BUT MUST BYP RVNU LINES FOR TOT=NONCOV                25510000
255200* DEMO: SOME CLAIMS HAVE TOB 329                                  25520099
255300     IF ACT-CREDIT-CANCEL                                         25530000
255400     OR VALID-NOPAY                                               25540000
255500        CONTINUE                                                  25550000
255600     ELSE                                                         25560000
255700        IF QAR5-BILL-TYPE = '329' OR '339'                        25570000
255800           IF  (RVNU0023-TOTAL NOT = ZERO)                        25580000
255900           AND (RVNU0023-TOTAL + RVNUNE23-TOTAL =                 25590000
256000                         TRL-RVNU-TOTAL(TRL-RVNU-COUNT))          25600000
256100              MOVE RVNU0023-NDX TO RVNU                           25610000
256200              MOVE '6101' TO  HOLD-RVNU-C-I                       25620000
256300              PERFORM ADD-RVNU-ERR                                25630000
256400           END-IF                                                 25640000
256500        ELSE                                                      25650000
256600        IF  (QAR5-BILL-TYPE(1:1) = '3')                           25660000
256700        AND (QAR5-BILL-TYPE(3:1) = '2')                           25670000
256800           IF  (RVNU0023-TOTAL NOT = ZERO)                        25680000
256900           AND (RVNU0023-TOTAL NOT =                              25690000
257000                         TRL-RVNU-TOTAL(TRL-RVNU-COUNT))          25700000
257100              MOVE RVNU0023-NDX TO RVNU                           25710000
257200              MOVE '6106' TO  HOLD-RVNU-C-I                       25720000
257300              PERFORM ADD-RVNU-ERR                                25730000
257400           END-IF                                                 25740000
257500        END-IF.                                                   25750000
257600                                                                  25760000
257700*  AS OF 20001000 PPS KICKS IN & CHGS BALANCE RULES WITH RC0023   25770000
257800     IF ACT-CREDIT-CANCEL                                         25780000
257900     OR VALID-NOPAY                                               25790000
258000     OR (QAR5-STAY-FROM > 20001000)                               25800000
258100        CONTINUE                                                  25810000
258200     ELSE                                                         25820000
258300     IF (COMP-TOTL NOT = EDIT-TOTL)                               25830000
258400       IF PAYMENT-BILL                                            25840000
258500         ADD  +001    TO ERR                                      25850000
258600         MOVE '6101'  TO ERROR-CODE (ERR)                         25860000
258700       ELSE                                                       25870000
258800*      NO-PAYMENT-BILL                                            25880000
258900         IF EDIT-TOTL = ZERO                                      25890000
259000         AND ACT-CDE-135                                          25900000
259100            CONTINUE                                              25910000
259200         ELSE                                                     25920000
259300            ADD  +001    TO ERR                                   25930000
259400            MOVE '6101'  TO ERROR-CODE (ERR).                     25940000
259500                                                                  25950000
259600     IF ACT-CREDIT-CANCEL                                         25960000
259700     OR VALID-NOPAY                                               25970000
259800     OR QAR5-BILL-TYPE = '322'                                    25980000
259900        CONTINUE                                                  25990000
260000     ELSE                                                         26000000
260100     IF (COMP-NCOV NOT = EDIT-NCOV)                               26010000
260200        ADD  +001    TO ERR                                       26020000
260300        MOVE '6102'  TO ERROR-CODE (ERR).                         26030000
260400                                                                  26040000
260500 ADD-RVNU-ERR.                                                    26050000
260600*    IF RVNU = ZERO                                               26060000
260700*       DISPLAY 'HOLD-RVNU-ERR-CODE ' HOLD-RVNU-ERR-CODE          26070000
260800*       DISPLAY 'HOLD-RVNU-ITM      ' HOLD-RVNU-ITM               26080000
260900*    END-IF                                                       26090000
261000     SET DUP-RVNU-OK TO TRUE.                                     26100000
261100     PERFORM VARYING RVX FROM 1 BY 1                              26110000
261200             UNTIL   RVX > ERR                                    26120000
261300             OR      DUP-RVNU-ERR                                 26130000
261400         IF HOLD-RVNU-ERR-CODE = ERROR-CODE (RVX)                 26140000
261500         AND ERROR-ADDR (RVX)    > '000'                          26150000
261600            SET DUP-RVNU-ERR TO TRUE                              26160000
261700         END-IF                                                   26170000
261800     END-PERFORM                                                  26180000
261900                                                                  26190000
262000     IF RVNU > ZERO                                               26200000
262100     AND NOT DUP-RVNU-ERR                                         26210000
262200        ADD +001 TO ERR                                           26220000
262300        ADD 1    TO TRL-ERR-COUNT                                 26230000
262400        MOVE HOLD-RVNU-ERR-CODE TO ERROR-CODE (ERR)               26240000
262500        MOVE HOLD-RVNU-ITM  TO ERROR-ITEM  (ERR)                  26250000
262600        MOVE RVNU           TO ERROR-ADDRN (ERR)                  26260000
262700     END-IF.                                                      26270000
262800                                                                  26280000
262900                                                                  26290000
263000 EDIT-QAR5-REVENUE.                                               26300000
263100     MOVE TRL-RVNU (RVNU) TO RVNU-WORK.                           26310000
263200     MOVE RVNU-HCPCS TO TST-RVNU-HCPC.                            26320000
263300     MOVE RVNU-CENTER TO TST-RVNU-CTR.                            26330000
263400                                                                  26340000
263500     SET TOT-EQ-NONCOV-RESET   TO TRUE.                           26350000
263600       IF RVNU-TOTAL = RVNU-NONCOV                                26360000
263700          SET TOT-EQ-NONCOV TO TRUE                               26370000
263800       ELSE                                                       26380000
263900          SET TOT-NEQ-NONCOV TO TRUE                              26390000
264000       END-IF.                                                    26400000
264100                                                                  26410000
264200                                                                  26420000
264300     EVALUATE RVNU-CENTER                                         26430000
264400        WHEN '0022' SET RVNU22-SEEN TO TRUE                       26440000
264500        WHEN '0023' SET RVNU23-SEEN TO TRUE                       26450000
264600        WHEN '0024' SET RVNU24-SEEN TO TRUE                       26460000
264700     END-EVALUATE.                                                26470000
264800*                                                                 26480000
264900     EVALUATE TRUE                                                26490000
265000        WHEN RVNU-CODE(1:2) = '42' OR '43' OR '44' OR             26500000
265100                              '55' OR '56' OR '57'                26510000
265200           ADD 1 TO E0420-CTR                                     26520000
265300        WHEN RVNU-CENTER  = '0624'                                26530000
265400           ADD 1 TO R0624-CTR                                     26540000
265500        WHEN RVNU-CENTER  = '0001'                                26550000
265600           SET 0001-FOUND TO TRUE                                 26560000
265700     END-EVALUATE.                                                26570000
265800                                                                  26580000
265900*  GRAB VALID PPS AB ELEMENTS,TOSS IN ARRAY                       26590000
266000** R2013300 BYP SOME HOME HOSPICE FOR VALCD 62,63 AMTS            26600000
266100                                                                  26610089
266200     IF (QAR5-NCH-NEAR-LINE-RIC-CD = 'U') AND                     26620000
266300        (RVNU-CENTER (1:3) = '042' OR '043' OR '044'              26630000
266400                          OR '055' OR '056' OR '057')             26640000
266500           IF  (RVNU-DATE > 20130700)                             26650000
266600           AND (RVNU-HCPCS = 'Q5001' OR 'Q5002' OR 'Q5009')       26660000
266700              CONTINUE                                            26670000
266800           ELSE                                                   26680000
266900*    AND NOT ACT-CREDIT-CANCEL: ALLOW AS OF 8/27/01               26690089
267000              ADD +1 TO ABNX                                      26700000
267100              MOVE RVNU-DATE             TO WS-SRT-TRL-DATE(ABNX) 26710000
267200              MOVE RVNU-TOTAL            TO WS-SRT-TRL-TOTAL(ABNX)26720000
267300              ADD  RVNU-TOTAL            TO WS-AB-AMT             26730000
267400           END-IF.                                                26740000
267500                                                                  26750000
267600                                                                  26760000
267700*  PPS                                                            26770000
267800     IF ACT-CREDIT-CANCEL                                         26780000
267900     OR (RVNU-CENTER  = '0001')                                   26790000
268000*    OR TOT-EQ-NONCOV                                             26800000
268100        CONTINUE                                                  26810000
268200     ELSE                                                         26820000
268300        IF ((RVNU-CENTER = '0023') AND                            26830063
268400            (NOT TOB-32) AND                                      26840063
268500            (QAR5-STAY-FROM > 20131000))                          26850063
268600           IF TOT-EQ-NONCOV                                       26860063
268700           OR (TEST-NOPAY = 'N')                                  26870063
268800              CONTINUE                                            26880063
268900           ELSE                                                   26890063
269000              MOVE '0417'    TO HOLD-RVNU-C-I                     26900063
269100              PERFORM ADD-RVNU-ERR                                26910063
269200           END-IF                                                 26920063
269300        ELSE                                                      26930063
269400        IF  (TOB-32 OR TOB-33)                                    26940063
269500        AND (QAR5-STAY-FROM > 20001000)                           26950063
269600            PERFORM PPS-RVNU-EDITS                                26960063
269700        ELSE                                                      26970063
269800           IF RVNU-CENTER = '0023'                                26980063
269900              IF TOT-EQ-NONCOV                                    26990063
270000              OR (TEST-NOPAY = 'N')                               27000063
270100                 CONTINUE                                         27010063
270200              ELSE                                                27020063
270300                 MOVE '0417'    TO HOLD-RVNU-C-I                  27030063
270400                 PERFORM ADD-RVNU-ERR                             27040063
270500              END-IF                                              27050063
270600           END-IF                                                 27060063
270700        END-IF                                                    27070063
270800        END-IF                                                    27080063
270900     END-IF.                                                      27090063
271000                                                                  27100000
271100     MOVE SPACES TO HCPC-CATEGORY.                                27110000
271200                                                                  27120000
271300     IF   (RVNU-CENTER        = '0001')                           27130000
271400     OR   (RVNU-HCPCS         = SPACES)                           27140000
271500     OR  ((RVNU-CENTER        = '0023') AND                       27150000
271600          (TOB-32 OR TOB-33) AND                                  27160000
271700          (QAR5-STAY-FROM > 20001000) )                           27170000
271800         CONTINUE                                                 27180000
271900     ELSE                                                         27190000
272000        MOVE RVNU-HCPCS        TO HCPC-PASS-CODE                  27200063
272100        IF RVNU-DATE > ZERO                                       27210063
272200           MOVE RVNU-DATE         TO HCPC-PASS-DATE               27220063
272300        ELSE                                                      27230063
272400           MOVE QAR5-STAY-FROM    TO HCPC-PASS-DATE               27240063
272500        END-IF                                                    27250063
272600        IF TESTING                                                27260063
272700           DISPLAY 'CALL HCPC: ' HCPC-PASS-CODE HCPC-PASS-DATE    27270063
272800        END-IF                                                    27280063
272900                                                                  27290063
273000        PERFORM CALL-MQANHCPC                                     27300076
273100                                                                  27310063
273200        IF  ACT-CREDIT-CANCEL                                     27320063
273300        OR VALID-NOPAY                                            27330063
273400        OR TOT-EQ-NONCOV                                          27340063
273500        OR (QAR5-REIMB-AMT = ZERO)                                27350063
273600        OR (RVNU-CENTER   = '0001' OR '0022' OR '0023' OR '0024') 27360063
273700        OR (RVNU-DDCTBL-COINSRNC-CD = '4')                        27370063
273800        OR (RVNU-HCPCS (1:1) = 'C' OR 'W' OR 'X' OR 'Y' OR 'Z')   27380063
273900           CONTINUE                                               27390063
274000        ELSE                                                      27400063
274100           IF NOT HCPC-ACTIVE                                     27410063
274200              MOVE 'Y0X4' TO HOLD-RVNU-ERR-CODE                   27420063
274300              MOVE '#'    TO HOLD-RVNU-ITM                        27430063
274400              PERFORM ADD-RVNU-ERR                                27440063
274500           END-IF                                                 27450063
274600        END-IF                                                    27460063
274700     END-IF.                                                      27470063
274800                                                                  27480000
274900                                                                  27490000
275000     IF NOT ACT-CREDIT-CANCEL                                     27500000
275100       IF E51X0-RC1                                               27510000
275200           CONTINUE                                               27520000
275300       ELSE                                                       27530000
275400           MOVE '51X0' TO HOLD-RVNU-ERR-CODE                      27540000
275500           MOVE '#'    TO HOLD-RVNU-ITM                           27550000
275600           PERFORM ADD-RVNU-ERR                                   27560000
275700       END-IF                                                     27570000
275800     END-IF.                                                      27580000
275900                                                                  27590000
276000** R2013300 E46XV-UNITS BYP FOR CERTAIN HOSPICE CARE              27600000
276100** R2013300 ?? IMPACT ON A/B SPLIT                                27610000
276200     EVALUATE RVNU-CENTER(2:2)                                    27620000
276300*       WHEN '25'                                                 27630000
276400*          SET  RCC-0636 TO TRUE                                  27640000
276500        WHEN '42'                                                 27650000
276600        WHEN '43'                                                 27660000
276700        WHEN '44'                                                 27670000
276800        WHEN '55'                                                 27680000
276900        WHEN '56'                                                 27690000
277000        WHEN '57'                                                 27700000
277100**         IF  QAR5-NCH-NEAR-LINE-RIC-CD = 'U'                    27710000
277200*          AND (RVNU-DATE > 20130700)                             27720000
277300                                                                  27730000
277400           IF  QAR5-NCH-NEAR-LINE-RIC-CD = 'U'                    27740000
277500             SET HHAB-SPLIT-RVNU-CTR TO TRUE                      27750000
277600             IF  (RVNU-DATE > 20130700)                           27760000
277700             AND (RVNU-HCPCS = 'Q5001' OR 'Q5002' OR 'Q5009')     27770000
277800                 MOVE '8904' TO HOLD-RVNU-C-I                     27780000
277900                 PERFORM ADD-RVNU-ERR                             27790000
278000                 SET E8904-SEEN TO TRUE                           27800000
278100              END-IF                                              27810000
278200           ELSE                                                   27820000
278300             IF  (RVNU-TOTAL > ZERO)                              27830000
278400             AND (RVNU-NONCOV NOT EQUAL RVNU-TOTAL)               27840000
278500                ADD +1 TO E46XV-UNITS                             27850000
278600             END-IF                                               27860000
278700           END-IF                                                 27870000
278800        WHEN '63'                                                 27880000
278900           IF  (RVNU-CENTER  = '0636')                            27890000
279000             SET  RCC-0636 TO TRUE                                27900000
279100           END-IF                                                 27910000
279200        WHEN '66'                                                 27920000
279300           SET  RVNU-66 TO TRUE                                   27930000
279400     END-EVALUATE.                                                27940000
279500                                                                  27950000
279600                                                                  27960000
279700     IF RVNU-CENTER  EQUAL '0001'                                 27970000
279800          MOVE RVNU-TOTAL   TO EDIT-TOTL                          27980000
279900          MOVE RVNU-NONCOV  TO EDIT-NCOV                          27990000
280000          EVALUATE TRUE                                           28000000
280100          WHEN RVNU-DDCTBL-COINSRNC-CD = 'M' OR 'N'               28010000
280200             MOVE RVNU-DDCTBL-COINSRNC-CD TO QA5L-CONTROL-CODE    28020099
280300          WHEN QAR5-PRIMARY-PAY-CODE     = 'C'                    28030000
280400             MOVE QAR5-PRIMARY-PAY-CODE     TO QA5L-CONTROL-CODE  28040099
280500          WHEN OTHER                                              28050000
280600             MOVE SPACE                     TO QA5L-CONTROL-CODE  28060099
280700     ELSE                                                         28070000
280800*    IF  (RVNU-CENTER   NOT = '0001')                             28080000
280900          PERFORM EDIT-QAR5-RVNU-CENTER.                          28090000
281000                                                                  28100000
281100*                                                                 28110000
281200     IF ACT-CREDIT-CANCEL                                         28120000
281300        CONTINUE                                                  28130000
281400     ELSE                                                         28140000
281500       IF RVNU-PAYMENT-AMOUNT  NOT NUMERIC                        28150000
281600          MOVE ZERO   TO RVNU-PAYMENT-AMOUNT                      28160000
281700          MOVE '61XH' TO HOLD-RVNU-ERR-CODE                       28170000
281800          MOVE '#'    TO HOLD-RVNU-ITM                            28180000
281900          PERFORM ADD-RVNU-ERR                                    28190000
282000       ELSE                                                       28200000
282100         IF (RVNU-PAYMENT-AMOUNT  NOT EQUAL ZERO)                 28210000
282200         AND VALID-NOPAY                                          28220000
282300            MOVE '61XH' TO HOLD-RVNU-ERR-CODE                     28230000
282400            MOVE '#'    TO HOLD-RVNU-ITM                          28240000
282500            PERFORM ADD-RVNU-ERR                                  28250000
282600         END-IF                                                   28260000
282700         IF  RVNU-CENTER  NOT = '0001'                            28270000
282800            ADD RVNU-PAYMENT-AMOUNT  TO REV-PAYMENT-AMT           28280000
282900         END-IF.                                                  28290000
283000                                                                  28300000
283100 EDIT-QAR5-REVENUE-EXIT.                                          28310000
283200     EXIT.                                                        28320000
283300                                                                  28330000
283400 PPS-RVNU-EDITS.                                                  28340000
283500*  FM-THRU > 20001000, TOB 32X,33X; VALID HRG IN HCPC FLD         28350000
283600                                                                  28360000
283700     IF RVNU-CENTER NOT = '0023'                                  28370000
283800           ADD RVNU-TOTAL TO RVNUNE23-TOTAL.                      28380000
283900                                                                  28390000
284000     EVALUATE RVNU-CENTER                                         28400000
284100        WHEN '0023'                                               28410000
284200           ADD RVNU-TOTAL TO RVNU0023-TOTAL                       28420000
284300           IF (RVNU-TOTAL) = QAR5-REIMB-AMT                       28430000
284400              SET BYPASS-6109 TO TRUE                             28440000
284500           END-IF                                                 28450000
284600           IF RVNU0023-NDX = ZERO                                 28460000
284700              MOVE RVNU TO RVNU0023-NDX                           28470000
284800           END-IF                                                 28480000
284900           IF (RVNU-TOTAL = RVNU-NONCOV)                          28490000
285000           OR (TEST-NOPAY = 'N')                                  28500000
285100              CONTINUE                                            28510000
285200           ELSE                                                   28520000
285300              IF RVNU-HCPCS (1:2) < 'HA' OR > 'HD'                28530000
285400                 MOVE RVNU-HCPCS  TO TEST-HIPPS-CODE              28540000
285500                 IF  HIPPS-1-OK                                   28550000
285600                 AND HIPPS-2-OK                                   28560000
285700                 AND HIPPS-3-OK                                   28570000
285800                 AND HIPPS-4-OK                                   28580000
285900                 AND HIPPS-5-OK                                   28590000
286000                    CONTINUE                                      28600000
286100                 ELSE                                             28610000
286200                    MOVE '51XY' TO HOLD-RVNU-ERR-CODE             28620000
286300                    MOVE '#'    TO HOLD-RVNU-ITM                  28630000
286400                    PERFORM ADD-RVNU-ERR                          28640000
286500                 END-IF                                           28650000
286600              END-IF                                              28660000
286700           END-IF                                                 28670000
286800        WHEN '0290' THRU '0299'                                   28680000
286900        WHEN '0600' THRU '0609'                                   28690000
287000           IF RVNU-HCPCS NOT > SPACES                             28700000
287100              MOVE '51XX' TO HOLD-RVNU-ERR-CODE                   28710000
287200              MOVE '#'    TO HOLD-RVNU-ITM                        28720000
287300              PERFORM ADD-RVNU-ERR                                28730000
287400           END-IF                                                 28740000
287500        WHEN '0624'                                               28750000
287600              MOVE '51XZ' TO HOLD-RVNU-ERR-CODE                   28760000
287700              MOVE '#'    TO HOLD-RVNU-ITM                        28770000
287800              PERFORM ADD-RVNU-ERR                                28780000
287900     END-EVALUATE.                                                28790000
288000                                                                  28800000
288100 EDIT-QAR5-RVNU-CENTER.                                           28810000
288200     IF  (RVNU-CENTER NOT  = '0023')                              28820000
288300     AND (RVNU-DDCTBL-COINSRNC-CD NOT = '4')                      28830000
288400          ADD  RVNU-TOTAL    TO COMP-TOTL                         28840000
288500          ADD  RVNU-NONCOV   TO COMP-NCOV                         28850000
288600     END-IF.                                                      28860000
288700                                                                  28870000
288800                                                                  28880000
288900 EDIT-VALU-TRLR.                                                  28890000
289000     PERFORM VARYING VALU FROM 1 BY 1                             28900093
289100               UNTIL VALU > QAR5-VALU-COUNT                       28910093
289200       MOVE ITEM-CODE(VALU) TO ITEM-ID                            28920000
289300       PERFORM EDIT-QAR5-VALUE                                    28930000
289400     END-PERFORM.                                                 28940000
289500 EDIT-VALU-TRLR-EXIT.                                             28950000
289600     EXIT.                                                        28960000
289700                                                                  28970000
289800 EDIT-QAR5-VALUE.                                                 28980093
289900     MOVE ITEM-CODE (VALU)  TO ITEM-ID.                           28990093
290000     MOVE QAR5-CLM-VAL-CD(VALU) TO HOLD-CODE.                     29000093
290100     IF   QAR5-CLM-VAL-AMT (VALU) NOT NUMERIC                     29010093
290200          MOVE ZERO         TO QAR5-CLM-VAL-AMT(VALU)             29020093
290300          ADD  +001         TO ERR                                29030093
290400          MOVE '46X1'       TO ERROR-CODE (ERR)                   29040093
290500          MOVE ITEM-ID      TO ERROR-ITEM (ERR).                  29050093
290600     EVALUATE QAR5-CLM-VAL-CD(VALU)                               29060093
290700          WHEN 'A1'   WHEN 'B1'   WHEN 'C1'                       29070093
290800               ADD  1       TO CASH-DED-VALUES                    29080093
290900               MOVE ITEM-ID TO CASH-DED-ITEM                      29090093
291000          WHEN '12' THRU '16'                                     29100093
291100          WHEN '41' THRU '43'                                     29110093
291200          WHEN '47'                                               29120093
291300               SET MSP-VALCD TO TRUE                              29130093
291400          WHEN '61'                                               29140093
291500            IF  TOB-HOME-HEALTH  AND                              29150093
291600                (QAR5-STAY-FROM > 19980930) AND                   29160093
291700                (NOT (NOPAY-N OR NOPAY-B))                        29170093
291800               IF QAR5-CLM-VAL-AMT(VALU) NOT > +0                 29180093
291900                  ADD +1 TO ERR                                   29190093
292000                  MOVE '0414' TO ERROR-CODE(ERR)                  29200093
292100               END-IF                                             29210093
292200            END-IF                                                29220093
292300          WHEN '62'                                               29230093
292400               SET VALCD-62-SEEN TO TRUE                          29240093
292500               ADD QAR5-CLM-VAL-AMT(VALU) TO VALCD-62-AMT         29250093
292600          WHEN '63'                                               29260093
292700               SET VALCD-63-SEEN TO TRUE                          29270093
292800               ADD QAR5-CLM-VAL-AMT(VALU) TO VALCD-63-AMT         29280093
292900          WHEN '64'                                               29290093
293000               SET VALCD-64-SEEN TO TRUE                          29300093
293100               ADD QAR5-CLM-VAL-AMT(VALU) TO VALCD-64-AMT         29310093
293200          WHEN '65'                                               29320093
293300               SET VALCD-65-SEEN TO TRUE                          29330093
293400               ADD QAR5-CLM-VAL-AMT(VALU) TO VALCD-65-AMT         29340093
293500          WHEN 'XX'                                               29350093
293600               MOVE VALU TO VALXX-NDX                             29360093
293700          WHEN 'XY'                                               29370093
293800               MOVE VALU TO VALXY-NDX                             29380093
293900          WHEN 'XZ'                                               29390093
294000               MOVE VALU TO VALXZ-NDX                             29400093
294100       END-EVALUATE.                                              29410093
294200       IF HOLD-CODE = '42'                                        29420093
294300           SET VET-MSP  TO TRUE                                   29430093
294400       END-IF.                                                    29440093
294500                                                                  29450000
294600*********************************************                     29460099
294700* RETAIN FOR DOC ONLY: UNUSED IN DEMO                             29470099
294800*EDIT-QAR5-HOME-HEALTH.                                           29480099
294900*    IF  (QAR5-PROVIDER  (3:4) > '6999' AND < '8500')             29490099
295000*    OR  (QAR5-PROVIDER  (3:4) > '1799' AND < '1990')             29500099
295100*    OR  (QAR5-PROVIDER  (3:4) > '3099' AND < '3200')             29510099
295200*    OR  (QAR5-PROVIDER  (3:4) > '8999' )                         29520099
295300*        CONTINUE                                                 29530099
295400*    ELSE                                                         29540099
295500*        ADD  +0001   TO ERR                                      29550099
295600*        MOVE '0702'  TO ERROR-CODE (ERR)                         29560099
295700*    END-IF.                                                      29570099
295800*                                                                 29580099
295900*    IF (TOB-HOME-HEALTH AND                                      29590099
296000*        (QAR5-REIMB-AMT > 15000000) )                            29600099
296100*       IF COND-M2                                                29610099
296200*          ADD  +0001   TO ERR                                    29620099
296300*          MOVE 'Z002'  TO ERROR-CODE (ERR)                       29630099
296400*       ELSE                                                      29640099
296500*       IF ACT-CREDIT-CANCEL                                      29650099
296600*          CONTINUE                                               29660099
296700*       ELSE                                                      29670099
296800*          ADD  +0001   TO ERR                                    29680099
296900*          MOVE '5802'  TO ERROR-CODE (ERR)                       29690099
297000*       END-IF.                                                   29700099
297100*                                                                 29710099
297200* HOME HEALTH BILL EDITS FOR BBA BEGIN IN 1998.  IF STAY FROM     29720000
297300* DATE EARLIER THAN 1998, EXIT PERFORMED ROUTINE.                 29730000
297400*    IF QAR5-STAY-FROM > 19971231                                 29740099
297500*        CONTINUE                                                 29750099
297600*    ELSE                                                         29760099
297700*        GO TO EDIT-QAR5-HOME-HEALTH-EXIT                         29770099
297800*    END-IF.                                                      29780099
297900*                                                                 29790099
298000* EDITS ARE FOR BILL TYPE 32X OR 33X                              29800000
298100*    IF TOB-32 OR TOB-33                                          29810099
298200*        CONTINUE                                                 29820099
298300*    ELSE                                                         29830099
298400*        GO TO EDIT-QAR5-HOME-HEALTH-EXIT.                        29840099
298500*                                                                 29850099
298600*                                                                 29860099
298700*EDIT-QAR5-HOME-HEALTH-EXIT. EXIT.                                29870099
298800*                                                                 29880099
298900 TITLE 'MQAPHHAB: SUBROUTINES'.                                   29890000
299000                                                                  29900000
299100 CALL-MQANHCPC.                                                   29910076
299200     MOVE +01           TO HCPC-TRLR-COUNT.                       29920000
299300     CALL 'MQANHCPC' USING HCPC-PASS-REQUEST HCPC-RECORD.         29930076
299400     IF HCPC-ACTIVE                                               29940000
299500        MOVE HCPC-UPIN-REQD-DME (1) TO HCPC-CATEGORY (98:1)       29950000
299600        PERFORM VARYING HCPC FROM 1 BY 1 UNTIL HCPC > 7           29960000
299700            MOVE HCPC-CATEGORY-CODE (1 HCPC) TO CATEG             29970000
299800            IF CATEG POSITIVE                                     29980000
299900               MOVE 'Y' TO HCPC-CATEGORY (CATEG:1)                29990099
300000            END-IF                                                30000099
300100        END-PERFORM                                               30010099
300200     END-IF.                                                      30020099
300300                                                                  30030000
300400 CALL-MQAMERRM.                                                   30040000
300500     MOVE 'MQAPHHAB'     TO ERRM-PROGRAM                          30050076
300600     DISPLAY ERRM-ERROR-DESC.                                     30060000
300700 CALL-MQAMERRM-CLS1.                                              30070000
300800     MOVE CLS1-DDNAME    TO ERRM-DDNAME.                          30080000
300900     MOVE ' OPEN FAILED' TO ERRM-COMMENT.                         30090099
301000     MOVE CLS1-STATUS    TO ERRM-STATUS,  PERFORM CALL-MQAMERRM.  30100000
301100                                                                  30110000
301200 INITIALIZE-PROGRAM.                                              30120000
301300     MOVE EDIT-WORK       TO EDIT-WORK-FORMAT.                    30130085
301400     MOVE WS-SRT-TRL-WORK TO EDIT-SRT-FORMAT.                     30140086
301500     PERFORM VARYING X FROM 1 BY 1                                30150099
301600              UNTIL  X > ERR-MAX                                  30160099
301700     END-PERFORM.                                                 30170099
301800     MOVE RANK-CONTROL    TO EDIT-RANK-CONTROL-FORMAT.            30180085
301900* CAPTURE RUNDATE                                                 30190000
302000     IF INPUT-CAL-FROM NOT NUMERIC OR                             30200000
302100        INPUT-CAL-FROM = '00000000'                               30210000
302200        MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE             30220000
302300        MOVE WS-CURRENT-DATE (1:8) TO INPUT-CAL-FROM.             30230000
302400     MOVE INPUT-CAL-FROM                                          30240000
302500        TO RUN-DATE, ERRM-FILE-DATE, RUN-YMD.                     30250000
302600*    MOVE PASS-EDIT   TO H1-DATE.                                 30260000
302700     STRING INPUT-CAL-FROM (5:2) '/'                              30270000
302800            INPUT-CAL-FROM (7:2) '/'                              30280000
302900            INPUT-CAL-FROM (1:4) DELIMITED BY SIZE                30290000
303000            INTO H1-DATE.                                         30300000
303100     MOVE INPUT-IDEN TO ERRM-ERROR-IDEN                           30310000
303200     IF ERRM-SEGMENT(2:1) = '*'                                   30320000
303300        SET TESTING TO TRUE                                       30330000
303400        MOVE ' S* PARM = TESTING RUN' TO ERRM-COMMENT             30340099
303500     ELSE                                                         30350099
303600        MOVE ' S1 PARM = PROD RUN' TO ERRM-COMMENT                30360099
303700     END-IF.                                                      30370099
303800     DISPLAY ERRM-ERROR-IDEN                                      30380099
303900     DISPLAY ERRM-COMMENT.                                        30390099
304000                                                                  30400000
304100*INITIALIZE TRL-RVNU                                              30410066
304200     MOVE ZEROES TO  TRL-RVNU-COUNT                               30420066
304300                     TRL-ERR-COUNT                                30430066
304400     MOVE SPACES TO  TRL-TBL                                      30440066
304500     PERFORM VARYING RVNU FROM 1 BY 1                             30450000
304600               UNTIL RVNU > WS-TRLR-MAX                           30460066
304700         MOVE ZEROES   TO                                         30470000
304800          TRL-RVNU-DATE      (RVNU)                               30480066
304900          TRL-RVNU-UNITS     (RVNU)                               30490066
305000          TRL-RVNU-RATE      (RVNU)                               30500066
305100          TRL-RVNU-BLOOD-DEDUCT      (RVNU)                       30510066
305200          TRL-RVNU-CASH-DEDUCT       (RVNU)                       30520066
305300          TRL-RVNU-WAGE-ADJ-COINS (RVNU)                          30530066
305400          TRL-RVNU-REDUCE-COINS      (RVNU)                       30540066
305500          TRL-RVNU-NDC-QTY           (RVNU)                       30550066
305600          TRL-RVNU-MSP1-PAID-AMT     (RVNU)                       30560066
305700          TRL-RVNU-MSP2-PAID-AMT     (RVNU)                       30570066
305800**V.I         TRL-RVNU-PROFESS-COMP      (RVNU)                   30580066
305900          TRL-RVNU-PROVIDER-PMT      (RVNU)                       30590066
306000          TRL-RVNU-PATIENT-AMT       (RVNU)                       30600066
306100          TRL-RVNU-PATIENT-RESPON (RVNU)                          30610066
306200          TRL-RVNU-PAYMENT-AMOUNT (RVNU)                          30620066
306300          TRL-RVNU-TOTAL     (RVNU)                               30630066
306400          TRL-RVNU-NONCOV (RVNU)                                  30640066
306500          TRL-RVNU-PTNT-ADD-ON-PMT     (RVNU)                     30650066
306600          TRL-RVNU-TRNSTNL-DRUG-AMT (RVNU)                        30660066
306700     END-PERFORM                                                  30670000
306800     MOVE TRL-TRLR (1) TO INIT-TRL-TRLR.                          30680067
306900                                                                  30690000
307000     PERFORM VARYING X FROM 2 BY 1                                30700000
307100               UNTIL X > 450                                      30710000
307200       MOVE WS-SRT-TRL(1) TO WS-SRT-TRL(X)                        30720000
307300     END-PERFORM.                                                 30730000
307400     MOVE WS-SRT-TRL-WORK TO EDIT-SRT-FORMAT.                     30740000
307500                                                                  30750000
307600* CAPTURE DSNAMES                                                 30760000
307700     MOVE CLIN-DDNAME  TO FCB-DDNAME                              30770000
307800     CALL 'DDSDDCHK' USING FCB-PARAMETER                          30780000
307900     MOVE FCB-DSNAME      TO CLIN-DSNAME                          30790000
308000                             H2-INFILE                            30800000
308100     IF TESTING                                                   30810000
308200     DISPLAY 'FCB-PARAMETER: ' FCB-DDNAME ' ' CLIN-DSNAME         30820000
308300     END-IF.                                                      30830000
308400     MOVE SPACES       TO HOLD-UNSTRING                           30840000
308500     UNSTRING FCB-DSNAME DELIMITED BY  '.' OR SPACE               30850000
308600         INTO HOLD-WORD (1) DELIMITER IN HOLD-DELIM (1)           30860000
308700              HOLD-WORD (2) DELIMITER IN HOLD-DELIM (2)           30870000
308800              HOLD-WORD (3) DELIMITER IN HOLD-DELIM (3)           30880000
308900              HOLD-WORD (7) DELIMITER IN HOLD-DELIM (7)           30890000
309000              HOLD-WORD (8) DELIMITER IN HOLD-DELIM (8)           30900000
309100              HOLD-WORD (9) DELIMITER IN HOLD-DELIM (9)           30910000
309200     PERFORM VARYING SUBX FROM 1 BY 1 UNTIL SUBX > +10            30920000
309300        IF HOLD-DELIM (SUBX) = SPACE                              30930000
309400            MOVE HOLD-WORD (SUBX) TO HOLD-LAST                    30940000
309500            MOVE +10              TO  SUBX                        30950000
309600        END-IF                                                    30960000
309700     END-PERFORM                                                  30970000
309800     IF  (HOLD-GENER-1(1:1) = 'G')                                30980000
309900     AND (HOLD-VRSN(1:1) = 'V')                                   30990000
310000         MOVE HOLD-LAST   TO HOLD-INFIL-GDG                       31000000
310100         IF TESTING                                               31010000
310200             DISPLAY ' '                                          31020000
310300             DISPLAY 'CLIN-GDG : ' HOLD-INFIL-GDG                 31030000
310400         END-IF                                                   31040000
310500     END-IF.                                                      31050000
310600                                                                  31060000
310700     MOVE CLS1-DDNAME  TO FCB-DDNAME                              31070000
310800     CALL 'DDSDDCHK' USING FCB-PARAMETER                          31080000
310900     MOVE FCB-DSNAME      TO CLS1-DSNAME                          31090000
311000                             H3-OUTFILE                           31100000
311100     IF TESTING                                                   31110000
311200     DISPLAY 'FCB-PARAMETER: ' FCB-DDNAME ' ' CLS1-DSNAME         31120000
311300     END-IF.                                                      31130000
311400     MOVE SPACES       TO HOLD-UNSTRING                           31140000
311500     UNSTRING FCB-DSNAME DELIMITED BY  '.' OR SPACE               31150000
311600         INTO HOLD-WORD (1) DELIMITER IN HOLD-DELIM (1)           31160000
311700              HOLD-WORD (2) DELIMITER IN HOLD-DELIM (2)           31170000
311800              HOLD-WORD (3) DELIMITER IN HOLD-DELIM (3)           31180000
311900              HOLD-WORD (7) DELIMITER IN HOLD-DELIM (7)           31190000
312000              HOLD-WORD (8) DELIMITER IN HOLD-DELIM (8)           31200000
312100              HOLD-WORD (9) DELIMITER IN HOLD-DELIM (9)           31210000
312200     PERFORM VARYING SUBX FROM 1 BY 1 UNTIL SUBX > +10            31220000
312300        IF HOLD-DELIM (SUBX) = SPACE                              31230000
312400            MOVE HOLD-WORD (SUBX) TO HOLD-LAST                    31240000
312500            MOVE +10              TO  SUBX                        31250000
312600        END-IF                                                    31260000
312700     END-PERFORM                                                  31270000
312800     IF  (HOLD-GENER-1(1:1) = 'G')                                31280000
312900     AND (HOLD-VRSN(1:1) = 'V')                                   31290000
313000         MOVE HOLD-LAST   TO HOLD-OUTFIL-GDG                      31300000
313100         DISPLAY ' '                                              31310000
313200         DISPLAY 'CLS1-GDG : ' HOLD-OUTFIL-GDG                    31320000
313300     END-IF.                                                      31330000
313400                                                                  31340000
313500 WRITE-CLAIMS-OUTPUT.                                             31350000
313600                                                                  31360000
313700     EVALUATE TRUE                                                31370000
313800         WHEN QA0L-SEGMENT = '1'                                  31380099
313900              IF CLS1-STATUS = ZERO                               31390000
314000                 PERFORM WRITE-CLAIMS-SEG1                        31400000
314100              END-IF                                              31410000
314200         WHEN OTHER                                               31420000
314300              DISPLAY 'INVALID SEGMENT: ' QA0L-SEGMENT            31430099
314400              DISPLAY 'ABEND MQAPHHAB RUN'                        31440000
314500              MOVE 16 TO RETURN-CODE                              31450000
314600              STOP RUN                                            31460000
314700     END-EVALUATE.                                                31470000
314800                                                                  31480000
314900 WRITE-CLAIMS-SEG1.                                               31490000
315000     MOVE QA5L-OSDM-LEADER   TO CLS1-LEADER                       31500095
315100     MOVE CLIN-RECL          TO CLS1-RECL                         31510095
315200     MOVE HOME-HEALTH-RECORD(50:CLS1-RECL) TO CLS1-DATA-AREA      31520095
315300*    MOVE CLIN-CLAIM    TO CLS1-DATA-AREA                         31530094
315400     WRITE CLS1-RECORD.                                           31540000
315500     IF CLS1-STATUS EQUAL ZERO                                    31550000
315600        ADD  0001 TO CLS1-COUNT                                   31560000
315700     ELSE                                                         31570000
315800        MOVE '04' TO ERRM-ERROR, PERFORM CALL-MQAMERRM-CLS1.      31580000
315900     IF  QA5L-TOT-SEG-COUNT GREATER 1                             31590099
316000        PERFORM WRITE-RVNU-SEG1                                   31600000
316100        VARYING SEG-CNTR FROM 2 BY 1                              31610000
316200        UNTIL   SEG-CNTR GREATER  QA5L-TOT-SEG-COUNT              31620099
316300     END-IF.                                                      31630000
316400 WRITE-RVNU-SEG1.                                                 31640000
316500     MOVE HRVNU-LEADER (SEG-CNTR) TO CLS1-LEADER                  31650000
316600     MOVE HRVNU-RECL   (SEG-CNTR) TO CLS1-RECL                    31660000
316700                                     HOLD-RECL                    31670000
316800     MOVE HRVNU-CLAIM  (SEG-CNTR) (1:HOLD-RECL)                   31680000
316900                                  TO CLS1-DATA-AREA               31690000
317000     WRITE CLS1-RECORD.                                           31700000
317100     IF CLS1-STATUS EQUAL ZERO                                    31710000
317200          ADD  0001 TO CLS1-RVNU-COUNT                            31720000
317300     ELSE DISPLAY 'CLS1 ' CLS1-COUNT                              31730000
317400          DISPLAY 'RVNU ' CLS1-RVNU-COUNT                         31740000
317500          MOVE '04' TO ERRM-ERROR, PERFORM CALL-MQAMERRM-CLS1.    31750000
317600                                                                  31760000
317700 DISPLAY-FINAL-COUNTS.                                            31770000
317800     COMPUTE CLIN-TOT-REC = CLIN-COUNT + CLIN-RVNU-COUNT.         31780000
317900     COMPUTE CLS1-TOT-REC = CLS1-COUNT + CLS1-RVNU-COUNT.         31790000
318000     DISPLAY 'MQAPHHAB FILE DATE: ' RUN-DATE                      31800099
318100     DISPLAY 'MQAPHHAB RUN ON   : ' CURRENT-DAY                   31810099
318200     DISPLAY ' INPUT FILE  : ' CLIN-DDNAME                        31820000
318300     DISPLAY ' CLIN CLAIMS : ' CLIN-COUNT                         31830000
318400     DISPLAY ' CLIN-OVFL   : ' CLIN-RVNU-COUNT                    31840000
318500     DISPLAY ' CLIN TOT REC: ' CLIN-TOT-REC                       31850000
318600     DISPLAY 'OUTPUT FILE  : ' CLS1-DDNAME                        31860000
318700     DISPLAY ' CLS1 CLAIMS : ' CLS1-COUNT                         31870000
318800     DISPLAY ' CLS1-OVFL   : ' CLS1-RVNU-COUNT                    31880000
318900     DISPLAY ' CLS1 TOT REC: ' CLS1-TOT-REC.                      31890000
319000                                                                  31900000
319100 END PROGRAM MQAPHHAB.                                            31910000
